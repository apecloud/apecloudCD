Defaulted container "e2e-test" out of: e2e-test, init-e2e (init)
Warning: Immediate deletion does not wait for confirmation that the running resource has been terminated. The resource may continue to run on the cluster indefinitely.
pod "cloud-e2e-test-engine-main" force deleted
go: downloading github.com/apecloud/kb-cloud-client-go v0.31.0-alpha.20.0.20250228040400-9426a71bf978
go: downloading k8s.io/klog/v2 v2.130.1
go: downloading k8s.io/kube-openapi v0.0.0-20240228011516-70dd3763d340
go: downloading k8s.io/utils v0.0.0-20240711033017-18e509b52bc8
go: downloading github.com/google/gnostic-models v0.6.9-0.20230804172637-c7be7c783f49
go: downloading github.com/imdario/mergo v0.3.16
go: downloading google.golang.org/protobuf v1.36.4
go: downloading github.com/go-openapi/swag v0.23.0
go: downloading github.com/go-openapi/jsonreference v0.21.0
go: downloading github.com/go-openapi/jsonpointer v0.21.0
Testing engines: [mysql pg redis mongo]
[API] GET /api/v1/engineOptions/{engineName} engineOption.getEngineOption
[API] GET /api/v1/engineOptions/{engineName} engineOption.getEngineOption
[API] GET /api/v1/environments/{environmentName}/engines/{engineName}/serviceVersion engine.ListServiceVersion
[API] GET /api/v1/environments/{environmentName}/engines/{engineName}/serviceVersion engine.ListServiceVersion
[API] GET /api/v1/engineOptions/{engineName} engineOption.getEngineOption
Failed to get engine option for pg, 404 Not Found
[API] GET /api/v1/engineOptions/{engineName} engineOption.getEngineOption
[API] GET /api/v1/environments/{environmentName}/engines/{engineName}/serviceVersion engine.ListServiceVersion
[API] GET /api/v1/environments/{environmentName}/engines/{engineName}/serviceVersion engine.ListServiceVersion
[API] GET /api/v1/environments/{environmentName}/engines/{engineName}/serviceVersion engine.ListServiceVersion
[API] GET /api/v1/environments/{environmentName}/engines/{engineName}/serviceVersion engine.ListServiceVersion
[API] GET /api/v1/engineOptions/{engineName} engineOption.getEngineOption
Failed to get engine option for mongo, 404 Not Found
Test Cluster Operation Combinations:
Engine    | Mode       | Version
--------------------------------
mysql     | standalone | 8.0.31
mysql     | standalone | 8.0.32
mysql     | standalone | 5.7.44
mysql     | replication | 8.0.30
mysql     | replication | 8.0.31
mysql     | replication | 5.7.44
redis     | standalone | 7.2.4
redis     | standalone | 7.2.7
redis     | standalone | 7.0.6
redis     | standalone | 6.2.17
redis     | replication | 7.2.7
redis     | replication | 7.2.4
redis     | replication | 7.0.6
redis     | replication | 6.2.17
redis     | sentinel   | 7.2.4
redis     | sentinel   | 7.2.7
redis     | sentinel   | 7.0.6
redis     | sentinel   | 6.2.17
redis     | cluster    | 7.2.7
redis     | cluster    | 7.2.4
redis     | cluster    | 7.0.6
redis     | cluster    | 6.2.17
Total test combinations: 22
Running Suite: KubeBlocks Cloud Engine Test Suite - /e2e/test/engine
[38;5;204m[engine][0m
====================================================================
Random Seed: [1m1741027212[0m
Will run [1m22[0m of [1m22[0m specs
[38;5;243m------------------------------[0m
[0m[1m[BeforeSuite] [0m
[38;5;243m/e2e/test/engine/suite_test.go:35[0m
Suite Start: 2025-03-03T18:40:47Z
[38;5;10m[BeforeSuite] PASSED [0.000 seconds][0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mmysql/replication/5.7.44[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 18:40:47.75[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 18:40:47.75[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 18:40:47.75[0m
[1mSTEP:[0m build mysql cluster [38;5;243m@ 03/03/25 18:40:47.75[0m
[1mSTEP:[0m set mode replication [38;5;243m@ 03/03/25 18:40:47.75[0m
[1mSTEP:[0m set version 5.7.44 [38;5;243m@ 03/03/25 18:40:47.75[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 18:40:47.75[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 18:40:47.75[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 18:40:47.788[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 18:40:47.789[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 18:40:47.789[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 18:40:47.805[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 18:40:47.805[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 18:40:47.805[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 18:40:48.18[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 18:40:48.181[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 18:40:48.181[0m
[1mSTEP:[0m verify component mysql [38;5;243m@ 03/03/25 18:40:48.181[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 18:40:48.181[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 18:40:48.181[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 18:40:48.181[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"xtrabackup","cronExpression":"0 2 * * *","incrementalBackupEnabled":true,"incrementalCronExpression":"10 * * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"1c2g","components":[{"classCode":"mysql.replication.mysql.1c2g.general","classSeries":"general","codeShort":"1c2g","component":"mysql","cpu":1,"memory":2,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T18:40:48.159Z","engine":"mysql","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-d-b87f4784","id":"432514024907737658","initOptions":[{"component":"mysql","initParams":{"pool_buffer_size":"{{- $pool_buffer_size := ( callBufferSizeByResource ( index $.podSpec.containers 0 ) true ) }}"},"specName":"mysql-replication-config"}],"mode":"replication","name":"e2e-djic5e38","orgName":"e2e-test","paramTpls":[{"component":"mysql","paramTplID":"432514024370866746","paramTplName":"e2e-djic5e38-mysql-temp","paramTplPartition":"custom"}],"parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T18:40:48.159Z","version":"5.7.44"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 18:40:48.181[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:40:48.181[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-djic5e38 status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-djic5e38 status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-djic5e38 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-djic5e38 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-djic5e38 status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 18:41:28.358[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 18:41:28.372[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 18:41:28.372[0m
[1mSTEP:[0m verify component mysql [38;5;243m@ 03/03/25 18:41:28.372[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 18:41:28.372[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 18:41:28.372[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 18:41:28.372[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 18:41:28.372[0m
Engine: mysql
Mode: replication
Version: 5.7.44
Components:
- mysql:
Replicas: 2-5 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ“ database:
âœ“ dms:
âœ“ bench:
âœ“ backup:
âœ“ metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
mysql:
âœ“ dashboard
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
- vscale: Scale cluster components vertically
Supported Components: [mysql]
- volume-expansion: Expand cluster volumes
Supported Components: [mysql]
- promote: Promote cluster components
Supported Components: [mysql]
- upgrade: Upgrade cluster
Supported Components: [mysql]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [mysql]
- restart: Restart cluster components
Supported Components: [mysql]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. vscale: Scale cluster components vertically
Supported Components: [mysql]
3. volume-expansion: Expand cluster volumes
Supported Components: [mysql]
4. promote: Promote cluster components
Supported Components: [mysql]
5. upgrade: Upgrade cluster
Supported Components: [mysql]
6. account: Account operations
7. database: Database operations
8. monitor: Monitor operations
9. stop-start: Stop and start cluster
Supported Components: [mysql]
10. restart: Restart cluster components
Supported Components: [mysql]
11. dms: Data management operations
12. alert: Alert operations
[1mSTEP:[0m [1/12] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 18:41:28.373[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 18:41:28.373[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 18:41:28.376[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 18:41:28.376[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-d-b87f4784-xtrabackup-20250303184121 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-d-b87f4784-xtrabackup-20250303184121 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 18:41:38.389[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup dfafd6dc-e2e-d-b87f4784-mysql-archive-binlog is running
[1mSTEP:[0m default backup method: xtrabackup [38;5;243m@ 03/03/25 18:41:38.391[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 18:41:38.391[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 18:41:38.442[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupnh4dyndl in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupnh4dyndl completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 18:41:48.448[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 18:41:48.453[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"xtrabackup","cronExpression":"0 2 * * *","incrementalBackupEnabled":true,"incrementalCronExpression":"10 * * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"mysql.replication.mysql.1c2g.general","classSeries":"general","codeShort":"1c2g","component":"mysql","cpu":1,"memory":2,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-b8bbhy5k","engine":"mysql","environmentName":"cloud-dev","mode":"replication","name":"restore-e2e-b8bbhy5k","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"5.7.44"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 18:41:48.692[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:41:48.692[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b8bbhy5k status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b8bbhy5k status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b8bbhy5k status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b8bbhy5k status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b8bbhy5k status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b8bbhy5k status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b8bbhy5k status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b8bbhy5k status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 18:42:58.863[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-b8bbhy5k [38;5;243m@ 03/03/25 18:42:58.879[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 18:42:59.093[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 18:42:59.096[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 1m30.749078642s
[1mSTEP:[0m [2/12] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 18:42:59.122[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 18:42:59.122[0m
[1mSTEP:[0m choose component: mysql [38;5;243m@ 03/03/25 18:42:59.122[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: mysql.replication.mysql.1c2g.general [38;5;243m@ 03/03/25 18:42:59.138[0m
[1mSTEP:[0m choose larger class: mysql.replication.mysql.2c2g.general [38;5;243m@ 03/03/25 18:42:59.138[0m
[1mSTEP:[0m changing component mysql class to mysql.replication.mysql.2c2g.general [38;5;243m@ 03/03/25 18:42:59.138[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432514244722821690 to be Succeed [38;5;243m@ 03/03/25 18:42:59.176[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-lhvc4 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-lhvc4 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-lhvc4 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-lhvc4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-lhvc4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 18:43:49.305875    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-lhvc4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-lhvc4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-lhvc4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-lhvc4 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:44:29.503[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-djic5e38 status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 18:44:29.517[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 18:44:29.531[0m
[1mSTEP:[0m changing component mysql class to mysql.replication.mysql.1c2g.general [38;5;243m@ 03/03/25 18:44:29.531[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432514396355299898 to be Succeed [38;5;243m@ 03/03/25 18:44:29.56[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-dmz4w status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-dmz4w status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-dmz4w status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-dmz4w status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-dmz4w status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-dmz4w status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-dmz4w status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-dmz4w status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-verticalscaling-dmz4w status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:45:49.78[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-djic5e38 status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 18:45:49.794[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 2m50.685803439s
[1mSTEP:[0m [3/12] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 18:45:49.808[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 18:45:49.808[0m
[1mSTEP:[0m choose component: mysql [38;5;243m@ 03/03/25 18:45:49.808[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 18:45:49.808[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432514531059567162 to be Succeed [38;5;243m@ 03/03/25 18:45:49.844[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-volumeexpansion-nlbnz status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-volumeexpansion-nlbnz status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-volumeexpansion-nlbnz status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:46:09.917[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-djic5e38 status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 20.147004405s
[1mSTEP:[0m [4/12] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 18:46:09.955[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 18:46:09.955[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:46:09.955[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-djic5e38 status: Running
[1mSTEP:[0m choose component: mysql [38;5;243m@ 03/03/25 18:46:09.968[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-d-b87f4784-mysql-1 with role secondary [38;5;243m@ 03/03/25 18:46:10.206[0m
[1mSTEP:[0m promoting instance e2e-d-b87f4784-mysql-1 of component mysql from secondary to primary [38;5;243m@ 03/03/25 18:46:10.206[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432514565469637178 to be Succeed [38;5;243m@ 03/03/25 18:46:10.355[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-custom-49kql status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-custom-49kql status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-custom-49kql status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:46:30.42[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-djic5e38 status: Running
[1mSTEP:[0m verify the instance role is updated [38;5;243m@ 03/03/25 18:46:30.435[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m second promotion: promote another instance e2e-d-b87f4784-mysql-0 with role secondary [38;5;243m@ 03/03/25 18:46:30.947[0m
[1mSTEP:[0m promoting instance e2e-d-b87f4784-mysql-0 of component mysql from secondary to primary [38;5;243m@ 03/03/25 18:46:30.947[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432514600366246458 to be Succeed [38;5;243m@ 03/03/25 18:46:31.153[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-custom-r2dp5 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-custom-r2dp5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-d-b87f4784-custom-r2dp5 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:46:51.287[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-djic5e38 status: Running
[1mSTEP:[0m verify the instance role is updated [38;5;243m@ 03/03/25 18:46:51.304[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
Operation promote completed in 41.490896186s
[1mSTEP:[0m [5/12] Executing operation: upgrade - Upgrade cluster [38;5;243m@ 03/03/25 18:46:51.446[0m
[1mSTEP:[0m upgrade cluster [38;5;243m@ 03/03/25 18:46:51.446[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/upgradeableServiceVersion engineOption.ListUpgradeableServiceVersion
no upgradeable version available for component mysql, trying next
no component supports upgrade
Operation upgrade completed in 33.078008ms
[1mSTEP:[0m [6/12] Executing operation: account - Account operations [38;5;243m@ 03/03/25 18:46:51.479[0m
[1mSTEP:[0m test cluster account [38;5;243m@ 03/03/25 18:46:51.479[0m
[1mSTEP:[0m list accounts before creation [38;5;243m@ 03/03/25 18:46:51.479[0m
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[1mSTEP:[0m invalidate account name pattern will be banned [38;5;243m@ 03/03/25 18:46:51.689[0m
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[1mSTEP:[0m create test account [38;5;243m@ 03/03/25 18:46:51.701[0m
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[1mSTEP:[0m list accounts after creation [38;5;243m@ 03/03/25 18:46:51.72[0m
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/databases database.listDatabases
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/databases database.createDatabase
[1mSTEP:[0m validate account privileges [38;5;243m@ 03/03/25 18:46:51.846[0m
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[1mSTEP:[0m update account privilege [38;5;243m@ 03/03/25 18:46:52.031[0m
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[1mSTEP:[0m reset password for test account [38;5;243m@ 03/03/25 18:46:52.802[0m
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
backup          | PASS    | 1        | 1m31s    | 1m31s    | 1m31s    | 1m31s
vscale          | PASS    | 1        | 2m51s    | 2m51s    | 2m51s    | 2m51s
volume-expansion | PASS    | 1        | 20s      | 20s      | 20s      | 20s
promote         | PASS    | 1        | 41s      | 41s      | 41s      | 41s
upgrade         | PASS    | 1        | 0s       | 0s       | 0s       | 0s
dms             | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
monitor         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
database        | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: mysql | Mode: replication | Version: 5.7.44 | Operations: 5/12 (41.7%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/account_test.go:173 [38;5;243m@ 03/03/25 18:46:54.067[0m
=== Test Failed ===
Engine: mysql
Mode: replication
Version: 5.7.44
Cluster: e2e-djic5e38
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [366.318 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] mysql/replication/5.7.44[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] Unexpected error:
<*errors.errorString | 0xc00052cd30>:
failed to update account password: 500 Internal Server Error
{
s: "failed to update account password: 500 Internal Server Error",
}
occurred[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/account_test.go:173[0m [38;5;243m@ 03/03/25 18:46:54.067[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mmysql/replication/8.0.30[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 18:46:54.068[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 18:46:54.068[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 18:46:54.068[0m
[1mSTEP:[0m build mysql cluster [38;5;243m@ 03/03/25 18:46:54.068[0m
[1mSTEP:[0m set mode replication [38;5;243m@ 03/03/25 18:46:54.068[0m
[1mSTEP:[0m set version 8.0.30 [38;5;243m@ 03/03/25 18:46:54.068[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 18:46:54.068[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 18:46:54.068[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 18:46:54.085[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 18:46:54.085[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 18:46:54.085[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 18:46:54.087[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 18:46:54.088[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 18:46:54.088[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 18:46:54.367[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 18:46:54.367[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 18:46:54.367[0m
[1mSTEP:[0m verify component mysql [38;5;243m@ 03/03/25 18:46:54.367[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 18:46:54.367[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 18:46:54.367[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 18:46:54.367[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"xtrabackup","cronExpression":"0 2 * * *","incrementalBackupEnabled":true,"incrementalCronExpression":"10 * * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"1c2g","components":[{"classCode":"mysql.replication.mysql.1c2g.general","classSeries":"general","codeShort":"1c2g","component":"mysql","cpu":1,"memory":2,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T18:46:54.365Z","engine":"mysql","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-n-8566d76f6","id":"432514639306164794","initOptions":[{"component":"mysql","initParams":{"pool_buffer_size":"{{- $pool_buffer_size := ( callBufferSizeByResource ( index $.podSpec.containers 0 ) true ) }}"},"specName":"mysql-replication-config"}],"mode":"replication","name":"e2e-n8gsid99","orgName":"e2e-test","paramTpls":[{"component":"mysql","paramTplID":"432514638886734394","paramTplName":"e2e-n8gsid99-mysql-temp","paramTplPartition":"custom"}],"parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T18:46:54.365Z","version":"8.0.30"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 18:46:54.367[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:46:54.367[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-n8gsid99 status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 18:47:04.384127    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-n8gsid99 status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-n8gsid99 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-n8gsid99 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-n8gsid99 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-n8gsid99 status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-n8gsid99 status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-n8gsid99 status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-n8gsid99 status: Failed
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/cluster_test.go:78 [38;5;243m@ 03/03/25 18:48:24.587[0m
=== Test Failed ===
Engine: mysql
Mode: replication
Version: 8.0.30
Cluster: e2e-n8gsid99
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [90.519 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] mysql/replication/8.0.30[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] cluster e2e-n8gsid99 failed unexpectedly[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/cluster_test.go:78[0m [38;5;243m@ 03/03/25 18:48:24.587[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mmysql/replication/8.0.31[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 18:48:24.587[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 18:48:24.587[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 18:48:24.587[0m
[1mSTEP:[0m build mysql cluster [38;5;243m@ 03/03/25 18:48:24.587[0m
[1mSTEP:[0m set mode replication [38;5;243m@ 03/03/25 18:48:24.587[0m
[1mSTEP:[0m set version 8.0.31 [38;5;243m@ 03/03/25 18:48:24.587[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 18:48:24.587[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 18:48:24.587[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 18:48:24.603[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 18:48:24.603[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 18:48:24.603[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 18:48:24.605[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 18:48:24.605[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 18:48:24.605[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 18:48:24.835[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 18:48:24.835[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 18:48:24.835[0m
[1mSTEP:[0m verify component mysql [38;5;243m@ 03/03/25 18:48:24.835[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 18:48:24.835[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 18:48:24.835[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 18:48:24.835[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"xtrabackup","cronExpression":"0 2 * * *","incrementalBackupEnabled":true,"incrementalCronExpression":"10 * * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"1c2g","components":[{"classCode":"mysql.replication.mysql.1c2g.general","classSeries":"general","codeShort":"1c2g","component":"mysql","cpu":1,"memory":2,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T18:48:24.833Z","engine":"mysql","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-f-5c4f97dbc4","id":"432514791089637946","initOptions":[{"component":"mysql","initParams":{"pool_buffer_size":"{{- $pool_buffer_size := ( callBufferSizeByResource ( index $.podSpec.containers 0 ) true ) }}"},"specName":"mysql-replication-config"}],"mode":"replication","name":"e2e-f9gl0tcp","orgName":"e2e-test","paramTpls":[{"component":"mysql","paramTplID":"432514790754093626","paramTplName":"e2e-f9gl0tcp-mysql-temp","paramTplPartition":"custom"}],"parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T18:48:24.833Z","version":"8.0.31"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 18:48:24.835[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:48:24.835[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 18:49:24.997[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 18:49:25.012[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 18:49:25.012[0m
[1mSTEP:[0m verify component mysql [38;5;243m@ 03/03/25 18:49:25.012[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 18:49:25.012[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 18:49:25.012[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 18:49:25.012[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 18:49:25.012[0m
Engine: mysql
Mode: replication
Version: 8.0.31
Components:
- mysql:
Replicas: 2-5 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ“ database:
âœ“ dms:
âœ“ bench:
âœ“ backup:
âœ“ metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
mysql:
âœ“ dashboard
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
- vscale: Scale cluster components vertically
Supported Components: [mysql]
- volume-expansion: Expand cluster volumes
Supported Components: [mysql]
- promote: Promote cluster components
Supported Components: [mysql]
- upgrade: Upgrade cluster
Supported Components: [mysql]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [mysql]
- restart: Restart cluster components
Supported Components: [mysql]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. vscale: Scale cluster components vertically
Supported Components: [mysql]
3. volume-expansion: Expand cluster volumes
Supported Components: [mysql]
4. promote: Promote cluster components
Supported Components: [mysql]
5. upgrade: Upgrade cluster
Supported Components: [mysql]
6. account: Account operations
7. database: Database operations
8. monitor: Monitor operations
9. stop-start: Stop and start cluster
Supported Components: [mysql]
10. restart: Restart cluster components
Supported Components: [mysql]
11. dms: Data management operations
12. alert: Alert operations
[1mSTEP:[0m [1/12] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 18:49:25.012[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 18:49:25.012[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 18:49:25.015[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 18:49:25.015[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-f-5c4f97dbc4-xtrabackup-20250303184915 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-f-5c4f97dbc4-xtrabackup-20250303184915 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 18:49:35.023[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup ac77d6e7-e2e-f-5c4f97dbc4-mysq-archive-binlog is running
[1mSTEP:[0m default backup method: xtrabackup [38;5;243m@ 03/03/25 18:49:35.025[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 18:49:35.025[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 18:49:35.077[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup9uhjvrmd in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup9uhjvrmd completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 18:49:45.089[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 18:49:45.094[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"xtrabackup","cronExpression":"0 2 * * *","incrementalBackupEnabled":true,"incrementalCronExpression":"10 * * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"mysql.replication.mysql.1c2g.general","classSeries":"general","codeShort":"1c2g","component":"mysql","cpu":1,"memory":2,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-3tzgxsfj","engine":"mysql","environmentName":"cloud-dev","mode":"replication","name":"restore-e2e-3tzgxsfj","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"8.0.31"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 18:49:45.327[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:49:45.327[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-3tzgxsfj status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-3tzgxsfj status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-3tzgxsfj status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 18:50:15.402595    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-3tzgxsfj status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-3tzgxsfj status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-3tzgxsfj status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 18:50:45.474[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-3tzgxsfj [38;5;243m@ 03/03/25 18:50:45.489[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 18:50:45.686[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 18:50:45.688[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 1m20.697833564s
[1mSTEP:[0m [2/12] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 18:50:45.71[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 18:50:45.71[0m
[1mSTEP:[0m choose component: mysql [38;5;243m@ 03/03/25 18:50:45.71[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: mysql.replication.mysql.1c2g.general [38;5;243m@ 03/03/25 18:50:45.726[0m
[1mSTEP:[0m choose larger class: mysql.replication.mysql.2c2g.general [38;5;243m@ 03/03/25 18:50:45.726[0m
[1mSTEP:[0m changing component mysql class to mysql.replication.mysql.2c2g.general [38;5;243m@ 03/03/25 18:50:45.726[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432515027514165818 to be Succeed [38;5;243m@ 03/03/25 18:50:45.757[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-9wq8g status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-9wq8g status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-9wq8g status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-9wq8g status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-9wq8g status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-9wq8g status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-9wq8g status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-9wq8g status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-9wq8g status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-9wq8g status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:52:15.995[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 18:52:16.011[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 18:52:16.024[0m
[1mSTEP:[0m changing component mysql class to mysql.replication.mysql.1c2g.general [38;5;243m@ 03/03/25 18:52:16.024[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432515179012426298 to be Succeed [38;5;243m@ 03/03/25 18:52:16.054[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-czhbm status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-czhbm status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-czhbm status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-czhbm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-czhbm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-czhbm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-czhbm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 18:53:26.230766    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-verticalscaling-czhbm status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:53:36.255[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 18:53:36.27[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 2m50.576968116s
[1mSTEP:[0m [3/12] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 18:53:36.287[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 18:53:36.287[0m
[1mSTEP:[0m choose component: mysql [38;5;243m@ 03/03/25 18:53:36.287[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 18:53:36.287[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432515313683139130 to be Succeed [38;5;243m@ 03/03/25 18:53:36.322[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-volumeexpansion-xrz5f status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-volumeexpansion-xrz5f status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-volumeexpansion-xrz5f status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:53:56.407[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 20.148459458s
[1mSTEP:[0m [4/12] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 18:53:56.436[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 18:53:56.436[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:53:56.436[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status: Running
[1mSTEP:[0m choose component: mysql [38;5;243m@ 03/03/25 18:53:56.451[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-f-5c4f97dbc4-mysql-0 with role secondary [38;5;243m@ 03/03/25 18:53:56.682[0m
[1mSTEP:[0m promoting instance e2e-f-5c4f97dbc4-mysql-0 of component mysql from secondary to primary [38;5;243m@ 03/03/25 18:53:56.682[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432515348026100282 to be Succeed [38;5;243m@ 03/03/25 18:53:56.801[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-custom-6mpt9 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-custom-6mpt9 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-custom-6mpt9 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:54:16.867[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status: Running
[1mSTEP:[0m verify the instance role is updated [38;5;243m@ 03/03/25 18:54:16.881[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m second promotion: promote another instance e2e-f-5c4f97dbc4-mysql-1 with role secondary [38;5;243m@ 03/03/25 18:54:17.233[0m
[1mSTEP:[0m promoting instance e2e-f-5c4f97dbc4-mysql-1 of component mysql from secondary to primary [38;5;243m@ 03/03/25 18:54:17.233[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432515382486501946 to be Succeed [38;5;243m@ 03/03/25 18:54:17.335[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-custom-vlg7c status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-custom-vlg7c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-custom-vlg7c status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:54:37.4[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status: Running
[1mSTEP:[0m verify the instance role is updated [38;5;243m@ 03/03/25 18:54:37.415[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
Operation promote completed in 41.185347782s
[1mSTEP:[0m [5/12] Executing operation: upgrade - Upgrade cluster [38;5;243m@ 03/03/25 18:54:37.621[0m
[1mSTEP:[0m upgrade cluster [38;5;243m@ 03/03/25 18:54:37.621[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/upgradeableServiceVersion engineOption.ListUpgradeableServiceVersion
[1mSTEP:[0m selected component mysql for upgrade testing [38;5;243m@ 03/03/25 18:54:37.648[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/upgradeableServiceVersion engineOption.ListUpgradeableServiceVersion
[1mSTEP:[0m upgrade #1 - current version: 8.0.31 [38;5;243m@ 03/03/25 18:54:37.671[0m
[1mSTEP:[0m choosing target version: 8.0.35 [38;5;243m@ 03/03/25 18:54:37.671[0m
[1mSTEP:[0m upgrading component mysql to version 8.0.35 [38;5;243m@ 03/03/25 18:54:37.671[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/upgrade opsrequest.upgradeCluster
[1mSTEP:[0m wait task 432515416661690938 to be Succeed [38;5;243m@ 03/03/25 18:54:37.705[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-nrdwv status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-nrdwv status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-nrdwv status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-nrdwv status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-nrdwv status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-nrdwv status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-nrdwv status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-nrdwv status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-nrdwv status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:55:57.922[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status: Running
[1mSTEP:[0m verify the version is updated [38;5;243m@ 03/03/25 18:55:57.937[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/upgradeableServiceVersion engineOption.ListUpgradeableServiceVersion
[1mSTEP:[0m upgrade #2 - current version: 8.0.31 [38;5;243m@ 03/03/25 18:55:57.977[0m
[1mSTEP:[0m choosing target version: 8.0.37 [38;5;243m@ 03/03/25 18:55:57.977[0m
[1mSTEP:[0m upgrading component mysql to version 8.0.37 [38;5;243m@ 03/03/25 18:55:57.977[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/upgrade opsrequest.upgradeCluster
[1mSTEP:[0m wait task 432515551382735418 to be Succeed [38;5;243m@ 03/03/25 18:55:58.011[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-55v6v status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-55v6v status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-55v6v status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-55v6v status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 18:56:38.123389    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-55v6v status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-55v6v status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-f-5c4f97dbc4-upgrade-55v6v status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:57:08.201[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-f9gl0tcp status: Running
[1mSTEP:[0m verify the version is updated [38;5;243m@ 03/03/25 18:57:08.217[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation upgrade completed in 2m30.610490968s
[1mSTEP:[0m [6/12] Executing operation: account - Account operations [38;5;243m@ 03/03/25 18:57:08.232[0m
[1mSTEP:[0m test cluster account [38;5;243m@ 03/03/25 18:57:08.232[0m
[1mSTEP:[0m list accounts before creation [38;5;243m@ 03/03/25 18:57:08.232[0m
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[1mSTEP:[0m invalidate account name pattern will be banned [38;5;243m@ 03/03/25 18:57:08.445[0m
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[1mSTEP:[0m create test account [38;5;243m@ 03/03/25 18:57:08.457[0m
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[1mSTEP:[0m list accounts after creation [38;5;243m@ 03/03/25 18:57:08.491[0m
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/databases database.listDatabases
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/databases database.createDatabase
[1mSTEP:[0m validate account privileges [38;5;243m@ 03/03/25 18:57:08.72[0m
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[1mSTEP:[0m update account privilege [38;5;243m@ 03/03/25 18:57:08.959[0m
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[1mSTEP:[0m reset password for test account [38;5;243m@ 03/03/25 18:57:09.76[0m
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
upgrade         | PASS    | 1        | 2m31s    | 2m31s    | 2m31s    | 2m31s
backup          | PASS    | 1        | 1m21s    | 1m21s    | 1m21s    | 1m21s
vscale          | PASS    | 1        | 2m51s    | 2m51s    | 2m51s    | 2m51s
volume-expansion | PASS    | 1        | 20s      | 20s      | 20s      | 20s
promote         | PASS    | 1        | 41s      | 41s      | 41s      | 41s
alert           | SKIP    | 0        | -        | -        | -        | -
database        | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
dms             | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
monitor         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: mysql | Mode: replication | Version: 8.0.31 | Operations: 5/12 (41.7%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/account_test.go:173 [38;5;243m@ 03/03/25 18:57:11.377[0m
=== Test Failed ===
Engine: mysql
Mode: replication
Version: 8.0.31
Cluster: e2e-f9gl0tcp
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [526.790 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] mysql/replication/8.0.31[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] Unexpected error:
<*errors.errorString | 0xc0004ac580>:
failed to update account password: 500 Internal Server Error
{
s: "failed to update account password: 500 Internal Server Error",
}
occurred[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/account_test.go:173[0m [38;5;243m@ 03/03/25 18:57:11.377[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mmysql/standalone/5.7.44[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 18:57:11.377[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 18:57:11.377[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 18:57:11.377[0m
[1mSTEP:[0m build mysql cluster [38;5;243m@ 03/03/25 18:57:11.377[0m
[1mSTEP:[0m set mode standalone [38;5;243m@ 03/03/25 18:57:11.377[0m
[1mSTEP:[0m set version 5.7.44 [38;5;243m@ 03/03/25 18:57:11.377[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 18:57:11.377[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 18:57:11.377[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 18:57:11.395[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 18:57:11.395[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 18:57:11.396[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 18:57:11.398[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 18:57:11.398[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 18:57:11.637[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 18:57:11.637[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 18:57:11.637[0m
[1mSTEP:[0m verify component mysql [38;5;243m@ 03/03/25 18:57:11.637[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 18:57:11.637[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 18:57:11.637[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 18:57:11.637[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"xtrabackup","cronExpression":"0 2 * * *","incrementalBackupEnabled":true,"incrementalCronExpression":"10 * * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"1c1g","components":[{"classCode":"mysql.standalone.mysql.1c1g.general","classSeries":"general","codeShort":"1c1g","component":"mysql","cpu":1,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T18:57:11.635Z","engine":"mysql","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-0-66f9bc59b5","id":"432515674913376826","initOptions":[{"component":"mysql","initParams":{"pool_buffer_size":"{{- $pool_buffer_size := ( callBufferSizeByResource ( index $.podSpec.containers 0 ) true ) }}"},"specName":"mysql-replication-config"}],"mode":"standalone","name":"e2e-0bhwjm8f","orgName":"e2e-test","paramTpls":[{"component":"mysql","paramTplID":"432515674577832506","paramTplName":"e2e-0bhwjm8f-mysql-temp","paramTplPartition":"custom"}],"parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T18:57:11.635Z","version":"5.7.44"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 18:57:11.637[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:57:11.637[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-0bhwjm8f status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-0bhwjm8f status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-0bhwjm8f status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-0bhwjm8f status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-0bhwjm8f status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 18:57:51.749[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 18:57:51.765[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 18:57:51.765[0m
[1mSTEP:[0m verify component mysql [38;5;243m@ 03/03/25 18:57:51.765[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 18:57:51.765[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 18:57:51.765[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 18:57:51.765[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 18:57:51.765[0m
Engine: mysql
Mode: standalone
Version: 5.7.44
Components:
- mysql:
Replicas: 1-1 (default: 1)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ“ database:
âœ“ dms:
âœ“ bench:
âœ“ backup:
âœ“ metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
mysql:
âœ“ dashboard
âœ“ log
âœ“ parameter
âœ— promote: replicas range is 1-1
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
- vscale: Scale cluster components vertically
Supported Components: [mysql]
- volume-expansion: Expand cluster volumes
Supported Components: [mysql]
- promote: Promote cluster components
- upgrade: Upgrade cluster
Supported Components: [mysql]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [mysql]
- restart: Restart cluster components
Supported Components: [mysql]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. vscale: Scale cluster components vertically
Supported Components: [mysql]
3. volume-expansion: Expand cluster volumes
Supported Components: [mysql]
4. upgrade: Upgrade cluster
Supported Components: [mysql]
5. account: Account operations
6. database: Database operations
7. monitor: Monitor operations
8. stop-start: Stop and start cluster
Supported Components: [mysql]
9. restart: Restart cluster components
Supported Components: [mysql]
10. dms: Data management operations
11. alert: Alert operations
[1mSTEP:[0m [1/11] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 18:57:51.766[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 18:57:51.766[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 18:57:51.77[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 18:57:51.77[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-0-66f9bc59b5-xtrabackup-20250303185751 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-0-66f9bc59b5-xtrabackup-20250303185751 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-0-66f9bc59b5-xtrabackup-20250303185751 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 18:58:11.797[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup cbf1998c-e2e-0-66f9bc59b5-mysq-archive-binlog is running
[1mSTEP:[0m default backup method: xtrabackup [38;5;243m@ 03/03/25 18:58:11.799[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 18:58:11.799[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 18:58:11.855[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup8e86lffj in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup8e86lffj completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 18:58:21.868[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 18:58:21.873[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"xtrabackup","cronExpression":"0 2 * * *","incrementalBackupEnabled":true,"incrementalCronExpression":"10 * * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"mysql.standalone.mysql.1c1g.general","classSeries":"general","codeShort":"1c1g","component":"mysql","cpu":1,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-2t7msu5i","engine":"mysql","environmentName":"cloud-dev","mode":"standalone","name":"restore-e2e-2t7msu5i","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"5.7.44"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 18:58:22.113[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 18:58:22.113[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-2t7msu5i status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-2t7msu5i status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-2t7msu5i status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-2t7msu5i status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-2t7msu5i status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-2t7msu5i status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-2t7msu5i status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-2t7msu5i status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 18:59:32.282[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-2t7msu5i [38;5;243m@ 03/03/25 18:59:32.3[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 18:59:32.507[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 18:59:32.51[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 1m40.768523794s
[1mSTEP:[0m [2/11] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 18:59:32.534[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 18:59:32.534[0m
[1mSTEP:[0m choose component: mysql [38;5;243m@ 03/03/25 18:59:32.534[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: mysql.standalone.mysql.1c1g.general [38;5;243m@ 03/03/25 18:59:32.556[0m
[1mSTEP:[0m choose larger class: mysql.standalone.mysql.2c2g.general [38;5;243m@ 03/03/25 18:59:32.556[0m
[1mSTEP:[0m changing component mysql class to mysql.standalone.mysql.2c2g.general [38;5;243m@ 03/03/25 18:59:32.556[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432515911405013562 to be Succeed [38;5;243m@ 03/03/25 18:59:32.592[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-verticalscaling-vmt5l status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-verticalscaling-vmt5l status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 18:59:52.652044    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-verticalscaling-vmt5l status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-verticalscaling-vmt5l status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-verticalscaling-vmt5l status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:00:22.824[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-0bhwjm8f status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 19:00:22.838[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 19:00:22.854[0m
[1mSTEP:[0m changing component mysql class to mysql.standalone.mysql.1c1g.general [38;5;243m@ 03/03/25 19:00:22.854[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432515995777632826 to be Succeed [38;5;243m@ 03/03/25 19:00:22.887[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-verticalscaling-ndvbk status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-verticalscaling-ndvbk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-verticalscaling-ndvbk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-verticalscaling-ndvbk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-verticalscaling-ndvbk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-verticalscaling-ndvbk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-verticalscaling-ndvbk status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:01:23.056[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-0bhwjm8f status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 19:01:23.071[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 1m50.552585049s
[1mSTEP:[0m [3/11] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 19:01:23.087[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 19:01:23.087[0m
[1mSTEP:[0m choose component: mysql [38;5;243m@ 03/03/25 19:01:23.087[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 19:01:23.087[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432516096843582010 to be Succeed [38;5;243m@ 03/03/25 19:01:23.126[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-volumeexpansion-hfk6l status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-volumeexpansion-hfk6l status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-0-66f9bc59b5-volumeexpansion-hfk6l status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:01:43.189[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-0bhwjm8f status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 20.132827324s
[1mSTEP:[0m [4/11] Executing operation: upgrade - Upgrade cluster [38;5;243m@ 03/03/25 19:01:43.22[0m
[1mSTEP:[0m upgrade cluster [38;5;243m@ 03/03/25 19:01:43.22[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/upgradeableServiceVersion engineOption.ListUpgradeableServiceVersion
no upgradeable version available for component mysql, trying next
no component supports upgrade
Operation upgrade completed in 24.519594ms
[1mSTEP:[0m [5/11] Executing operation: account - Account operations [38;5;243m@ 03/03/25 19:01:43.244[0m
[1mSTEP:[0m test cluster account [38;5;243m@ 03/03/25 19:01:43.244[0m
[1mSTEP:[0m list accounts before creation [38;5;243m@ 03/03/25 19:01:43.244[0m
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[1mSTEP:[0m invalidate account name pattern will be banned [38;5;243m@ 03/03/25 19:01:43.475[0m
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[1mSTEP:[0m create test account [38;5;243m@ 03/03/25 19:01:43.487[0m
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[1mSTEP:[0m list accounts after creation [38;5;243m@ 03/03/25 19:01:43.507[0m
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/databases database.listDatabases
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/databases database.createDatabase
[1mSTEP:[0m validate account privileges [38;5;243m@ 03/03/25 19:01:43.641[0m
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[1mSTEP:[0m update account privilege [38;5;243m@ 03/03/25 19:01:43.829[0m
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[1mSTEP:[0m reset password for test account [38;5;243m@ 03/03/25 19:01:44.575[0m
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
backup          | PASS    | 1        | 1m41s    | 1m41s    | 1m41s    | 1m41s
vscale          | PASS    | 1        | 1m51s    | 1m51s    | 1m51s    | 1m51s
volume-expansion | PASS    | 1        | 20s      | 20s      | 20s      | 20s
upgrade         | PASS    | 1        | 0s       | 0s       | 0s       | 0s
database        | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
dms             | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
monitor         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: mysql | Mode: standalone | Version: 5.7.44 | Operations: 4/11 (36.4%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/account_test.go:173 [38;5;243m@ 03/03/25 19:01:45.919[0m
=== Test Failed ===
Engine: mysql
Mode: standalone
Version: 5.7.44
Cluster: e2e-0bhwjm8f
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [274.542 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] mysql/standalone/5.7.44[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] Unexpected error:
<*errors.errorString | 0xc0002f6070>:
failed to update account password: 500 Internal Server Error
{
s: "failed to update account password: 500 Internal Server Error",
}
occurred[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/account_test.go:173[0m [38;5;243m@ 03/03/25 19:01:45.919[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mmysql/standalone/8.0.31[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 19:01:45.919[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 19:01:45.919[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 19:01:45.919[0m
[1mSTEP:[0m build mysql cluster [38;5;243m@ 03/03/25 19:01:45.919[0m
[1mSTEP:[0m set mode standalone [38;5;243m@ 03/03/25 19:01:45.919[0m
[1mSTEP:[0m set version 8.0.31 [38;5;243m@ 03/03/25 19:01:45.919[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 19:01:45.919[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 19:01:45.919[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 19:01:45.936[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 19:01:45.936[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 19:01:45.936[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 19:01:45.939[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 19:01:45.94[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:01:46.176[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 19:01:46.176[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 19:01:46.176[0m
[1mSTEP:[0m verify component mysql [38;5;243m@ 03/03/25 19:01:46.176[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 19:01:46.176[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 19:01:46.176[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 19:01:46.176[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"xtrabackup","cronExpression":"0 2 * * *","incrementalBackupEnabled":true,"incrementalCronExpression":"10 * * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"1c1g","components":[{"classCode":"mysql.standalone.mysql.1c1g.general","classSeries":"general","codeShort":"1c1g","component":"mysql","cpu":1,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T19:01:46.173Z","engine":"mysql","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-u-5d9f676d6d","id":"432516135515064890","initOptions":[{"component":"mysql","initParams":{"pool_buffer_size":"{{- $pool_buffer_size := ( callBufferSizeByResource ( index $.podSpec.containers 0 ) true ) }}"},"specName":"mysql-replication-config"}],"mode":"standalone","name":"e2e-u2515a5k","orgName":"e2e-test","paramTpls":[{"component":"mysql","paramTplID":"432516135179520570","paramTplName":"e2e-u2515a5k-mysql-temp","paramTplPartition":"custom"}],"parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T19:01:46.173Z","version":"8.0.31"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 19:01:46.176[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:01:46.176[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-u2515a5k status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-u2515a5k status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-u2515a5k status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-u2515a5k status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-u2515a5k status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:02:26.268[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 19:02:26.284[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 19:02:26.284[0m
[1mSTEP:[0m verify component mysql [38;5;243m@ 03/03/25 19:02:26.284[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 19:02:26.284[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 19:02:26.285[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 19:02:26.285[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 19:02:26.285[0m
Engine: mysql
Mode: standalone
Version: 8.0.31
Components:
- mysql:
Replicas: 1-1 (default: 1)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ“ database:
âœ“ dms:
âœ“ bench:
âœ“ backup:
âœ“ metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
mysql:
âœ“ dashboard
âœ“ log
âœ“ parameter
âœ— promote: replicas range is 1-1
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
- vscale: Scale cluster components vertically
Supported Components: [mysql]
- volume-expansion: Expand cluster volumes
Supported Components: [mysql]
- promote: Promote cluster components
- upgrade: Upgrade cluster
Supported Components: [mysql]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [mysql]
- restart: Restart cluster components
Supported Components: [mysql]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. vscale: Scale cluster components vertically
Supported Components: [mysql]
3. volume-expansion: Expand cluster volumes
Supported Components: [mysql]
4. upgrade: Upgrade cluster
Supported Components: [mysql]
5. account: Account operations
6. database: Database operations
7. monitor: Monitor operations
8. stop-start: Stop and start cluster
Supported Components: [mysql]
9. restart: Restart cluster components
Supported Components: [mysql]
10. dms: Data management operations
11. alert: Alert operations
[1mSTEP:[0m [1/11] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 19:02:26.285[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 19:02:26.285[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 19:02:26.287[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 19:02:26.287[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-u-5d9f676d6d-xtrabackup-20250303190224 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-u-5d9f676d6d-xtrabackup-20250303190224 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 19:02:36.3[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup 81a3bf1b-e2e-u-5d9f676d6d-mysq-archive-binlog is running
[1mSTEP:[0m default backup method: xtrabackup [38;5;243m@ 03/03/25 19:02:36.302[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 19:02:36.302[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 19:02:36.362[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupp8bdzeur in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupp8bdzeur completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 19:02:46.376[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 19:02:46.38[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"xtrabackup","cronExpression":"0 2 * * *","incrementalBackupEnabled":true,"incrementalCronExpression":"10 * * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"mysql.standalone.mysql.1c1g.general","classSeries":"general","codeShort":"1c1g","component":"mysql","cpu":1,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-jh9qehif","engine":"mysql","environmentName":"cloud-dev","mode":"standalone","name":"restore-e2e-jh9qehif","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"8.0.31"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 19:02:46.625[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:02:46.625[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-jh9qehif status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-jh9qehif status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 19:03:06.674782    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-jh9qehif status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-jh9qehif status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-jh9qehif status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-jh9qehif status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-jh9qehif status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:03:56.858[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-jh9qehif [38;5;243m@ 03/03/25 19:03:56.873[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 19:03:57.11[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 19:03:57.112[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 1m30.852969389s
[1mSTEP:[0m [2/11] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 19:03:57.138[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 19:03:57.138[0m
[1mSTEP:[0m choose component: mysql [38;5;243m@ 03/03/25 19:03:57.138[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: mysql.standalone.mysql.1c1g.general [38;5;243m@ 03/03/25 19:03:57.154[0m
[1mSTEP:[0m choose larger class: mysql.standalone.mysql.2c2g.general [38;5;243m@ 03/03/25 19:03:57.154[0m
[1mSTEP:[0m changing component mysql class to mysql.standalone.mysql.2c2g.general [38;5;243m@ 03/03/25 19:03:57.154[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432516355313371706 to be Succeed [38;5;243m@ 03/03/25 19:03:57.191[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-verticalscaling-g4bfz status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-verticalscaling-g4bfz status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-verticalscaling-g4bfz status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-verticalscaling-g4bfz status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-verticalscaling-g4bfz status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-verticalscaling-g4bfz status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:04:47.355[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-u2515a5k status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 19:04:47.37[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 19:04:47.385[0m
[1mSTEP:[0m changing component mysql class to mysql.standalone.mysql.1c1g.general [38;5;243m@ 03/03/25 19:04:47.385[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432516439585327674 to be Succeed [38;5;243m@ 03/03/25 19:04:47.414[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-verticalscaling-htn6d status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-verticalscaling-htn6d status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-verticalscaling-htn6d status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-verticalscaling-htn6d status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-verticalscaling-htn6d status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-verticalscaling-htn6d status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:05:37.561[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-u2515a5k status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 19:05:37.577[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 1m40.453326254s
[1mSTEP:[0m [3/11] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 19:05:37.591[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 19:05:37.591[0m
[1mSTEP:[0m choose component: mysql [38;5;243m@ 03/03/25 19:05:37.591[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 19:05:37.591[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432516523823729210 to be Succeed [38;5;243m@ 03/03/25 19:05:37.631[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-volumeexpansion-9bxjk status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-volumeexpansion-9bxjk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-volumeexpansion-9bxjk status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:05:57.7[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-u2515a5k status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 20.139636149s
[1mSTEP:[0m [4/11] Executing operation: upgrade - Upgrade cluster [38;5;243m@ 03/03/25 19:05:57.731[0m
[1mSTEP:[0m upgrade cluster [38;5;243m@ 03/03/25 19:05:57.731[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/upgradeableServiceVersion engineOption.ListUpgradeableServiceVersion
[1mSTEP:[0m selected component mysql for upgrade testing [38;5;243m@ 03/03/25 19:05:57.755[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/upgradeableServiceVersion engineOption.ListUpgradeableServiceVersion
[1mSTEP:[0m upgrade #1 - current version: 8.0.31 [38;5;243m@ 03/03/25 19:05:57.783[0m
[1mSTEP:[0m choosing target version: 8.0.36 [38;5;243m@ 03/03/25 19:05:57.783[0m
[1mSTEP:[0m upgrading component mysql to version 8.0.36 [38;5;243m@ 03/03/25 19:05:57.783[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/upgrade opsrequest.upgradeCluster
[1mSTEP:[0m wait task 432516557696928314 to be Succeed [38;5;243m@ 03/03/25 19:05:57.82[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-upgrade-vnn2p status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-upgrade-vnn2p status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 19:06:17.865878    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-upgrade-vnn2p status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-upgrade-vnn2p status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-upgrade-vnn2p status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:06:48.005[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-u2515a5k status: Running
[1mSTEP:[0m verify the version is updated [38;5;243m@ 03/03/25 19:06:48.02[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/upgradeableServiceVersion engineOption.ListUpgradeableServiceVersion
[1mSTEP:[0m upgrade #2 - current version: 8.0.31 [38;5;243m@ 03/03/25 19:06:48.061[0m
[1mSTEP:[0m choosing target version: 8.0.39 [38;5;243m@ 03/03/25 19:06:48.061[0m
[1mSTEP:[0m upgrading component mysql to version 8.0.39 [38;5;243m@ 03/03/25 19:06:48.061[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/upgrade opsrequest.upgradeCluster
[1mSTEP:[0m wait task 432516642069547578 to be Succeed [38;5;243m@ 03/03/25 19:06:48.109[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-upgrade-9mtjc status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-upgrade-9mtjc status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-upgrade-9mtjc status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-upgrade-9mtjc status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-u-5d9f676d6d-upgrade-9mtjc status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:07:28.243[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-u2515a5k status: Running
[1mSTEP:[0m verify the version is updated [38;5;243m@ 03/03/25 19:07:28.259[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation upgrade completed in 1m30.543468482s
[1mSTEP:[0m [5/11] Executing operation: account - Account operations [38;5;243m@ 03/03/25 19:07:28.274[0m
[1mSTEP:[0m test cluster account [38;5;243m@ 03/03/25 19:07:28.274[0m
[1mSTEP:[0m list accounts before creation [38;5;243m@ 03/03/25 19:07:28.275[0m
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[1mSTEP:[0m invalidate account name pattern will be banned [38;5;243m@ 03/03/25 19:07:28.519[0m
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[1mSTEP:[0m create test account [38;5;243m@ 03/03/25 19:07:28.531[0m
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[1mSTEP:[0m list accounts after creation [38;5;243m@ 03/03/25 19:07:28.561[0m
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/databases database.listDatabases
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/databases database.createDatabase
[1mSTEP:[0m validate account privileges [38;5;243m@ 03/03/25 19:07:28.723[0m
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] POST /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.createAccount
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[1mSTEP:[0m update account privilege [38;5;243m@ 03/03/25 19:07:28.954[0m
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName}/privileges account.updateAccountPrivileges
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts account.listAccounts
[1mSTEP:[0m reset password for test account [38;5;243m@ 03/03/25 19:07:29.743[0m
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
[API] PATCH /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} account.updateAccount
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
backup          | PASS    | 1        | 1m31s    | 1m31s    | 1m31s    | 1m31s
vscale          | PASS    | 1        | 1m40s    | 1m40s    | 1m40s    | 1m40s
volume-expansion | PASS    | 1        | 20s      | 20s      | 20s      | 20s
upgrade         | PASS    | 1        | 1m31s    | 1m31s    | 1m31s    | 1m31s
account         | SKIP    | 0        | -        | -        | -        | -
dms             | SKIP    | 0        | -        | -        | -        | -
database        | SKIP    | 0        | -        | -        | -        | -
monitor         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: mysql | Mode: standalone | Version: 8.0.31 | Operations: 4/11 (36.4%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/account_test.go:173 [38;5;243m@ 03/03/25 19:07:31.35[0m
=== Test Failed ===
Engine: mysql
Mode: standalone
Version: 8.0.31
Cluster: e2e-u2515a5k
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [345.431 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] mysql/standalone/8.0.31[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] Unexpected error:
<*errors.errorString | 0xc0003fc780>:
failed to update account password: 500 Internal Server Error
{
s: "failed to update account password: 500 Internal Server Error",
}
occurred[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/account_test.go:173[0m [38;5;243m@ 03/03/25 19:07:31.35[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mmysql/standalone/8.0.32[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 19:07:31.35[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 19:07:31.35[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 19:07:31.35[0m
[1mSTEP:[0m build mysql cluster [38;5;243m@ 03/03/25 19:07:31.35[0m
[1mSTEP:[0m set mode standalone [38;5;243m@ 03/03/25 19:07:31.35[0m
[1mSTEP:[0m set version 8.0.32 [38;5;243m@ 03/03/25 19:07:31.35[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 19:07:31.35[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 19:07:31.35[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 19:07:31.37[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 19:07:31.37[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 19:07:31.37[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 19:07:31.373[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 19:07:31.373[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:07:31.609[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 19:07:31.609[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 19:07:31.609[0m
[1mSTEP:[0m verify component mysql [38;5;243m@ 03/03/25 19:07:31.609[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 19:07:31.609[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 19:07:31.609[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 19:07:31.609[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"xtrabackup","cronExpression":"0 2 * * *","incrementalBackupEnabled":true,"incrementalCronExpression":"10 * * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"1c1g","components":[{"classCode":"mysql.standalone.mysql.1c1g.general","classSeries":"general","codeShort":"1c1g","component":"mysql","cpu":1,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T19:07:31.607Z","engine":"mysql","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-h-7d75c8887d","id":"432516715050437178","initOptions":[{"component":"mysql","initParams":{"pool_buffer_size":"{{- $pool_buffer_size := ( callBufferSizeByResource ( index $.podSpec.containers 0 ) true ) }}"},"specName":"mysql-replication-config"}],"mode":"standalone","name":"e2e-h7hof805","orgName":"e2e-test","paramTpls":[{"component":"mysql","paramTplID":"432516714714892858","paramTplName":"e2e-h7hof805-mysql-temp","paramTplPartition":"custom"}],"parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T19:07:31.607Z","version":"8.0.32"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 19:07:31.609[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:07:31.609[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-h7hof805 status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-h7hof805 status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-h7hof805 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-h7hof805 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-h7hof805 status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:08:11.717[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 19:08:11.732[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 19:08:11.732[0m
[1mSTEP:[0m verify component mysql [38;5;243m@ 03/03/25 19:08:11.732[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 19:08:11.732[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 19:08:11.732[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 19:08:11.732[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 19:08:11.732[0m
Engine: mysql
Mode: standalone
Version: 8.0.32
Components:
- mysql:
Replicas: 1-1 (default: 1)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ“ database:
âœ“ dms:
âœ“ bench:
âœ“ backup:
âœ“ metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
mysql:
âœ“ dashboard
âœ“ log
âœ“ parameter
âœ— promote: replicas range is 1-1
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
- vscale: Scale cluster components vertically
Supported Components: [mysql]
- volume-expansion: Expand cluster volumes
Supported Components: [mysql]
- promote: Promote cluster components
- upgrade: Upgrade cluster
Supported Components: [mysql]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [mysql]
- restart: Restart cluster components
Supported Components: [mysql]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. vscale: Scale cluster components vertically
Supported Components: [mysql]
3. volume-expansion: Expand cluster volumes
Supported Components: [mysql]
4. upgrade: Upgrade cluster
Supported Components: [mysql]
5. account: Account operations
6. database: Database operations
7. monitor: Monitor operations
8. stop-start: Stop and start cluster
Supported Components: [mysql]
9. restart: Restart cluster components
Supported Components: [mysql]
10. dms: Data management operations
11. alert: Alert operations
[1mSTEP:[0m [1/11] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 19:08:11.732[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 19:08:11.732[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 19:08:11.734[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 19:08:11.734[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-h-7d75c8887d-xtrabackup-20250303190811 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-h-7d75c8887d-xtrabackup-20250303190811 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 19:08:21.747[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup 42a46aeb-e2e-h-7d75c8887d-mysq-archive-binlog is running
[1mSTEP:[0m default backup method: xtrabackup [38;5;243m@ 03/03/25 19:08:21.749[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 19:08:21.749[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 19:08:21.807[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupwntv649u in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupwntv649u completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 19:08:31.813[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 19:08:31.818[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"xtrabackup","cronExpression":"0 2 * * *","incrementalBackupEnabled":true,"incrementalCronExpression":"10 * * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"mysql.standalone.mysql.1c1g.general","classSeries":"general","codeShort":"1c1g","component":"mysql","cpu":1,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-eqsoiqom","engine":"mysql","environmentName":"cloud-dev","mode":"standalone","name":"restore-e2e-eqsoiqom","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"8.0.32"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 19:08:32.057[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:08:32.057[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 19:09:32.195452    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 19:12:42.719723    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-eqsoiqom status: Restoring
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
alert           | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
dms             | SKIP    | 0        | -        | -        | -        | -
upgrade         | SKIP    | 0        | -        | -        | -        | -
database        | SKIP    | 0        | -        | -        | -        | -
monitor         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
backup          | SKIP    | 0        | -        | -        | -        | -
vscale          | SKIP    | 0        | -        | -        | -        | -
volume-expansion | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: mysql | Mode: standalone | Version: 8.0.32 | Operations: 0/11 (0.0%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/cluster_test.go:81 [38;5;243m@ 03/03/25 19:13:32.066[0m
=== Test Failed ===
Engine: mysql
Mode: standalone
Version: 8.0.32
Cluster: e2e-h7hof805
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [360.716 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] mysql/standalone/8.0.32[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] Timed out after 300.008s.
Expected
<constants.ClusterStatus>: Restoring
to equal
<constants.ClusterStatus>: Running[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/cluster_test.go:81[0m [38;5;243m@ 03/03/25 19:13:32.066[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/cluster/6.2.17[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 19:13:32.066[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 19:13:32.066[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 19:13:32.066[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 19:13:32.066[0m
[1mSTEP:[0m set mode cluster [38;5;243m@ 03/03/25 19:13:32.066[0m
[1mSTEP:[0m set version 6.2.17 [38;5;243m@ 03/03/25 19:13:32.066[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 19:13:32.066[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 19:13:32.066[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 19:13:32.087[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 19:13:32.087[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 19:13:32.087[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 19:13:32.09[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 19:13:32.09[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 19:13:32.09[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:13:32.26[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 19:13:32.26[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 19:13:32.26[0m
[1mSTEP:[0m verify component redis-cluster [38;5;243m@ 03/03/25 19:13:32.26[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 19:13:32.26[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 19:13:32.26[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 19:13:32.26[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.cluster.redis-cluster-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis-cluster","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T19:13:32.257Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-p-7b4864d5f4","id":"432517320120732218","mode":"cluster","name":"e2e-pcvgkdhh","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T19:13:32.257Z","version":"6.2.17"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 19:13:32.26[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:13:32.26[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 19:16:02.576530    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:16:12.672[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 19:16:12.687[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 19:16:12.687[0m
[1mSTEP:[0m verify component redis-cluster [38;5;243m@ 03/03/25 19:16:12.687[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 19:16:12.687[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 19:16:12.687[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 19:16:12.687[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 19:16:12.687[0m
Engine: redis
Mode: cluster
Version: 6.2.17
Components:
- redis-cluster:
Replicas: 2-3 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-cluster:
âœ“ dashboard
âœ“ hscale
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-sentinel:
âœ“ dashboard
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
Supported Components: [redis-cluster]
- vscale: Scale cluster components vertically
Supported Components: [redis-cluster]
- volume-expansion: Expand cluster volumes
Supported Components: [redis-cluster]
- promote: Promote cluster components
Supported Components: [redis-cluster]
- upgrade: Upgrade cluster
Supported Components: [redis-cluster]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis-cluster]
- restart: Restart cluster components
Supported Components: [redis-cluster]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. hscale: Scale cluster components horizontally
Supported Components: [redis-cluster]
3. vscale: Scale cluster components vertically
Supported Components: [redis-cluster]
4. volume-expansion: Expand cluster volumes
Supported Components: [redis-cluster]
5. promote: Promote cluster components
Supported Components: [redis-cluster]
6. upgrade: Upgrade cluster
Supported Components: [redis-cluster]
7. account: Account operations
8. stop-start: Stop and start cluster
Supported Components: [redis-cluster]
9. restart: Restart cluster components
Supported Components: [redis-cluster]
10. alert: Alert operations
[1mSTEP:[0m [1/10] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 19:16:12.688[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 19:16:12.688[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 19:16:12.69[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 19:16:12.69[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-p-7b4864d5f4-datafile-20250303191558 completed
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 19:16:12.692[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 19:16:12.692[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 19:16:12.752[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup54j7csm0 in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup54j7csm0 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup54j7csm0 completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 19:16:32.777[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 19:16:32.781[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.cluster.redis-cluster-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis-cluster","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-9krufot0","engine":"redis","environmentName":"cloud-dev","mode":"cluster","name":"restore-e2e-9krufot0","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"6.2.17"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 19:16:32.968[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:16:32.968[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-9krufot0 status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:18:53.286[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-9krufot0 [38;5;243m@ 03/03/25 19:18:53.302[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 19:18:53.416[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 19:18:53.419[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 2m40.75682671s
[1mSTEP:[0m [2/10] Executing operation: hscale - Scale cluster components horizontally [38;5;243m@ 03/03/25 19:18:53.444[0m
[1mSTEP:[0m scale cluster horizontally [38;5;243m@ 03/03/25 19:18:53.444[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 19:18:53.445[0m
[1mSTEP:[0m current replicas: 2 [38;5;243m@ 03/03/25 19:18:53.445[0m
[1mSTEP:[0m scale redis-cluster from 2 to 3 [38;5;243m@ 03/03/25 19:18:53.445[0m
[1mSTEP:[0m changing component redis-cluster replicas to 3 [38;5;243m@ 03/03/25 19:18:53.445[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432517859038464570 to be Succeed [38;5;243m@ 03/03/25 19:18:53.475[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-horizontalscaling-mww2c status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-horizontalscaling-mww2c status: Pending, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 19:19:13.524538    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-horizontalscaling-mww2c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-horizontalscaling-mww2c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-horizontalscaling-mww2c status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-horizontalscaling-mww2c status: Succeed, cluster status: Updating
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:19:53.681[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale down to original replicas [38;5;243m@ 03/03/25 19:20:13.758[0m
[1mSTEP:[0m changing component redis-cluster replicas to 2 [38;5;243m@ 03/03/25 19:20:13.758[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432517993776286266 to be Succeed [38;5;243m@ 03/03/25 19:20:13.787[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-horizontalscaling-s2zdr status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-horizontalscaling-s2zdr status: Pending, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-horizontalscaling-s2zdr status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-horizontalscaling-s2zdr status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:20:43.873[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation hscale completed in 1m50.459585411s
[1mSTEP:[0m [3/10] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 19:20:43.904[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 19:20:43.904[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 19:20:43.904[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.cluster.redis-cluster-7.2c1g.general [38;5;243m@ 03/03/25 19:20:43.921[0m
[1mSTEP:[0m choose larger class: redis.cluster.redis-cluster-7.2c2g.general [38;5;243m@ 03/03/25 19:20:43.921[0m
[1mSTEP:[0m changing component redis-cluster class to redis.cluster.redis-cluster-7.2c2g.general [38;5;243m@ 03/03/25 19:20:43.921[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432518044376369722 to be Succeed [38;5;243m@ 03/03/25 19:20:43.951[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-qbx2f status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-qbx2f status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-qbx2f status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-qbx2f status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-qbx2f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-qbx2f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-qbx2f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-qbx2f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-qbx2f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-qbx2f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 19:22:24.207019    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-qbx2f status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:22:34.256[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 19:22:34.271[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 19:22:34.285[0m
[1mSTEP:[0m changing component redis-cluster class to redis.cluster.redis-cluster-7.2c1g.general [38;5;243m@ 03/03/25 19:22:34.285[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432518229546502714 to be Succeed [38;5;243m@ 03/03/25 19:22:34.314[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-568lq status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-568lq status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-568lq status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-568lq status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-568lq status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-568lq status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-568lq status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-568lq status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-568lq status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-568lq status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-verticalscaling-568lq status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:24:14.599[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 19:24:14.613[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 3m30.723879255s
[1mSTEP:[0m [4/10] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 19:24:14.628[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 19:24:14.628[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 19:24:14.628[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 19:24:14.628[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432518397905865274 to be Succeed [38;5;243m@ 03/03/25 19:24:14.669[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-volumeexpansion-5splk status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-volumeexpansion-5splk status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-volumeexpansion-5splk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-volumeexpansion-5splk status: Succeed, cluster status: Updating
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:24:44.76[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 50.201571759s
[1mSTEP:[0m [5/10] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 19:25:04.83[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 19:25:04.83[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:25:04.83[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Running
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 19:25:04.845[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-p-7b4864d5f4-shard-zzl-1 with role secondary [38;5;243m@ 03/03/25 19:25:05.154[0m
[1mSTEP:[0m promoting instance e2e-p-7b4864d5f4-shard-zzl-1 of component redis-cluster from secondary to primary [38;5;243m@ 03/03/25 19:25:05.154[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432518482714692154 to be Succeed [38;5;243m@ 03/03/25 19:25:05.214[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-switchover-m4vsr status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-switchover-m4vsr status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-switchover-m4vsr status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:25:25.289[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Running
[1mSTEP:[0m verify the instance role is updated [38;5;243m@ 03/03/25 19:25:25.303[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m second promotion: promote another instance e2e-p-7b4864d5f4-shard-mbz-1 with role secondary [38;5;243m@ 03/03/25 19:25:25.684[0m
[1mSTEP:[0m promoting instance e2e-p-7b4864d5f4-shard-mbz-1 of component redis-cluster from secondary to primary [38;5;243m@ 03/03/25 19:25:25.685[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432518517141539386 to be Succeed [38;5;243m@ 03/03/25 19:25:25.738[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-switchover-c2w4k status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 19:25:35.765391    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-switchover-c2w4k status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:25:45.79[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Running
[1mSTEP:[0m verify the instance role is updated [38;5;243m@ 03/03/25 19:25:45.806[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
Operation promote completed in 41.112152827s
[1mSTEP:[0m [6/10] Executing operation: upgrade - Upgrade cluster [38;5;243m@ 03/03/25 19:25:45.942[0m
[1mSTEP:[0m upgrade cluster [38;5;243m@ 03/03/25 19:25:45.942[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/upgradeableServiceVersion engineOption.ListUpgradeableServiceVersion
no upgradeable version available for component redis-cluster, trying next
no component supports upgrade
Operation upgrade completed in 25.344423ms
[1mSTEP:[0m [7/10] Executing operation: account - Account operations [38;5;243m@ 03/03/25 19:25:45.967[0m
[1mSTEP:[0m list redis account [38;5;243m@ 03/03/25 19:25:45.967[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/root-password account.getRootAccountPassword
[1mSTEP:[0m create redis account [38;5;243m@ 03/03/25 19:25:46.445[0m
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[1mSTEP:[0m list redis account after creation [38;5;243m@ 03/03/25 19:25:47.594[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[1mSTEP:[0m update redis account [38;5;243m@ 03/03/25 19:26:01.408[0m
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[1mSTEP:[0m list redis account after update [38;5;243m@ 03/03/25 19:26:02.57[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[1mSTEP:[0m delete redis account [38;5;243m@ 03/03/25 19:26:19.128[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[1mSTEP:[0m list redis account after deletion [38;5;243m@ 03/03/25 19:26:20.547[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
Operation account completed in 51.252388641s
[1mSTEP:[0m [8/10] Executing operation: stop-start - Stop and start cluster [38;5;243m@ 03/03/25 19:26:37.22[0m
[1mSTEP:[0m stop cluster [38;5;243m@ 03/03/25 19:26:37.22[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/stop opsrequest.stopCluster
[1mSTEP:[0m wait task 432518637115411002 to be Succeed [38;5;243m@ 03/03/25 19:26:37.248[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-stop-hjf57 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-stop-hjf57 status: Pending, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-stop-hjf57 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-stop-hjf57 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-stop-hjf57 status: Succeed, cluster status: Stopped
[1mSTEP:[0m waiting for cluster to reach status: Stopped [38;5;243m@ 03/03/25 19:27:17.375[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Stopped
[1mSTEP:[0m start cluster [38;5;243m@ 03/03/25 19:27:17.391[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/start opsrequest.startCluster
[1mSTEP:[0m wait task 432518704543042106 to be Succeed [38;5;243m@ 03/03/25 19:27:17.434[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-start-fnsvk status: , cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-start-fnsvk status: Creating, cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-start-fnsvk status: Running, cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-start-fnsvk status: Running, cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-start-fnsvk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-start-fnsvk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-start-fnsvk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-start-fnsvk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-start-fnsvk status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:28:37.657[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Running
Operation stop-start completed in 2m0.452898741s
[1mSTEP:[0m [9/10] Executing operation: restart - Restart cluster components [38;5;243m@ 03/03/25 19:28:37.673[0m
[1mSTEP:[0m restart cluster [38;5;243m@ 03/03/25 19:28:37.673[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 19:28:37.673[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/restart opsrequest.restartCluster
[1mSTEP:[0m wait task 432518839213754938 to be Succeed [38;5;243m@ 03/03/25 19:28:37.701[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-restart-bthvn status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 19:28:47.730229    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-restart-bthvn status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-restart-bthvn status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-restart-bthvn status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-restart-bthvn status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-restart-bthvn status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-restart-bthvn status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-restart-bthvn status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:29:58.011[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Running
Operation restart completed in 1m20.353238368s
[1mSTEP:[0m [10/10] Executing operation: alert - Alert operations [38;5;243m@ 03/03/25 19:29:58.026[0m
[1mSTEP:[0m Stop the cluster [38;5;243m@ 03/03/25 19:29:58.026[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/stop opsrequest.stopCluster
[1mSTEP:[0m wait task 432518974018685498 to be Succeed [38;5;243m@ 03/03/25 19:29:58.054[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-stop-dkz4g status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-stop-dkz4g status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-stop-dkz4g status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-stop-dkz4g status: Running, cluster status: Stopping
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-p-7b4864d5f4-stop-dkz4g status: Succeed, cluster status: Stopped
[1mSTEP:[0m waiting for cluster to reach status: Stopped [38;5;243m@ 03/03/25 19:30:38.165[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-pcvgkdhh status: Stopped
[1mSTEP:[0m Check for Down alert [38;5;243m@ 03/03/25 19:30:38.18[0m
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
Failed to list alerts: http: read on closed response body
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
Failed to list alerts: http: read on closed response body
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-pcvgkdhh yet
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
vscale          | PASS    | 1        | 3m31s    | 3m31s    | 3m31s    | 3m31s
volume-expansion | PASS    | 1        | 50s      | 50s      | 50s      | 50s
promote         | PASS    | 1        | 41s      | 41s      | 41s      | 41s
upgrade         | PASS    | 1        | 0s       | 0s       | 0s       | 0s
stop-start      | PASS    | 1        | 2m0s     | 2m0s     | 2m0s     | 2m0s
backup          | PASS    | 1        | 2m41s    | 2m41s    | 2m41s    | 2m41s
hscale          | PASS    | 1        | 1m50s    | 1m50s    | 1m50s    | 1m50s
account         | PASS    | 1        | 51s      | 51s      | 51s      | 51s
restart         | PASS    | 1        | 1m20s    | 1m20s    | 1m20s    | 1m20s
alert           | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: cluster | Version: 6.2.17 | Operations: 9/10 (90.0%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/alert_test.go:45 [38;5;243m@ 03/03/25 19:35:38.181[0m
=== Test Failed ===
Engine: redis
Mode: cluster
Version: 6.2.17
Cluster: e2e-pcvgkdhh
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [1326.115 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/cluster/6.2.17[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] Timed out after 300.000s.
should find Down alert for the stopped cluster
Expected
<bool>: false
to be true[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/alert_test.go:45[0m [38;5;243m@ 03/03/25 19:35:38.181[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/cluster/7.0.6[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 19:35:38.181[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 19:35:38.181[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 19:35:38.181[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 19:35:38.181[0m
[1mSTEP:[0m set mode cluster [38;5;243m@ 03/03/25 19:35:38.181[0m
[1mSTEP:[0m set version 7.0.6 [38;5;243m@ 03/03/25 19:35:38.181[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 19:35:38.181[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 19:35:38.181[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 19:35:38.199[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 19:35:38.199[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 19:35:38.199[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 19:35:38.202[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 19:35:38.202[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 19:35:38.202[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:35:38.382[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 19:35:38.382[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 19:35:38.382[0m
[1mSTEP:[0m verify component redis-cluster [38;5;243m@ 03/03/25 19:35:38.382[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 19:35:38.382[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 19:35:38.382[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 19:35:38.382[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.cluster.redis-cluster-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis-cluster","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T19:35:38.379Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-a-9cb9bd969","id":"432519544980900410","mode":"cluster","name":"e2e-au88n7je","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T19:35:38.379Z","version":"7.0.6"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 19:35:38.382[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:35:38.382[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:36:48.551[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 19:36:48.566[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 19:36:48.566[0m
[1mSTEP:[0m verify component redis-cluster [38;5;243m@ 03/03/25 19:36:48.566[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 19:36:48.566[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 19:36:48.566[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 19:36:48.566[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 19:36:48.566[0m
Engine: redis
Mode: cluster
Version: 7.0.6
Components:
- redis-cluster:
Replicas: 2-3 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-cluster:
âœ“ dashboard
âœ“ hscale
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-sentinel:
âœ“ dashboard
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
Supported Components: [redis-cluster]
- vscale: Scale cluster components vertically
Supported Components: [redis-cluster]
- volume-expansion: Expand cluster volumes
Supported Components: [redis-cluster]
- promote: Promote cluster components
Supported Components: [redis-cluster]
- upgrade: Upgrade cluster
Supported Components: [redis-cluster]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis-cluster]
- restart: Restart cluster components
Supported Components: [redis-cluster]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. hscale: Scale cluster components horizontally
Supported Components: [redis-cluster]
3. vscale: Scale cluster components vertically
Supported Components: [redis-cluster]
4. volume-expansion: Expand cluster volumes
Supported Components: [redis-cluster]
5. promote: Promote cluster components
Supported Components: [redis-cluster]
6. upgrade: Upgrade cluster
Supported Components: [redis-cluster]
7. account: Account operations
8. stop-start: Stop and start cluster
Supported Components: [redis-cluster]
9. restart: Restart cluster components
Supported Components: [redis-cluster]
10. alert: Alert operations
[1mSTEP:[0m [1/10] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 19:36:48.567[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 19:36:48.567[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 19:36:48.569[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 19:36:48.569[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-a-9cb9bd969-datafile-20250303193644 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-a-9cb9bd969-datafile-20250303193644 completed
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 19:36:58.582[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 19:36:58.582[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 19:36:58.646[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup3qnqw6zx in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup3qnqw6zx completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 19:37:08.652[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 19:37:08.656[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.cluster.redis-cluster-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis-cluster","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-55taiezd","engine":"redis","environmentName":"cloud-dev","mode":"cluster","name":"restore-e2e-55taiezd","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"7.0.6"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 19:37:08.845[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:37:08.845[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 19:38:19.001326    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-55taiezd status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:39:29.243[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-55taiezd [38;5;243m@ 03/03/25 19:39:29.259[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 19:39:29.382[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 19:39:29.384[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 2m40.841529535s
[1mSTEP:[0m [2/10] Executing operation: hscale - Scale cluster components horizontally [38;5;243m@ 03/03/25 19:39:29.408[0m
[1mSTEP:[0m scale cluster horizontally [38;5;243m@ 03/03/25 19:39:29.408[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 19:39:29.408[0m
[1mSTEP:[0m current replicas: 2 [38;5;243m@ 03/03/25 19:39:29.408[0m
[1mSTEP:[0m scale redis-cluster from 2 to 3 [38;5;243m@ 03/03/25 19:39:29.408[0m
[1mSTEP:[0m changing component redis-cluster replicas to 3 [38;5;243m@ 03/03/25 19:39:29.408[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432519932635253306 to be Succeed [38;5;243m@ 03/03/25 19:39:29.439[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-horizontalscaling-6czlq status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-horizontalscaling-6czlq status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-horizontalscaling-6czlq status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-horizontalscaling-6czlq status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-horizontalscaling-6czlq status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-horizontalscaling-6czlq status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-horizontalscaling-6czlq status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-horizontalscaling-6czlq status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:40:39.619[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale down to original replicas [38;5;243m@ 03/03/25 19:40:39.648[0m
[1mSTEP:[0m changing component redis-cluster replicas to 2 [38;5;243m@ 03/03/25 19:40:39.648[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432520050478418490 to be Succeed [38;5;243m@ 03/03/25 19:40:39.674[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-horizontalscaling-dbbrn status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-horizontalscaling-dbbrn status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-horizontalscaling-dbbrn status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-horizontalscaling-dbbrn status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:41:09.764[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation hscale completed in 1m40.38612562s
[1mSTEP:[0m [3/10] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 19:41:09.794[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 19:41:09.794[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 19:41:09.794[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.cluster.redis-cluster-7.2c1g.general [38;5;243m@ 03/03/25 19:41:09.81[0m
[1mSTEP:[0m choose larger class: redis.cluster.redis-cluster-7.2c2g.general [38;5;243m@ 03/03/25 19:41:09.81[0m
[1mSTEP:[0m changing component redis-cluster class to redis.cluster.redis-cluster-7.2c2g.general [38;5;243m@ 03/03/25 19:41:09.81[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432520101078501946 to be Succeed [38;5;243m@ 03/03/25 19:41:09.838[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-hgsqg status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-hgsqg status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 19:41:29.884291    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-hgsqg status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-hgsqg status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-hgsqg status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-hgsqg status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-hgsqg status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-hgsqg status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-hgsqg status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-hgsqg status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-hgsqg status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:43:00.181[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 19:43:00.196[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 19:43:00.21[0m
[1mSTEP:[0m changing component redis-cluster class to redis.cluster.redis-cluster-7.2c1g.general [38;5;243m@ 03/03/25 19:43:00.21[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432520286315743802 to be Succeed [38;5;243m@ 03/03/25 19:43:00.242[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-r7d5q status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-r7d5q status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-r7d5q status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-r7d5q status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-r7d5q status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-r7d5q status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-r7d5q status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-r7d5q status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-r7d5q status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-r7d5q status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 19:44:40.527237    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-verticalscaling-r7d5q status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:44:50.612[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 19:44:50.628[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 3m40.848247929s
[1mSTEP:[0m [4/10] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 19:44:50.643[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 19:44:50.643[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 19:44:50.643[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 19:44:50.643[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432520471603317306 to be Succeed [38;5;243m@ 03/03/25 19:44:50.749[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-volumeexpansion-h2f5v status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-volumeexpansion-h2f5v status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-volumeexpansion-h2f5v status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-volumeexpansion-h2f5v status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:45:21.316[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 30.70172641s
[1mSTEP:[0m [5/10] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 19:45:21.344[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 19:45:21.344[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:45:21.344[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Running
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 19:45:21.359[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-a-9cb9bd969-shard-x96-1 with role secondary [38;5;243m@ 03/03/25 19:45:21.622[0m
[1mSTEP:[0m promoting instance e2e-a-9cb9bd969-shard-x96-1 of component redis-cluster from secondary to primary [38;5;243m@ 03/03/25 19:45:21.622[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432520523595909690 to be Succeed [38;5;243m@ 03/03/25 19:45:21.675[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-switchover-9rjkq status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-switchover-9rjkq status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-switchover-9rjkq status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:45:41.74[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Running
[1mSTEP:[0m verify the instance role is updated [38;5;243m@ 03/03/25 19:45:41.755[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m second promotion: promote another instance e2e-a-9cb9bd969-shard-x96-0 with role secondary [38;5;243m@ 03/03/25 19:45:42.137[0m
[1mSTEP:[0m promoting instance e2e-a-9cb9bd969-shard-x96-0 of component redis-cluster from secondary to primary [38;5;243m@ 03/03/25 19:45:42.137[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432520558005979706 to be Succeed [38;5;243m@ 03/03/25 19:45:42.186[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-switchover-rssh5 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-switchover-rssh5 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-switchover-rssh5 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:46:02.251[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Running
[1mSTEP:[0m verify the instance role is updated [38;5;243m@ 03/03/25 19:46:02.264[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
Operation promote completed in 41.050632056s
[1mSTEP:[0m [6/10] Executing operation: upgrade - Upgrade cluster [38;5;243m@ 03/03/25 19:46:02.395[0m
[1mSTEP:[0m upgrade cluster [38;5;243m@ 03/03/25 19:46:02.395[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/upgradeableServiceVersion engineOption.ListUpgradeableServiceVersion
no upgradeable version available for component redis-cluster, trying next
no component supports upgrade
Operation upgrade completed in 24.970663ms
[1mSTEP:[0m [7/10] Executing operation: account - Account operations [38;5;243m@ 03/03/25 19:46:02.42[0m
[1mSTEP:[0m list redis account [38;5;243m@ 03/03/25 19:46:02.42[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/root-password account.getRootAccountPassword
[1mSTEP:[0m create redis account [38;5;243m@ 03/03/25 19:46:02.807[0m
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[1mSTEP:[0m list redis account after creation [38;5;243m@ 03/03/25 19:46:04.041[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[1mSTEP:[0m update redis account [38;5;243m@ 03/03/25 19:46:20.584[0m
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[1mSTEP:[0m list redis account after update [38;5;243m@ 03/03/25 19:46:22.09[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[1mSTEP:[0m delete redis account [38;5;243m@ 03/03/25 19:46:38.656[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[1mSTEP:[0m list redis account after deletion [38;5;243m@ 03/03/25 19:46:40.204[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
Operation account completed in 54.436470437s
[1mSTEP:[0m [8/10] Executing operation: stop-start - Stop and start cluster [38;5;243m@ 03/03/25 19:46:56.857[0m
[1mSTEP:[0m stop cluster [38;5;243m@ 03/03/25 19:46:56.857[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/stop opsrequest.stopCluster
[1mSTEP:[0m wait task 432520683331783226 to be Succeed [38;5;243m@ 03/03/25 19:46:56.885[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-stop-974s5 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-stop-974s5 status: Pending, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-stop-974s5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-stop-974s5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-stop-974s5 status: Succeed, cluster status: Stopped
[1mSTEP:[0m waiting for cluster to reach status: Stopped [38;5;243m@ 03/03/25 19:47:36.998[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Stopped
[1mSTEP:[0m start cluster [38;5;243m@ 03/03/25 19:47:37.014[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/start opsrequest.startCluster
[1mSTEP:[0m wait task 432520750725859898 to be Succeed [38;5;243m@ 03/03/25 19:47:37.058[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-start-6wp9x status: , cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-start-6wp9x status: Pending, cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 19:47:57.102870    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-start-6wp9x status: Running, cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-start-6wp9x status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-start-6wp9x status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-start-6wp9x status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-start-6wp9x status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-start-6wp9x status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:48:57.308[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Running
Operation stop-start completed in 2m0.467427088s
[1mSTEP:[0m [9/10] Executing operation: restart - Restart cluster components [38;5;243m@ 03/03/25 19:48:57.324[0m
[1mSTEP:[0m restart cluster [38;5;243m@ 03/03/25 19:48:57.324[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 19:48:57.324[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/restart opsrequest.restartCluster
[1mSTEP:[0m wait task 432520885446904378 to be Succeed [38;5;243m@ 03/03/25 19:48:57.354[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-restart-zrdmc status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-restart-zrdmc status: Pending, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-restart-zrdmc status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-restart-zrdmc status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-restart-zrdmc status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-restart-zrdmc status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-restart-zrdmc status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-restart-zrdmc status: Succeed, cluster status: Updating
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:50:07.565[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Running
Operation restart completed in 1m20.281417048s
[1mSTEP:[0m [10/10] Executing operation: alert - Alert operations [38;5;243m@ 03/03/25 19:50:17.606[0m
[1mSTEP:[0m Stop the cluster [38;5;243m@ 03/03/25 19:50:17.606[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/stop opsrequest.stopCluster
[1mSTEP:[0m wait task 432521020134394426 to be Succeed [38;5;243m@ 03/03/25 19:50:17.635[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-stop-4dxv4 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-stop-4dxv4 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-stop-4dxv4 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-stop-4dxv4 status: Running, cluster status: Stopping
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-9cb9bd969-stop-4dxv4 status: Succeed, cluster status: Stopped
[1mSTEP:[0m waiting for cluster to reach status: Stopped [38;5;243m@ 03/03/25 19:50:57.756[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-au88n7je status: Stopped
[1mSTEP:[0m Check for Down alert [38;5;243m@ 03/03/25 19:50:57.77[0m
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
Failed to list alerts: http: read on closed response body
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
Failed to list alerts: http: read on closed response body
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-au88n7je yet
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
hscale          | PASS    | 1        | 1m40s    | 1m40s    | 1m40s    | 1m40s
vscale          | PASS    | 1        | 3m41s    | 3m41s    | 3m41s    | 3m41s
promote         | PASS    | 1        | 41s      | 41s      | 41s      | 41s
backup          | PASS    | 1        | 2m41s    | 2m41s    | 2m41s    | 2m41s
volume-expansion | PASS    | 1        | 31s      | 31s      | 31s      | 31s
upgrade         | PASS    | 1        | 0s       | 0s       | 0s       | 0s
account         | PASS    | 1        | 54s      | 54s      | 54s      | 54s
stop-start      | PASS    | 1        | 2m0s     | 2m0s     | 2m0s     | 2m0s
restart         | PASS    | 1        | 1m20s    | 1m20s    | 1m20s    | 1m20s
alert           | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: cluster | Version: 7.0.6 | Operations: 9/10 (90.0%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/alert_test.go:45 [38;5;243m@ 03/03/25 19:55:57.771[0m
=== Test Failed ===
Engine: redis
Mode: cluster
Version: 7.0.6
Cluster: e2e-au88n7je
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [1219.590 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/cluster/7.0.6[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] Timed out after 300.000s.
should find Down alert for the stopped cluster
Expected
<bool>: false
to be true[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/alert_test.go:45[0m [38;5;243m@ 03/03/25 19:55:57.771[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/cluster/7.2.4[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 19:55:57.771[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 19:55:57.771[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 19:55:57.771[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 19:55:57.771[0m
[1mSTEP:[0m set mode cluster [38;5;243m@ 03/03/25 19:55:57.771[0m
[1mSTEP:[0m set version 7.2.4 [38;5;243m@ 03/03/25 19:55:57.771[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 19:55:57.771[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 19:55:57.771[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 19:55:57.788[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 19:55:57.788[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 19:55:57.788[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 19:55:57.79[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 19:55:57.79[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 19:55:57.79[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:55:57.963[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 19:55:57.963[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 19:55:57.963[0m
[1mSTEP:[0m verify component redis-cluster [38;5;243m@ 03/03/25 19:55:57.963[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 19:55:57.963[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 19:55:57.963[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 19:55:57.963[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.cluster.redis-cluster-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis-cluster","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T19:55:57.960Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-z-668d89d8d9","id":"432521591113386554","mode":"cluster","name":"e2e-zqq0tsmd","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T19:55:57.960Z","version":"7.2.4"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 19:55:57.963[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:55:57.963[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:57:08.14[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 19:57:08.155[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 19:57:08.155[0m
[1mSTEP:[0m verify component redis-cluster [38;5;243m@ 03/03/25 19:57:08.155[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 19:57:08.155[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 19:57:08.155[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 19:57:08.155[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 19:57:08.155[0m
Engine: redis
Mode: cluster
Version: 7.2.4
Components:
- redis-cluster:
Replicas: 2-3 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-cluster:
âœ“ dashboard
âœ“ hscale
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-sentinel:
âœ“ dashboard
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
Supported Components: [redis-cluster]
- vscale: Scale cluster components vertically
Supported Components: [redis-cluster]
- volume-expansion: Expand cluster volumes
Supported Components: [redis-cluster]
- promote: Promote cluster components
Supported Components: [redis-cluster]
- upgrade: Upgrade cluster
Supported Components: [redis-cluster]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis-cluster]
- restart: Restart cluster components
Supported Components: [redis-cluster]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. hscale: Scale cluster components horizontally
Supported Components: [redis-cluster]
3. vscale: Scale cluster components vertically
Supported Components: [redis-cluster]
4. volume-expansion: Expand cluster volumes
Supported Components: [redis-cluster]
5. promote: Promote cluster components
Supported Components: [redis-cluster]
6. upgrade: Upgrade cluster
Supported Components: [redis-cluster]
7. account: Account operations
8. stop-start: Stop and start cluster
Supported Components: [redis-cluster]
9. restart: Restart cluster components
Supported Components: [redis-cluster]
10. alert: Alert operations
[1mSTEP:[0m [1/10] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 19:57:08.155[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 19:57:08.155[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 19:57:08.159[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 19:57:08.159[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-z-668d89d8d9-datafile-20250303195702 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-z-668d89d8d9-datafile-20250303195702 completed
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 19:57:18.172[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 19:57:18.172[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 19:57:18.24[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backuprxvnm2l9 in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
failed to get backup e2e-backuprxvnm2l9: failed to get backup, err: http: read on closed response body
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backuprxvnm2l9 completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 19:57:38.248[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 19:57:38.252[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.cluster.redis-cluster-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis-cluster","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-xzwsr6n3","engine":"redis","environmentName":"cloud-dev","mode":"cluster","name":"restore-e2e-xzwsr6n3","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"7.2.4"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 19:57:38.436[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 19:57:38.436[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-xzwsr6n3 status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 19:59:58.754[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-xzwsr6n3 [38;5;243m@ 03/03/25 19:59:58.768[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 19:59:58.886[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 19:59:58.896[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 2m50.766141342s
[1mSTEP:[0m [2/10] Executing operation: hscale - Scale cluster components horizontally [38;5;243m@ 03/03/25 19:59:58.921[0m
[1mSTEP:[0m scale cluster horizontally [38;5;243m@ 03/03/25 19:59:58.921[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 19:59:58.921[0m
[1mSTEP:[0m current replicas: 2 [38;5;243m@ 03/03/25 19:59:58.921[0m
[1mSTEP:[0m scale redis-cluster from 2 to 3 [38;5;243m@ 03/03/25 19:59:58.922[0m
[1mSTEP:[0m changing component redis-cluster replicas to 3 [38;5;243m@ 03/03/25 19:59:58.922[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432521995427514938 to be Succeed [38;5;243m@ 03/03/25 19:59:58.953[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-horizontalscaling-96mlk status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-horizontalscaling-96mlk status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-horizontalscaling-96mlk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-horizontalscaling-96mlk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:00:39.051188    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-horizontalscaling-96mlk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-horizontalscaling-96mlk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-horizontalscaling-96mlk status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:01:09.136[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale down to original replicas [38;5;243m@ 03/03/25 20:01:09.165[0m
[1mSTEP:[0m changing component redis-cluster replicas to 2 [38;5;243m@ 03/03/25 20:01:09.165[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432522113270680122 to be Succeed [38;5;243m@ 03/03/25 20:01:09.193[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-horizontalscaling-zjp4l status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-horizontalscaling-zjp4l status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-horizontalscaling-zjp4l status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-horizontalscaling-zjp4l status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:01:39.3[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation hscale completed in 1m40.410720337s
[1mSTEP:[0m [3/10] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 20:01:39.332[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 20:01:39.332[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 20:01:39.332[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.cluster.redis-cluster-7.2c1g.general [38;5;243m@ 03/03/25 20:01:39.348[0m
[1mSTEP:[0m choose larger class: redis.cluster.redis-cluster-7.2c2g.general [38;5;243m@ 03/03/25 20:01:39.349[0m
[1mSTEP:[0m changing component redis-cluster class to redis.cluster.redis-cluster-7.2c2g.general [38;5;243m@ 03/03/25 20:01:39.349[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432522163921095226 to be Succeed [38;5;243m@ 03/03/25 20:01:39.382[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-zh6mw status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-zh6mw status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-zh6mw status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-zh6mw status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-zh6mw status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-zh6mw status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-zh6mw status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-zh6mw status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-zh6mw status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-zh6mw status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-zh6mw status: Succeed, cluster status: Updating
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:03:19.648[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 20:03:29.688[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 20:03:29.704[0m
[1mSTEP:[0m changing component redis-cluster class to redis.cluster.redis-cluster-7.2c1g.general [38;5;243m@ 03/03/25 20:03:29.704[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432522349057673786 to be Succeed [38;5;243m@ 03/03/25 20:03:29.737[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-7hn67 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-7hn67 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:03:49.783380    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-7hn67 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-7hn67 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-7hn67 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-7hn67 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-7hn67 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-7hn67 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-7hn67 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-verticalscaling-7hn67 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:05:10.041[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 20:05:10.056[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 3m30.738664759s
[1mSTEP:[0m [4/10] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 20:05:10.071[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 20:05:10.071[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 20:05:10.071[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 20:05:10.071[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432522517467367994 to be Succeed [38;5;243m@ 03/03/25 20:05:10.112[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-volumeexpansion-hnd5z status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-volumeexpansion-hnd5z status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-volumeexpansion-hnd5z status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-volumeexpansion-hnd5z status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:05:40.221[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 30.1808979s
[1mSTEP:[0m [5/10] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 20:05:40.252[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 20:05:40.252[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:05:40.252[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-zqq0tsmd status: Running
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 20:05:40.267[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-z-668d89d8d9-shard-99z-1 with role secondary [38;5;243m@ 03/03/25 20:05:40.548[0m
[1mSTEP:[0m promoting instance e2e-z-668d89d8d9-shard-99z-1 of component redis-cluster from secondary to primary [38;5;243m@ 03/03/25 20:05:40.548[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432522568621099578 to be Succeed [38;5;243m@ 03/03/25 20:05:40.611[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-switchover-lvqkw status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-switchover-lvqkw status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-switchover-lvqkw status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-switchover-lvqkw status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-switchover-lvqkw status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-z-668d89d8d9-switchover-lvqkw status: Failed, cluster status: Running
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
volume-expansion | PASS    | 1        | 30s      | 30s      | 30s      | 30s
backup          | PASS    | 1        | 2m51s    | 2m51s    | 2m51s    | 2m51s
hscale          | PASS    | 1        | 1m40s    | 1m40s    | 1m40s    | 1m40s
vscale          | PASS    | 1        | 3m31s    | 3m31s    | 3m31s    | 3m31s
promote         | SKIP    | 0        | -        | -        | -        | -
upgrade         | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: cluster | Version: 7.2.4 | Operations: 4/10 (40.0%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/ops_test.go:33 [38;5;243m@ 03/03/25 20:06:31.27[0m
=== Test Failed ===
Engine: redis
Mode: cluster
Version: 7.2.4
Cluster: e2e-zqq0tsmd
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [633.499 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/cluster/7.2.4[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] task e2e-z-668d89d8d9-switchover-lvqkw failed, cluster status: Running[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/ops_test.go:33[0m [38;5;243m@ 03/03/25 20:06:31.27[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/cluster/7.2.7[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 20:06:31.27[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 20:06:31.27[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 20:06:31.27[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 20:06:31.27[0m
[1mSTEP:[0m set mode cluster [38;5;243m@ 03/03/25 20:06:31.27[0m
[1mSTEP:[0m set version 7.2.7 [38;5;243m@ 03/03/25 20:06:31.27[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 20:06:31.27[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 20:06:31.27[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 20:06:31.287[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 20:06:31.287[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 20:06:31.287[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 20:06:31.29[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 20:06:31.29[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 20:06:31.29[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:06:31.524[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 20:06:31.524[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 20:06:31.524[0m
[1mSTEP:[0m verify component redis-cluster [38;5;243m@ 03/03/25 20:06:31.524[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 20:06:31.524[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 20:06:31.524[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 20:06:31.524[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.cluster.redis-cluster-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis-cluster","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T20:06:31.521Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-t-7457cb4c87","id":"432522654050683450","mode":"cluster","name":"e2e-tsdxiywz","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T20:06:31.521Z","version":"7.2.7"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 20:06:31.524[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:06:31.524[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:07:01.594330    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:07:41.758[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 20:07:41.775[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 20:07:41.775[0m
[1mSTEP:[0m verify component redis-cluster [38;5;243m@ 03/03/25 20:07:41.775[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 20:07:41.776[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 20:07:41.776[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 20:07:41.776[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 20:07:41.776[0m
Engine: redis
Mode: cluster
Version: 7.2.7
Components:
- redis-cluster:
Replicas: 2-3 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-cluster:
âœ“ dashboard
âœ“ hscale
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-sentinel:
âœ“ dashboard
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
Supported Components: [redis-cluster]
- vscale: Scale cluster components vertically
Supported Components: [redis-cluster]
- volume-expansion: Expand cluster volumes
Supported Components: [redis-cluster]
- promote: Promote cluster components
Supported Components: [redis-cluster]
- upgrade: Upgrade cluster
Supported Components: [redis-cluster]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis-cluster]
- restart: Restart cluster components
Supported Components: [redis-cluster]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. hscale: Scale cluster components horizontally
Supported Components: [redis-cluster]
3. vscale: Scale cluster components vertically
Supported Components: [redis-cluster]
4. volume-expansion: Expand cluster volumes
Supported Components: [redis-cluster]
5. promote: Promote cluster components
Supported Components: [redis-cluster]
6. upgrade: Upgrade cluster
Supported Components: [redis-cluster]
7. account: Account operations
8. stop-start: Stop and start cluster
Supported Components: [redis-cluster]
9. restart: Restart cluster components
Supported Components: [redis-cluster]
10. alert: Alert operations
[1mSTEP:[0m [1/10] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 20:07:41.776[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 20:07:41.776[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 20:07:41.778[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 20:07:41.778[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-t-7457cb4c87-datafile-20250303200740 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-t-7457cb4c87-datafile-20250303200740 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-t-7457cb4c87-datafile-20250303200740 completed
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 20:08:01.786[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 20:08:01.786[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 20:08:01.851[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupqvi1a5tn in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupqvi1a5tn completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 20:08:11.864[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 20:08:11.868[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.cluster.redis-cluster-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis-cluster","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-6h71em78","engine":"redis","environmentName":"cloud-dev","mode":"cluster","name":"restore-e2e-6h71em78","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"7.2.7"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 20:08:12.047[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:08:12.047[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:10:12.311883    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6h71em78 status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:10:42.395[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-6h71em78 [38;5;243m@ 03/03/25 20:10:42.411[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 20:10:42.527[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 20:10:42.529[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 3m0.776098264s
[1mSTEP:[0m [2/10] Executing operation: hscale - Scale cluster components horizontally [38;5;243m@ 03/03/25 20:10:42.552[0m
[1mSTEP:[0m scale cluster horizontally [38;5;243m@ 03/03/25 20:10:42.552[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 20:10:42.552[0m
[1mSTEP:[0m current replicas: 2 [38;5;243m@ 03/03/25 20:10:42.552[0m
[1mSTEP:[0m scale redis-cluster from 2 to 3 [38;5;243m@ 03/03/25 20:10:42.552[0m
[1mSTEP:[0m changing component redis-cluster replicas to 3 [38;5;243m@ 03/03/25 20:10:42.552[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432523075259468346 to be Succeed [38;5;243m@ 03/03/25 20:10:42.584[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-horizontalscaling-wpgb8 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-horizontalscaling-wpgb8 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-horizontalscaling-wpgb8 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-horizontalscaling-wpgb8 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-horizontalscaling-wpgb8 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-horizontalscaling-wpgb8 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-horizontalscaling-wpgb8 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-horizontalscaling-wpgb8 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:11:52.767[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale down to original replicas [38;5;243m@ 03/03/25 20:11:52.795[0m
[1mSTEP:[0m changing component redis-cluster replicas to 2 [38;5;243m@ 03/03/25 20:11:52.795[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432523193102633530 to be Succeed [38;5;243m@ 03/03/25 20:11:52.83[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-horizontalscaling-smdlp status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-horizontalscaling-smdlp status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-horizontalscaling-smdlp status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-horizontalscaling-smdlp status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:12:22.927[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation hscale completed in 1m40.4049762s
[1mSTEP:[0m [3/10] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 20:12:22.957[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 20:12:22.957[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 20:12:22.957[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.cluster.redis-cluster-7.2c1g.general [38;5;243m@ 03/03/25 20:12:22.979[0m
[1mSTEP:[0m choose larger class: redis.cluster.redis-cluster-7.2c2g.general [38;5;243m@ 03/03/25 20:12:22.979[0m
[1mSTEP:[0m changing component redis-cluster class to redis.cluster.redis-cluster-7.2c2g.general [38;5;243m@ 03/03/25 20:12:22.979[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432523243753048634 to be Succeed [38;5;243m@ 03/03/25 20:12:23.011[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-9r8gh status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-9r8gh status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-9r8gh status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-9r8gh status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-9r8gh status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-9r8gh status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:13:23.146045    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-9r8gh status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-9r8gh status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-9r8gh status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-9r8gh status: Succeed, cluster status: Updating
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:14:03.279[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 20:14:13.318[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 20:14:13.334[0m
[1mSTEP:[0m changing component redis-cluster class to redis.cluster.redis-cluster-7.2c1g.general [38;5;243m@ 03/03/25 20:14:13.334[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432523428889627194 to be Succeed [38;5;243m@ 03/03/25 20:14:13.364[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-jddmh status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-jddmh status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-jddmh status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-jddmh status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-jddmh status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-jddmh status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-jddmh status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-jddmh status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-jddmh status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-jddmh status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-verticalscaling-jddmh status: Succeed, cluster status: Updating
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:15:53.635[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 20:16:03.676[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 3m40.733497217s
[1mSTEP:[0m [4/10] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 20:16:03.691[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 20:16:03.691[0m
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 20:16:03.691[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 20:16:03.691[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432523614059760186 to be Succeed [38;5;243m@ 03/03/25 20:16:03.732[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-volumeexpansion-q88pg status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-volumeexpansion-q88pg status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-volumeexpansion-q88pg status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:16:33.807845    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-volumeexpansion-q88pg status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:16:43.907[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 40.244892828s
[1mSTEP:[0m [5/10] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 20:16:43.936[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 20:16:43.936[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:16:43.936[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-tsdxiywz status: Running
[1mSTEP:[0m choose component: redis-cluster [38;5;243m@ 03/03/25 20:16:43.951[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-t-7457cb4c87-shard-nnq-1 with role secondary [38;5;243m@ 03/03/25 20:16:44.225[0m
[1mSTEP:[0m promoting instance e2e-t-7457cb4c87-shard-nnq-1 of component redis-cluster from secondary to primary [38;5;243m@ 03/03/25 20:16:44.225[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432523682074593850 to be Succeed [38;5;243m@ 03/03/25 20:16:44.277[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-switchover-z9rch status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-switchover-z9rch status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-switchover-z9rch status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-switchover-z9rch status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-switchover-z9rch status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-t-7457cb4c87-switchover-z9rch status: Failed, cluster status: Running
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
vscale          | PASS    | 1        | 3m41s    | 3m41s    | 3m41s    | 3m41s
volume-expansion | PASS    | 1        | 40s      | 40s      | 40s      | 40s
backup          | PASS    | 1        | 3m1s     | 3m1s     | 3m1s     | 3m1s
hscale          | PASS    | 1        | 1m40s    | 1m40s    | 1m40s    | 1m40s
promote         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
upgrade         | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: cluster | Version: 7.2.7 | Operations: 4/10 (40.0%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/ops_test.go:33 [38;5;243m@ 03/03/25 20:17:34.406[0m
=== Test Failed ===
Engine: redis
Mode: cluster
Version: 7.2.7
Cluster: e2e-tsdxiywz
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [663.136 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/cluster/7.2.7[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] task e2e-t-7457cb4c87-switchover-z9rch failed, cluster status: Running[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/ops_test.go:33[0m [38;5;243m@ 03/03/25 20:17:34.406[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/replication/6.2.17[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 20:17:34.406[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 20:17:34.406[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 20:17:34.406[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 20:17:34.406[0m
[1mSTEP:[0m set mode replication [38;5;243m@ 03/03/25 20:17:34.407[0m
[1mSTEP:[0m set version 6.2.17 [38;5;243m@ 03/03/25 20:17:34.407[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 20:17:34.407[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 20:17:34.407[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 20:17:34.423[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 20:17:34.423[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 20:17:34.424[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 20:17:34.426[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 20:17:34.426[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 20:17:34.426[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:17:34.608[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 20:17:34.608[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 20:17:34.608[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 20:17:34.608[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 20:17:34.608[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 20:17:34.608[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 20:17:34.608[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.replication.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T20:17:34.606Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-g-5657dd976c","id":"432523766514321978","mode":"replication","name":"e2e-g2sgb5lx","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T20:17:34.606Z","version":"6.2.17"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 20:17:34.608[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:17:34.608[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-g2sgb5lx status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-g2sgb5lx status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-g2sgb5lx status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-g2sgb5lx status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-g2sgb5lx status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-g2sgb5lx status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-g2sgb5lx status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-g2sgb5lx status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-g2sgb5lx status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:18:54.806[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 20:18:54.821[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 20:18:54.821[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 20:18:54.821[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 20:18:54.821[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 20:18:54.821[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 20:18:54.821[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 20:18:54.821[0m
Engine: redis
Mode: replication
Version: 6.2.17
Components:
- redis:
Replicas: 2-2 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ— hscale: replicas range is 2-2
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-cluster:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-sentinel:
âœ“ dashboard
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
- vscale: Scale cluster components vertically
Supported Components: [redis]
- volume-expansion: Expand cluster volumes
Supported Components: [redis]
- promote: Promote cluster components
Supported Components: [redis]
- upgrade: Upgrade cluster
Supported Components: [redis]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis]
- restart: Restart cluster components
Supported Components: [redis]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. vscale: Scale cluster components vertically
Supported Components: [redis]
3. volume-expansion: Expand cluster volumes
Supported Components: [redis]
4. promote: Promote cluster components
Supported Components: [redis]
5. upgrade: Upgrade cluster
Supported Components: [redis]
6. account: Account operations
7. stop-start: Stop and start cluster
Supported Components: [redis]
8. restart: Restart cluster components
Supported Components: [redis]
9. alert: Alert operations
[1mSTEP:[0m [1/9] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 20:18:54.821[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 20:18:54.821[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 20:18:54.824[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 20:18:54.824[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-g-5657dd976c-datafile-20250303201853 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-g-5657dd976c-datafile-20250303201853 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-g-5657dd976c-datafile-20250303201853 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 20:19:14.84[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup 8b176e84-e2e-g-5657dd976c-redi-aof is running
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 20:19:14.842[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 20:19:14.842[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 20:19:14.908[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupvgvmy3bi in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupvgvmy3bi completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 20:19:24.922[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 20:19:24.926[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.replication.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-lsdvr2b3","engine":"redis","environmentName":"cloud-dev","mode":"replication","name":"restore-e2e-lsdvr2b3","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"6.2.17"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 20:19:25.119[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:19:25.119[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lsdvr2b3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lsdvr2b3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:19:45.159581    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lsdvr2b3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lsdvr2b3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lsdvr2b3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lsdvr2b3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lsdvr2b3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lsdvr2b3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lsdvr2b3 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lsdvr2b3 status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:21:05.414[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-lsdvr2b3 [38;5;243m@ 03/03/25 20:21:05.429[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 20:21:05.563[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 20:21:05.565[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 2m10.766310668s
[1mSTEP:[0m [2/9] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 20:21:05.588[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 20:21:05.588[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 20:21:05.588[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.replication.redis-7.2c1g.general [38;5;243m@ 03/03/25 20:21:05.604[0m
[1mSTEP:[0m choose larger class: redis.replication.redis-7.2c2g.general [38;5;243m@ 03/03/25 20:21:05.604[0m
[1mSTEP:[0m changing component redis class to redis.replication.redis-7.2c2g.general [38;5;243m@ 03/03/25 20:21:05.604[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432524120563911226 to be Succeed [38;5;243m@ 03/03/25 20:21:05.632[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-bkjdj status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-bkjdj status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-bkjdj status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-bkjdj status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-bkjdj status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-bkjdj status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-bkjdj status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-bkjdj status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-bkjdj status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-bkjdj status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-bkjdj status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:22:45.892[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-g2sgb5lx status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 20:22:45.911[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 20:22:45.926[0m
[1mSTEP:[0m changing component redis class to redis.replication.redis-7.2c1g.general [38;5;243m@ 03/03/25 20:22:45.926[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432524288872942138 to be Succeed [38;5;243m@ 03/03/25 20:22:45.959[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-4rx7j status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:22:55.986306    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-4rx7j status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-4rx7j status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-4rx7j status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-4rx7j status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-4rx7j status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-4rx7j status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-4rx7j status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-verticalscaling-4rx7j status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:24:16.276[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-g2sgb5lx status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 20:24:16.292[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 3m10.720075951s
[1mSTEP:[0m [3/9] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 20:24:16.308[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 20:24:16.308[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 20:24:16.308[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 20:24:16.308[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432524440522197562 to be Succeed [38;5;243m@ 03/03/25 20:24:16.35[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-volumeexpansion-p9p6n status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-volumeexpansion-p9p6n status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-volumeexpansion-p9p6n status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-volumeexpansion-p9p6n status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-volumeexpansion-p9p6n status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:24:56.461[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-g2sgb5lx status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 40.183617769s
[1mSTEP:[0m [4/9] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 20:24:56.491[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 20:24:56.491[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:24:56.492[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-g2sgb5lx status: Running
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 20:24:56.506[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-g-5657dd976c-redis-1 with role secondary [38;5;243m@ 03/03/25 20:24:56.78[0m
[1mSTEP:[0m promoting instance e2e-g-5657dd976c-redis-1 of component redis from secondary to primary [38;5;243m@ 03/03/25 20:24:56.781[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432524508537031226 to be Succeed [38;5;243m@ 03/03/25 20:24:56.885[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:26:07.056938    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-g-5657dd976c-switchover-ln44c status: Failed, cluster status: Running
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
volume-expansion | PASS    | 1        | 40s      | 40s      | 40s      | 40s
backup          | PASS    | 1        | 2m11s    | 2m11s    | 2m11s    | 2m11s
vscale          | PASS    | 1        | 3m11s    | 3m11s    | 3m11s    | 3m11s
promote         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
upgrade         | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: replication | Version: 6.2.17 | Operations: 3/9 (33.3%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/ops_test.go:33 [38;5;243m@ 03/03/25 20:27:17.319[0m
=== Test Failed ===
Engine: redis
Mode: replication
Version: 6.2.17
Cluster: e2e-g2sgb5lx
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [582.913 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/replication/6.2.17[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] task e2e-g-5657dd976c-switchover-ln44c failed, cluster status: Running[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/ops_test.go:33[0m [38;5;243m@ 03/03/25 20:27:17.319[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/replication/7.0.6[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 20:27:17.319[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 20:27:17.319[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 20:27:17.319[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 20:27:17.319[0m
[1mSTEP:[0m set mode replication [38;5;243m@ 03/03/25 20:27:17.319[0m
[1mSTEP:[0m set version 7.0.6 [38;5;243m@ 03/03/25 20:27:17.319[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 20:27:17.319[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 20:27:17.319[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 20:27:17.336[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 20:27:17.336[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 20:27:17.336[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 20:27:17.339[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 20:27:17.339[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 20:27:17.339[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:27:17.535[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 20:27:17.535[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 20:27:17.535[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 20:27:17.535[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 20:27:17.535[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 20:27:17.535[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 20:27:17.535[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.replication.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T20:27:17.532Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-s-5ffb6df59b","id":"432524744508574266","mode":"replication","name":"e2e-srufzpdi","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T20:27:17.532Z","version":"7.0.6"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 20:27:17.535[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:27:17.535[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:28:47.748[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 20:28:47.763[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 20:28:47.763[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 20:28:47.763[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 20:28:47.763[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 20:28:47.763[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 20:28:47.763[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 20:28:47.763[0m
Engine: redis
Mode: replication
Version: 7.0.6
Components:
- redis:
Replicas: 2-2 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ— hscale: replicas range is 2-2
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-cluster:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-sentinel:
âœ“ dashboard
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
- vscale: Scale cluster components vertically
Supported Components: [redis]
- volume-expansion: Expand cluster volumes
Supported Components: [redis]
- promote: Promote cluster components
Supported Components: [redis]
- upgrade: Upgrade cluster
Supported Components: [redis]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis]
- restart: Restart cluster components
Supported Components: [redis]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. vscale: Scale cluster components vertically
Supported Components: [redis]
3. volume-expansion: Expand cluster volumes
Supported Components: [redis]
4. promote: Promote cluster components
Supported Components: [redis]
5. upgrade: Upgrade cluster
Supported Components: [redis]
6. account: Account operations
7. stop-start: Stop and start cluster
Supported Components: [redis]
8. restart: Restart cluster components
Supported Components: [redis]
9. alert: Alert operations
[1mSTEP:[0m [1/9] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 20:28:47.763[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 20:28:47.763[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 20:28:47.766[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 20:28:47.766[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-s-5ffb6df59b-datafile-20250303202843 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-s-5ffb6df59b-datafile-20250303202843 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 20:28:57.773[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup 55fde80c-e2e-s-5ffb6df59b-redi-aof is running
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 20:28:57.775[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 20:28:57.775[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 20:28:57.849[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup83jwp5gj in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup83jwp5gj completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 20:29:07.859[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 20:29:07.863[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.replication.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-f0pqefjm","engine":"redis","environmentName":"cloud-dev","mode":"replication","name":"restore-e2e-f0pqefjm","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"7.0.6"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 20:29:08.059[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:29:08.059[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-f0pqefjm status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:29:18.076927    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-f0pqefjm status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-f0pqefjm status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-f0pqefjm status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-f0pqefjm status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-f0pqefjm status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-f0pqefjm status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-f0pqefjm status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-f0pqefjm status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-f0pqefjm status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-f0pqefjm status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:30:58.345[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-f0pqefjm [38;5;243m@ 03/03/25 20:30:58.362[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 20:30:58.501[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 20:30:58.504[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 2m10.763774676s
[1mSTEP:[0m [2/9] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 20:30:58.527[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 20:30:58.527[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 20:30:58.527[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.replication.redis-7.2c1g.general [38;5;243m@ 03/03/25 20:30:58.543[0m
[1mSTEP:[0m choose larger class: redis.replication.redis-7.2c2g.general [38;5;243m@ 03/03/25 20:30:58.543[0m
[1mSTEP:[0m changing component redis class to redis.replication.redis-7.2c2g.general [38;5;243m@ 03/03/25 20:30:58.543[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432525115352156730 to be Succeed [38;5;243m@ 03/03/25 20:30:58.573[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-2wgzz status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-2wgzz status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-2wgzz status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-2wgzz status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-2wgzz status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-2wgzz status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-2wgzz status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-2wgzz status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-2wgzz status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:32:28.816920    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-2wgzz status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-2wgzz status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-2wgzz status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:32:58.969[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 20:32:58.983[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 20:32:58.997[0m
[1mSTEP:[0m changing component redis class to redis.replication.redis-7.2c1g.general [38;5;243m@ 03/03/25 20:32:58.997[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432525317433723450 to be Succeed [38;5;243m@ 03/03/25 20:32:59.026[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-j85lz status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-j85lz status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-j85lz status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-j85lz status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-j85lz status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-j85lz status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-j85lz status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-j85lz status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-j85lz status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-verticalscaling-j85lz status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:34:29.261[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 20:34:29.278[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 3m30.765586434s
[1mSTEP:[0m [3/9] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 20:34:29.293[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 20:34:29.293[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 20:34:29.293[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 20:34:29.293[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432525468948761146 to be Succeed [38;5;243m@ 03/03/25 20:34:29.337[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-volumeexpansion-5sb74 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-volumeexpansion-5sb74 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-volumeexpansion-5sb74 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-volumeexpansion-5sb74 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-volumeexpansion-5sb74 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:35:09.462[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 40.199178216s
[1mSTEP:[0m [4/9] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 20:35:09.492[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 20:35:09.492[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:35:09.492[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Running
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 20:35:09.508[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-s-5ffb6df59b-redis-1 with role secondary [38;5;243m@ 03/03/25 20:35:09.79[0m
[1mSTEP:[0m promoting instance e2e-s-5ffb6df59b-redis-1 of component redis from secondary to primary [38;5;243m@ 03/03/25 20:35:09.79[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432525536997149242 to be Succeed [38;5;243m@ 03/03/25 20:35:09.894[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-switchover-lj5sn status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-switchover-lj5sn status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-switchover-lj5sn status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:35:39.976272    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-switchover-lj5sn status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:35:50.016[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Running
[1mSTEP:[0m verify the instance role is updated [38;5;243m@ 03/03/25 20:35:50.031[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m second promotion: promote another instance e2e-s-5ffb6df59b-redis-0 with role secondary [38;5;243m@ 03/03/25 20:35:50.455[0m
[1mSTEP:[0m promoting instance e2e-s-5ffb6df59b-redis-0 of component redis from secondary to primary [38;5;243m@ 03/03/25 20:35:50.455[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432525605213309498 to be Succeed [38;5;243m@ 03/03/25 20:35:50.56[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-switchover-jlcjc status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-switchover-jlcjc status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-switchover-jlcjc status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-switchover-jlcjc status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-switchover-jlcjc status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:36:30.756[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Running
[1mSTEP:[0m verify the instance role is updated [38;5;243m@ 03/03/25 20:36:31.048[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
Operation promote completed in 1m21.788676617s
[1mSTEP:[0m [5/9] Executing operation: upgrade - Upgrade cluster [38;5;243m@ 03/03/25 20:36:31.281[0m
[1mSTEP:[0m upgrade cluster [38;5;243m@ 03/03/25 20:36:31.281[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/upgradeableServiceVersion engineOption.ListUpgradeableServiceVersion
no upgradeable version available for component redis, trying next
no component supports upgrade
Operation upgrade completed in 25.094042ms
[1mSTEP:[0m [6/9] Executing operation: account - Account operations [38;5;243m@ 03/03/25 20:36:31.306[0m
[1mSTEP:[0m list redis account [38;5;243m@ 03/03/25 20:36:31.306[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/root-password account.getRootAccountPassword
[1mSTEP:[0m create redis account [38;5;243m@ 03/03/25 20:36:31.69[0m
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[1mSTEP:[0m list redis account after creation [38;5;243m@ 03/03/25 20:36:32.895[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[1mSTEP:[0m update redis account [38;5;243m@ 03/03/25 20:36:49.441[0m
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[1mSTEP:[0m list redis account after update [38;5;243m@ 03/03/25 20:36:50.556[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[1mSTEP:[0m delete redis account [38;5;243m@ 03/03/25 20:37:07.075[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[1mSTEP:[0m list redis account after deletion [38;5;243m@ 03/03/25 20:37:08.489[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
Operation account completed in 53.692011182s
[1mSTEP:[0m [7/9] Executing operation: stop-start - Stop and start cluster [38;5;243m@ 03/03/25 20:37:24.998[0m
[1mSTEP:[0m stop cluster [38;5;243m@ 03/03/25 20:37:24.998[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/stop opsrequest.stopCluster
[1mSTEP:[0m wait task 432525763707669050 to be Succeed [38;5;243m@ 03/03/25 20:37:25.025[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-stop-pxb8q status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-stop-pxb8q status: Pending, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-stop-pxb8q status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-stop-pxb8q status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-stop-pxb8q status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-stop-pxb8q status: Running, cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-stop-pxb8q status: Succeed, cluster status: Stopped
[1mSTEP:[0m waiting for cluster to reach status: Stopped [38;5;243m@ 03/03/25 20:38:25.181[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-srufzpdi status: Stopped
[1mSTEP:[0m start cluster [38;5;243m@ 03/03/25 20:38:25.196[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/start opsrequest.startCluster
[1mSTEP:[0m wait task 432525864740063802 to be Succeed [38;5;243m@ 03/03/25 20:38:25.241[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: , cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Creating, cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:38:55.316472    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:42:05.844315    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:45:16.344279    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-5ffb6df59b-start-2prs4 status: Running, cluster status: Updating
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
backup          | PASS    | 1        | 2m11s    | 2m11s    | 2m11s    | 2m11s
vscale          | PASS    | 1        | 3m31s    | 3m31s    | 3m31s    | 3m31s
volume-expansion | PASS    | 1        | 40s      | 40s      | 40s      | 40s
promote         | PASS    | 1        | 1m22s    | 1m22s    | 1m22s    | 1m22s
upgrade         | PASS    | 1        | 0s       | 0s       | 0s       | 0s
account         | PASS    | 1        | 54s      | 54s      | 54s      | 54s
alert           | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: replication | Version: 7.0.6 | Operations: 6/9 (66.7%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/ops_test.go:36 [38;5;243m@ 03/03/25 20:48:25.249[0m
=== Test Failed ===
Engine: redis
Mode: replication
Version: 7.0.6
Cluster: e2e-srufzpdi
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [1267.930 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/replication/7.0.6[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] Timed out after 600.007s.
Expected
<constants.ClusterTaskStatus>: Running
to equal
<constants.ClusterTaskStatus>: Succeed[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/ops_test.go:36[0m [38;5;243m@ 03/03/25 20:48:25.249[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/replication/7.2.4[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 20:48:25.249[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 20:48:25.249[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 20:48:25.249[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 20:48:25.249[0m
[1mSTEP:[0m set mode replication [38;5;243m@ 03/03/25 20:48:25.249[0m
[1mSTEP:[0m set version 7.2.4 [38;5;243m@ 03/03/25 20:48:25.249[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 20:48:25.249[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 20:48:25.249[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 20:48:25.266[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 20:48:25.266[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 20:48:25.266[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 20:48:25.268[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 20:48:25.268[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 20:48:25.268[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:48:25.445[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 20:48:25.445[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 20:48:25.445[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 20:48:25.445[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 20:48:25.445[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 20:48:25.445[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 20:48:25.445[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.replication.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T20:48:25.443Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-j-7849994879","id":"432526871708568122","mode":"replication","name":"e2e-jedcgwp0","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T20:48:25.443Z","version":"7.2.4"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 20:48:25.446[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:48:25.446[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-jedcgwp0 status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:48:35.470738    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-jedcgwp0 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-jedcgwp0 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-jedcgwp0 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-jedcgwp0 status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-jedcgwp0 status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-jedcgwp0 status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-jedcgwp0 status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:49:45.685[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 20:49:45.699[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 20:49:45.699[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 20:49:45.699[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 20:49:45.699[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 20:49:45.699[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 20:49:45.699[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 20:49:45.699[0m
Engine: redis
Mode: replication
Version: 7.2.4
Components:
- redis:
Replicas: 2-2 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ— hscale: replicas range is 2-2
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-cluster:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-sentinel:
âœ“ dashboard
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
- vscale: Scale cluster components vertically
Supported Components: [redis]
- volume-expansion: Expand cluster volumes
Supported Components: [redis]
- promote: Promote cluster components
Supported Components: [redis]
- upgrade: Upgrade cluster
Supported Components: [redis]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis]
- restart: Restart cluster components
Supported Components: [redis]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. vscale: Scale cluster components vertically
Supported Components: [redis]
3. volume-expansion: Expand cluster volumes
Supported Components: [redis]
4. promote: Promote cluster components
Supported Components: [redis]
5. upgrade: Upgrade cluster
Supported Components: [redis]
6. account: Account operations
7. stop-start: Stop and start cluster
Supported Components: [redis]
8. restart: Restart cluster components
Supported Components: [redis]
9. alert: Alert operations
[1mSTEP:[0m [1/9] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 20:49:45.7[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 20:49:45.7[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 20:49:45.702[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 20:49:45.702[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-j-7849994879-datafile-20250303204944 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-j-7849994879-datafile-20250303204944 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 20:49:55.707[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup 2595b45d-e2e-j-7849994879-redi-aof is running
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 20:49:55.709[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 20:49:55.709[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 20:49:55.775[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupaa9mnth6 in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupaa9mnth6 completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 20:50:05.788[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 20:50:05.792[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.replication.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-8rewrtp6","engine":"redis","environmentName":"cloud-dev","mode":"replication","name":"restore-e2e-8rewrtp6","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"7.2.4"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 20:50:05.985[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:50:05.985[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-8rewrtp6 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-8rewrtp6 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-8rewrtp6 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-8rewrtp6 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-8rewrtp6 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-8rewrtp6 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-8rewrtp6 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-8rewrtp6 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-8rewrtp6 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-8rewrtp6 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:51:46.199572    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-8rewrtp6 status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:51:56.257[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-8rewrtp6 [38;5;243m@ 03/03/25 20:51:56.273[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 20:51:56.41[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 20:51:56.413[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 2m10.741280186s
[1mSTEP:[0m [2/9] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 20:51:56.441[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 20:51:56.441[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 20:51:56.441[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.replication.redis-7.2c1g.general [38;5;243m@ 03/03/25 20:51:56.457[0m
[1mSTEP:[0m choose larger class: redis.replication.redis-7.2c2g.general [38;5;243m@ 03/03/25 20:51:56.457[0m
[1mSTEP:[0m changing component redis class to redis.replication.redis-7.2c2g.general [38;5;243m@ 03/03/25 20:51:56.457[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432527225774934586 to be Succeed [38;5;243m@ 03/03/25 20:51:56.488[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-p457z status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-p457z status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-p457z status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-p457z status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-p457z status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-p457z status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-p457z status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-p457z status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-p457z status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-p457z status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-p457z status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:53:36.765[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-jedcgwp0 status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 20:53:36.78[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 20:53:36.795[0m
[1mSTEP:[0m changing component redis class to redis.replication.redis-7.2c1g.general [38;5;243m@ 03/03/25 20:53:36.795[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432527394117519930 to be Succeed [38;5;243m@ 03/03/25 20:53:36.827[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-8s5d6 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-8s5d6 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-8s5d6 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-8s5d6 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-8s5d6 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-8s5d6 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-8s5d6 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-8s5d6 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:54:57.026255    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-8s5d6 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-verticalscaling-8s5d6 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:55:17.137[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-jedcgwp0 status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 20:55:17.152[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 3m20.726810488s
[1mSTEP:[0m [3/9] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 20:55:17.168[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 20:55:17.168[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 20:55:17.168[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 20:55:17.168[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432527562543991354 to be Succeed [38;5;243m@ 03/03/25 20:55:17.213[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-volumeexpansion-cf2sg status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-volumeexpansion-cf2sg status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-volumeexpansion-cf2sg status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-volumeexpansion-cf2sg status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-volumeexpansion-cf2sg status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:55:57.315[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-jedcgwp0 status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 40.178666019s
[1mSTEP:[0m [4/9] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 20:55:57.347[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 20:55:57.347[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:55:57.347[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-jedcgwp0 status: Running
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 20:55:57.363[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-j-7849994879-redis-1 with role secondary [38;5;243m@ 03/03/25 20:55:57.765[0m
[1mSTEP:[0m promoting instance e2e-j-7849994879-redis-1 of component redis from secondary to primary [38;5;243m@ 03/03/25 20:55:57.765[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432527630743374394 to be Succeed [38;5;243m@ 03/03/25 20:55:57.865[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 20:58:08.195251    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-j-7849994879-switchover-92g8v status: Failed, cluster status: Running
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
volume-expansion | PASS    | 1        | 40s      | 40s      | 40s      | 40s
backup          | PASS    | 1        | 2m11s    | 2m11s    | 2m11s    | 2m11s
vscale          | PASS    | 1        | 3m21s    | 3m21s    | 3m21s    | 3m21s
upgrade         | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
promote         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: replication | Version: 7.2.4 | Operations: 3/9 (33.3%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/ops_test.go:33 [38;5;243m@ 03/03/25 20:58:18.321[0m
=== Test Failed ===
Engine: redis
Mode: replication
Version: 7.2.4
Cluster: e2e-jedcgwp0
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [593.072 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/replication/7.2.4[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] task e2e-j-7849994879-switchover-92g8v failed, cluster status: Running[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/ops_test.go:33[0m [38;5;243m@ 03/03/25 20:58:18.321[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/replication/7.2.7[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 20:58:18.322[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 20:58:18.322[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 20:58:18.322[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 20:58:18.322[0m
[1mSTEP:[0m set mode replication [38;5;243m@ 03/03/25 20:58:18.322[0m
[1mSTEP:[0m set version 7.2.7 [38;5;243m@ 03/03/25 20:58:18.322[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 20:58:18.322[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 20:58:18.322[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 20:58:18.338[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 20:58:18.338[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 20:58:18.338[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 20:58:18.34[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 20:58:18.34[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 20:58:18.34[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:58:18.517[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 20:58:18.517[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 20:58:18.517[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 20:58:18.517[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 20:58:18.517[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 20:58:18.517[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 20:58:18.517[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.replication.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T20:58:18.514Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-4-56b68bfdb","id":"432527866714917434","mode":"replication","name":"e2e-43s47ens","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T20:58:18.514Z","version":"7.2.7"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 20:58:18.517[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 20:58:18.517[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 20:59:48.748[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 20:59:48.764[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 20:59:48.764[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 20:59:48.764[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 20:59:48.764[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 20:59:48.764[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 20:59:48.764[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 20:59:48.764[0m
Engine: redis
Mode: replication
Version: 7.2.7
Components:
- redis:
Replicas: 2-2 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ— hscale: replicas range is 2-2
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-cluster:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-sentinel:
âœ“ dashboard
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
- vscale: Scale cluster components vertically
Supported Components: [redis]
- volume-expansion: Expand cluster volumes
Supported Components: [redis]
- promote: Promote cluster components
Supported Components: [redis]
- upgrade: Upgrade cluster
Supported Components: [redis]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis]
- restart: Restart cluster components
Supported Components: [redis]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. vscale: Scale cluster components vertically
Supported Components: [redis]
3. volume-expansion: Expand cluster volumes
Supported Components: [redis]
4. promote: Promote cluster components
Supported Components: [redis]
5. upgrade: Upgrade cluster
Supported Components: [redis]
6. account: Account operations
7. stop-start: Stop and start cluster
Supported Components: [redis]
8. restart: Restart cluster components
Supported Components: [redis]
9. alert: Alert operations
[1mSTEP:[0m [1/9] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 20:59:48.764[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 20:59:48.764[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 20:59:48.768[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 20:59:48.768[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-4-56b68bfdb-datafile-20250303205940 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-4-56b68bfdb-datafile-20250303205940 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 20:59:58.773[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup 235e1561-e2e-4-56b68bfdb-redis-aof is running
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 20:59:58.775[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 20:59:58.775[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 20:59:58.847[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupta8i82wy in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupta8i82wy completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 21:00:08.86[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 21:00:08.865[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.replication.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-6y8z760w","engine":"redis","environmentName":"cloud-dev","mode":"replication","name":"restore-e2e-6y8z760w","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"7.2.7"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 21:00:09.064[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:00:09.064[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6y8z760w status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6y8z760w status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6y8z760w status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6y8z760w status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6y8z760w status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6y8z760w status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6y8z760w status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:01:19.225082    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6y8z760w status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6y8z760w status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-6y8z760w status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 21:01:49.338[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-6y8z760w [38;5;243m@ 03/03/25 21:01:49.353[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 21:01:49.493[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 21:01:49.498[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 2m0.75943565s
[1mSTEP:[0m [2/9] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 21:01:49.524[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 21:01:49.524[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:01:49.524[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.replication.redis-7.2c1g.general [38;5;243m@ 03/03/25 21:01:49.54[0m
[1mSTEP:[0m choose larger class: redis.replication.redis-7.2c2g.general [38;5;243m@ 03/03/25 21:01:49.54[0m
[1mSTEP:[0m changing component redis class to redis.replication.redis-7.2c2g.general [38;5;243m@ 03/03/25 21:01:49.54[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432528220814835874 to be Succeed [38;5;243m@ 03/03/25 21:01:49.577[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-8jr49 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-8jr49 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-8jr49 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-8jr49 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-8jr49 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-8jr49 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-8jr49 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-8jr49 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-8jr49 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-8jr49 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-8jr49 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:03:29.856[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 21:03:29.872[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 21:03:29.886[0m
[1mSTEP:[0m changing component redis class to redis.replication.redis-7.2c1g.general [38;5;243m@ 03/03/25 21:03:29.886[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432528389157423674 to be Succeed [38;5;243m@ 03/03/25 21:03:29.916[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-gtphg status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-gtphg status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-gtphg status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-gtphg status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-gtphg status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-gtphg status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:04:30.081334    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-gtphg status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-gtphg status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-gtphg status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-verticalscaling-gtphg status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:05:10.201[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 21:05:10.219[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 3m20.711433091s
[1mSTEP:[0m [3/9] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 21:05:10.235[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 21:05:10.235[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:05:10.235[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 21:05:10.235[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432528557533563450 to be Succeed [38;5;243m@ 03/03/25 21:05:10.274[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-volumeexpansion-4lkwh status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-volumeexpansion-4lkwh status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-volumeexpansion-4lkwh status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-volumeexpansion-4lkwh status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-volumeexpansion-4lkwh status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:05:50.398[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 40.192013181s
[1mSTEP:[0m [4/9] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 21:05:50.427[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 21:05:50.427[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:05:50.427[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-43s47ens status: Running
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:05:50.441[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-4-56b68bfdb-redis-1 with role secondary [38;5;243m@ 03/03/25 21:05:50.738[0m
[1mSTEP:[0m promoting instance e2e-4-56b68bfdb-redis-1 of component redis from secondary to primary [38;5;243m@ 03/03/25 21:05:50.738[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432528625632283194 to be Succeed [38;5;243m@ 03/03/25 21:05:50.949[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:07:41.519266    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-4-56b68bfdb-switchover-gb6gf status: Failed, cluster status: Running
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
backup          | PASS    | 1        | 2m1s     | 2m1s     | 2m1s     | 2m1s
vscale          | PASS    | 1        | 3m21s    | 3m21s    | 3m21s    | 3m21s
volume-expansion | PASS    | 1        | 40s      | 40s      | 40s      | 40s
promote         | SKIP    | 0        | -        | -        | -        | -
upgrade         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: replication | Version: 7.2.7 | Operations: 3/9 (33.3%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/ops_test.go:33 [38;5;243m@ 03/03/25 21:08:11.647[0m
=== Test Failed ===
Engine: redis
Mode: replication
Version: 7.2.7
Cluster: e2e-43s47ens
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [593.325 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/replication/7.2.7[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] task e2e-4-56b68bfdb-switchover-gb6gf failed, cluster status: Running[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/ops_test.go:33[0m [38;5;243m@ 03/03/25 21:08:11.647[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/sentinel/6.2.17[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 21:08:11.647[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 21:08:11.647[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 21:08:11.647[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 21:08:11.647[0m
[1mSTEP:[0m set mode sentinel [38;5;243m@ 03/03/25 21:08:11.647[0m
[1mSTEP:[0m set version 6.2.17 [38;5;243m@ 03/03/25 21:08:11.647[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 21:08:11.647[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 21:08:11.647[0m
[API] GET /api/v1/classes class.listClasses
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 21:08:11.68[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 21:08:11.68[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 21:08:11.68[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 21:08:11.683[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 21:08:11.683[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 21:08:11.683[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 21:08:11.867[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 21:08:11.868[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 21:08:11.868[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 21:08:11.868[0m
[1mSTEP:[0m verify component redis-sentinel [38;5;243m@ 03/03/25 21:08:11.868[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 21:08:11.868[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 21:08:11.868[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 21:08:11.868[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.sentinel.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]},{"classCode":"redis.sentinel.redis-sentinel-7.0.5c0.5g.general","classSeries":"general","codeShort":"0.5c0.5g","component":"redis-sentinel","cpu":0.5,"memory":0.5,"replicas":3,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T21:08:11.865Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-a-784c9985dc","id":"432528862191028794","mode":"sentinel","name":"e2e-a5332yab","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T21:08:11.865Z","version":"6.2.17"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 21:08:11.868[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:08:11.868[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 21:09:42.084[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 21:09:42.099[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 21:09:42.099[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 21:09:42.099[0m
[1mSTEP:[0m verify component redis-sentinel [38;5;243m@ 03/03/25 21:09:42.099[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 21:09:42.099[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 21:09:42.099[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 21:09:42.099[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 21:09:42.099[0m
Engine: redis
Mode: sentinel
Version: 6.2.17
Components:
- redis:
Replicas: 1-10 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
- redis-sentinel:
Replicas: 1-3 (default: 3)
Storages:
- data: 20-20Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ“ hscale
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-cluster:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-sentinel:
âœ“ dashboard
âœ“ upgrade: confirm by upgradeable versions
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
Supported Components: [redis]
- vscale: Scale cluster components vertically
Supported Components: [redis]
- volume-expansion: Expand cluster volumes
Supported Components: [redis]
- promote: Promote cluster components
Supported Components: [redis]
- upgrade: Upgrade cluster
Supported Components: [redis-sentinel redis]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis]
- restart: Restart cluster components
Supported Components: [redis]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. hscale: Scale cluster components horizontally
Supported Components: [redis]
3. vscale: Scale cluster components vertically
Supported Components: [redis]
4. volume-expansion: Expand cluster volumes
Supported Components: [redis]
5. promote: Promote cluster components
Supported Components: [redis]
6. upgrade: Upgrade cluster
Supported Components: [redis redis-sentinel]
7. account: Account operations
8. stop-start: Stop and start cluster
Supported Components: [redis]
9. restart: Restart cluster components
Supported Components: [redis]
10. alert: Alert operations
[1mSTEP:[0m [1/10] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 21:09:42.099[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 21:09:42.099[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 21:09:42.103[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 21:09:42.103[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-a-784c9985dc-datafile-20250303210932 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-a-784c9985dc-datafile-20250303210932 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 21:09:52.11[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup 41bb044f-e2e-a-784c9985dc-redi-aof is running
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 21:09:52.112[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 21:09:52.112[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 21:09:52.178[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupfpti2tn9 in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupfpti2tn9 completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 21:10:02.186[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 21:10:02.191[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.sentinel.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]},{"classCode":"redis.sentinel.redis-sentinel-7.0.5c0.5g.general","classSeries":"general","codeShort":"0.5c0.5g","component":"redis-sentinel","cpu":0.5,"memory":0.5,"replicas":3,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-5wv2dpqq","engine":"redis","environmentName":"cloud-dev","mode":"sentinel","name":"restore-e2e-5wv2dpqq","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"6.2.17"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 21:10:02.389[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:10:02.389[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-5wv2dpqq status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-5wv2dpqq status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-5wv2dpqq status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-5wv2dpqq status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-5wv2dpqq status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:10:52.499089    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-5wv2dpqq status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-5wv2dpqq status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-5wv2dpqq status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-5wv2dpqq status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-5wv2dpqq status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-5wv2dpqq status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 21:11:52.643[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-5wv2dpqq [38;5;243m@ 03/03/25 21:11:52.659[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 21:11:52.815[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 21:11:52.818[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 2m10.754681642s
[1mSTEP:[0m [2/10] Executing operation: hscale - Scale cluster components horizontally [38;5;243m@ 03/03/25 21:11:52.854[0m
[1mSTEP:[0m scale cluster horizontally [38;5;243m@ 03/03/25 21:11:52.854[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:11:52.854[0m
[1mSTEP:[0m current replicas: 2 [38;5;243m@ 03/03/25 21:11:52.854[0m
[1mSTEP:[0m scale redis from 2 to 3 [38;5;243m@ 03/03/25 21:11:52.854[0m
[1mSTEP:[0m changing component redis replicas to 3 [38;5;243m@ 03/03/25 21:11:52.854[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432529233001056826 to be Succeed [38;5;243m@ 03/03/25 21:11:52.884[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-horizontalscaling-kpn49 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-horizontalscaling-kpn49 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-horizontalscaling-kpn49 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-horizontalscaling-kpn49 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-horizontalscaling-kpn49 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-horizontalscaling-kpn49 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-horizontalscaling-kpn49 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-horizontalscaling-kpn49 status: Succeed, cluster status: Updating
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:13:03.088[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale down to original replicas [38;5;243m@ 03/03/25 21:13:13.136[0m
[1mSTEP:[0m changing component redis replicas to 2 [38;5;243m@ 03/03/25 21:13:13.136[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432529367688546874 to be Succeed [38;5;243m@ 03/03/25 21:13:13.162[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-horizontalscaling-lx5h9 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-horizontalscaling-lx5h9 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-horizontalscaling-lx5h9 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-horizontalscaling-lx5h9 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-horizontalscaling-lx5h9 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:13:53.277[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation hscale completed in 2m0.453350705s
[1mSTEP:[0m [3/10] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 21:13:53.307[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 21:13:53.308[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:13:53.308[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.sentinel.redis-7.2c1g.general [38;5;243m@ 03/03/25 21:13:53.324[0m
[1mSTEP:[0m choose larger class: redis.sentinel.redis-7.2c2g.general [38;5;243m@ 03/03/25 21:13:53.324[0m
[1mSTEP:[0m changing component redis class to redis.sentinel.redis-7.2c2g.general [38;5;243m@ 03/03/25 21:13:53.324[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432529435116177978 to be Succeed [38;5;243m@ 03/03/25 21:13:53.351[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-fmgv8 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:14:03.379412    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-fmgv8 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-fmgv8 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-fmgv8 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-fmgv8 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-fmgv8 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-fmgv8 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-fmgv8 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-fmgv8 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-fmgv8 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:15:33.645[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 21:15:33.66[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 21:15:33.675[0m
[1mSTEP:[0m changing component redis class to redis.sentinel.redis-7.2c1g.general [38;5;243m@ 03/03/25 21:15:33.676[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432529603475540538 to be Succeed [38;5;243m@ 03/03/25 21:15:33.706[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-ww4v2 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-ww4v2 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-ww4v2 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-ww4v2 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-ww4v2 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-ww4v2 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-ww4v2 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-ww4v2 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-ww4v2 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-verticalscaling-ww4v2 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:17:03.955[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 21:17:03.97[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 3m10.678527936s
[1mSTEP:[0m [4/10] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 21:17:03.986[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 21:17:03.986[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:17:03.986[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 21:17:03.986[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432529755024132666 to be Succeed [38;5;243m@ 03/03/25 21:17:04.031[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-volumeexpansion-7brms status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:17:14.060095    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-volumeexpansion-7brms status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-volumeexpansion-7brms status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:17:34.183[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 30.226878085s
[1mSTEP:[0m [5/10] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 21:17:34.213[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 21:17:34.213[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:17:34.213[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Running
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:17:34.228[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-a-784c9985dc-redis-1 with role secondary [38;5;243m@ 03/03/25 21:17:34.52[0m
[1mSTEP:[0m promoting instance e2e-a-784c9985dc-redis-1 of component redis from secondary to primary [38;5;243m@ 03/03/25 21:17:34.52[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432529806345636410 to be Succeed [38;5;243m@ 03/03/25 21:17:34.622[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-switchover-xrtmt status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-switchover-xrtmt status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-switchover-xrtmt status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-switchover-xrtmt status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:18:04.703[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Running
[1mSTEP:[0m verify the instance role is updated [38;5;243m@ 03/03/25 21:18:04.718[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m second promotion: promote another instance e2e-a-784c9985dc-redis-0 with role secondary [38;5;243m@ 03/03/25 21:18:05.216[0m
[1mSTEP:[0m promoting instance e2e-a-784c9985dc-redis-0 of component redis from secondary to primary [38;5;243m@ 03/03/25 21:18:05.216[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432529857834912314 to be Succeed [38;5;243m@ 03/03/25 21:18:05.319[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-switchover-vc7mj status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-switchover-vc7mj status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-switchover-vc7mj status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-switchover-vc7mj status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-switchover-vc7mj status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:18:45.452[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Running
[1mSTEP:[0m verify the instance role is updated [38;5;243m@ 03/03/25 21:18:45.468[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
Operation promote completed in 1m11.407489951s
[1mSTEP:[0m [6/10] Executing operation: upgrade - Upgrade cluster [38;5;243m@ 03/03/25 21:18:45.621[0m
[1mSTEP:[0m upgrade cluster [38;5;243m@ 03/03/25 21:18:45.621[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/upgradeableServiceVersion engineOption.ListUpgradeableServiceVersion
no upgradeable version available for component redis, trying next
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/upgradeableServiceVersion engineOption.ListUpgradeableServiceVersion
no upgradeable version available for component redis-sentinel, trying next
no component supports upgrade
Operation upgrade completed in 52.734593ms
[1mSTEP:[0m [7/10] Executing operation: account - Account operations [38;5;243m@ 03/03/25 21:18:45.673[0m
[1mSTEP:[0m list redis account [38;5;243m@ 03/03/25 21:18:45.673[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/root-password account.getRootAccountPassword
[API] GET /api/v1/data/{engineName}/organizations/{orgName}/clusters/{clusterName}/root-password account.getRootAccountPassword
[1mSTEP:[0m create redis account [38;5;243m@ 03/03/25 21:18:46.381[0m
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[API] POST /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.createRedisAccount
[1mSTEP:[0m list redis account after creation [38;5;243m@ 03/03/25 21:18:48.825[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[1mSTEP:[0m update redis account [38;5;243m@ 03/03/25 21:19:09.497[0m
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[API] PATCH /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.updateRedisAccount
[1mSTEP:[0m list redis account after update [38;5;243m@ 03/03/25 21:19:12.136[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[1mSTEP:[0m delete redis account [38;5;243m@ 03/03/25 21:19:32.789[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[API] DELETE /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts/{accountName} redis.deleteRedisAccount
[1mSTEP:[0m list redis account after deletion [38;5;243m@ 03/03/25 21:19:35.73[0m
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
[API] GET /api/v1/data/redis/organizations/{orgName}/clusters/{clusterName}/accounts redis.listRedisAccounts
Operation account completed in 1m10.851285208s
[1mSTEP:[0m [8/10] Executing operation: stop-start - Stop and start cluster [38;5;243m@ 03/03/25 21:19:56.525[0m
[1mSTEP:[0m stop cluster [38;5;243m@ 03/03/25 21:19:56.525[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/stop opsrequest.stopCluster
[1mSTEP:[0m wait task 432530044464663098 to be Succeed [38;5;243m@ 03/03/25 21:19:56.552[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-stop-549mh status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-stop-549mh status: Pending, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-stop-549mh status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:20:26.622224    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-stop-549mh status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-stop-549mh status: Succeed, cluster status: Stopped
[1mSTEP:[0m waiting for cluster to reach status: Stopped [38;5;243m@ 03/03/25 21:20:46.721[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Stopped
[1mSTEP:[0m start cluster [38;5;243m@ 03/03/25 21:20:46.736[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/start opsrequest.startCluster
[1mSTEP:[0m wait task 432530128719841850 to be Succeed [38;5;243m@ 03/03/25 21:20:46.778[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-start-7qwd5 status: , cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-start-7qwd5 status: Creating, cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-start-7qwd5 status: Running, cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-start-7qwd5 status: Running, cluster status: Stopped
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-start-7qwd5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-start-7qwd5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-start-7qwd5 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-start-7qwd5 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-start-7qwd5 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:22:07.004[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Running
Operation stop-start completed in 2m10.496609164s
[1mSTEP:[0m [9/10] Executing operation: restart - Restart cluster components [38;5;243m@ 03/03/25 21:22:07.021[0m
[1mSTEP:[0m restart cluster [38;5;243m@ 03/03/25 21:22:07.021[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:22:07.021[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/restart opsrequest.restartCluster
[1mSTEP:[0m wait task 432530263407331898 to be Succeed [38;5;243m@ 03/03/25 21:22:07.052[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-restart-rhwc6 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-restart-rhwc6 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-restart-rhwc6 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-restart-rhwc6 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-restart-rhwc6 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-restart-rhwc6 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-restart-rhwc6 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-restart-rhwc6 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-restart-rhwc6 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:23:27.266[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Running
Operation restart completed in 1m20.260665973s
[1mSTEP:[0m [10/10] Executing operation: alert - Alert operations [38;5;243m@ 03/03/25 21:23:27.282[0m
[1mSTEP:[0m Stop the cluster [38;5;243m@ 03/03/25 21:23:27.282[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/stop opsrequest.stopCluster
[1mSTEP:[0m wait task 432530398044490298 to be Succeed [38;5;243m@ 03/03/25 21:23:27.309[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-stop-sjfzc status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:23:37.337279    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-stop-sjfzc status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-stop-sjfzc status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-a-784c9985dc-stop-sjfzc status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Stopped [38;5;243m@ 03/03/25 21:24:07.518[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-a5332yab status: Stopped
[1mSTEP:[0m Check for Down alert [38;5;243m@ 03/03/25 21:24:17.551[0m
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
Failed to list alerts: http: read on closed response body
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
[API] GET /api/v1/organizations/{orgName}/alerts/objects alertObject.listAlertObjects
No Down alert found for cluster e2e-a5332yab yet
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
backup          | PASS    | 1        | 2m11s    | 2m11s    | 2m11s    | 2m11s
hscale          | PASS    | 1        | 2m0s     | 2m0s     | 2m0s     | 2m0s
vscale          | PASS    | 1        | 3m11s    | 3m11s    | 3m11s    | 3m11s
promote         | PASS    | 1        | 1m11s    | 1m11s    | 1m11s    | 1m11s
upgrade         | PASS    | 1        | 0s       | 0s       | 0s       | 0s
volume-expansion | PASS    | 1        | 30s      | 30s      | 30s      | 30s
account         | PASS    | 1        | 1m11s    | 1m11s    | 1m11s    | 1m11s
stop-start      | PASS    | 1        | 2m10s    | 2m10s    | 2m10s    | 2m10s
restart         | PASS    | 1        | 1m20s    | 1m20s    | 1m20s    | 1m20s
alert           | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: sentinel | Version: 6.2.17 | Operations: 9/10 (90.0%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/alert_test.go:45 [38;5;243m@ 03/03/25 21:29:17.561[0m
=== Test Failed ===
Engine: redis
Mode: sentinel
Version: 6.2.17
Cluster: e2e-a5332yab
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [1265.914 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/sentinel/6.2.17[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] Timed out after 300.009s.
should find Down alert for the stopped cluster
Expected
<bool>: false
to be true[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/alert_test.go:45[0m [38;5;243m@ 03/03/25 21:29:17.561[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/sentinel/7.0.6[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 21:29:17.561[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 21:29:17.561[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 21:29:17.561[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 21:29:17.561[0m
[1mSTEP:[0m set mode sentinel [38;5;243m@ 03/03/25 21:29:17.561[0m
[1mSTEP:[0m set version 7.0.6 [38;5;243m@ 03/03/25 21:29:17.561[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 21:29:17.561[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 21:29:17.561[0m
[API] GET /api/v1/classes class.listClasses
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 21:29:17.594[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 21:29:17.594[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 21:29:17.594[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 21:29:17.597[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 21:29:17.597[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 21:29:17.597[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 21:29:17.795[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 21:29:17.795[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 21:29:17.795[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 21:29:17.795[0m
[1mSTEP:[0m verify component redis-sentinel [38;5;243m@ 03/03/25 21:29:17.795[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 21:29:17.795[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 21:29:17.795[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 21:29:17.795[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.sentinel.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]},{"classCode":"redis.sentinel.redis-sentinel-7.0.5c0.5g.general","classSeries":"general","codeShort":"0.5c0.5g","component":"redis-sentinel","cpu":0.5,"memory":0.5,"replicas":3,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T21:29:17.792Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-s-7cc7586759","id":"432530986069133882","mode":"sentinel","name":"e2e-si2612a0","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T21:29:17.792Z","version":"7.0.6"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 21:29:17.795[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:29:17.795[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:29:57.884242    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 21:30:48.011[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 21:30:48.025[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 21:30:48.025[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 21:30:48.025[0m
[1mSTEP:[0m verify component redis-sentinel [38;5;243m@ 03/03/25 21:30:48.025[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 21:30:48.025[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 21:30:48.025[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 21:30:48.025[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 21:30:48.025[0m
Engine: redis
Mode: sentinel
Version: 7.0.6
Components:
- redis:
Replicas: 1-10 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
- redis-sentinel:
Replicas: 1-3 (default: 3)
Storages:
- data: 20-20Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ“ hscale
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-cluster:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-sentinel:
âœ“ dashboard
âœ“ upgrade: confirm by upgradeable versions
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
Supported Components: [redis]
- vscale: Scale cluster components vertically
Supported Components: [redis]
- volume-expansion: Expand cluster volumes
Supported Components: [redis]
- promote: Promote cluster components
Supported Components: [redis]
- upgrade: Upgrade cluster
Supported Components: [redis redis-sentinel]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis]
- restart: Restart cluster components
Supported Components: [redis]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. hscale: Scale cluster components horizontally
Supported Components: [redis]
3. vscale: Scale cluster components vertically
Supported Components: [redis]
4. volume-expansion: Expand cluster volumes
Supported Components: [redis]
5. promote: Promote cluster components
Supported Components: [redis]
6. upgrade: Upgrade cluster
Supported Components: [redis redis-sentinel]
7. account: Account operations
8. stop-start: Stop and start cluster
Supported Components: [redis]
9. restart: Restart cluster components
Supported Components: [redis]
10. alert: Alert operations
[1mSTEP:[0m [1/10] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 21:30:48.026[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 21:30:48.026[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 21:30:48.03[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 21:30:48.03[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-s-7cc7586759-datafile-20250303213046 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-s-7cc7586759-datafile-20250303213046 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 21:30:58.036[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup 52c06cbf-e2e-s-7cc7586759-redi-aof is running
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 21:30:58.038[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 21:30:58.038[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 21:30:58.106[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupyfsfoi17 in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupyfsfoi17 completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 21:31:08.116[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 21:31:08.12[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.sentinel.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]},{"classCode":"redis.sentinel.redis-sentinel-7.0.5c0.5g.general","classSeries":"general","codeShort":"0.5c0.5g","component":"redis-sentinel","cpu":0.5,"memory":0.5,"replicas":3,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-lkfvw43z","engine":"redis","environmentName":"cloud-dev","mode":"sentinel","name":"restore-e2e-lkfvw43z","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"7.0.6"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 21:31:08.318[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:31:08.318[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lkfvw43z status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lkfvw43z status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lkfvw43z status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lkfvw43z status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lkfvw43z status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lkfvw43z status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lkfvw43z status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lkfvw43z status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lkfvw43z status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lkfvw43z status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-lkfvw43z status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 21:32:48.558[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-lkfvw43z [38;5;243m@ 03/03/25 21:32:48.573[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 21:32:48.712[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 21:32:48.714[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 2m0.708990916s
[1mSTEP:[0m [2/10] Executing operation: hscale - Scale cluster components horizontally [38;5;243m@ 03/03/25 21:32:48.735[0m
[1mSTEP:[0m scale cluster horizontally [38;5;243m@ 03/03/25 21:32:48.735[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:32:48.735[0m
[1mSTEP:[0m current replicas: 2 [38;5;243m@ 03/03/25 21:32:48.735[0m
[1mSTEP:[0m scale redis from 2 to 3 [38;5;243m@ 03/03/25 21:32:48.735[0m
[1mSTEP:[0m changing component redis replicas to 3 [38;5;243m@ 03/03/25 21:32:48.735[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432531340018059834 to be Succeed [38;5;243m@ 03/03/25 21:32:48.764[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-horizontalscaling-khc8r status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-horizontalscaling-khc8r status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:33:08.812637    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-horizontalscaling-khc8r status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-horizontalscaling-khc8r status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-horizontalscaling-khc8r status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-horizontalscaling-khc8r status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-horizontalscaling-khc8r status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-horizontalscaling-khc8r status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:34:09.019[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale down to original replicas [38;5;243m@ 03/03/25 21:34:09.053[0m
[1mSTEP:[0m changing component redis replicas to 2 [38;5;243m@ 03/03/25 21:34:09.053[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432531474772658746 to be Succeed [38;5;243m@ 03/03/25 21:34:09.084[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-horizontalscaling-ll5mc status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-horizontalscaling-ll5mc status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-horizontalscaling-ll5mc status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-horizontalscaling-ll5mc status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:34:39.182[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation hscale completed in 1m50.478016903s
[1mSTEP:[0m [3/10] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 21:34:39.213[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 21:34:39.213[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:34:39.213[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.sentinel.redis-7.2c1g.general [38;5;243m@ 03/03/25 21:34:39.229[0m
[1mSTEP:[0m choose larger class: redis.sentinel.redis-7.2c2g.general [38;5;243m@ 03/03/25 21:34:39.229[0m
[1mSTEP:[0m changing component redis class to redis.sentinel.redis-7.2c2g.general [38;5;243m@ 03/03/25 21:34:39.229[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432531525389519418 to be Succeed [38;5;243m@ 03/03/25 21:34:39.258[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-lqkj7 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-lqkj7 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-lqkj7 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-lqkj7 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-lqkj7 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-lqkj7 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-lqkj7 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-lqkj7 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-lqkj7 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-lqkj7 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:36:09.484[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 21:36:09.499[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 21:36:09.514[0m
[1mSTEP:[0m changing component redis class to redis.sentinel.redis-7.2c1g.general [38;5;243m@ 03/03/25 21:36:09.514[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432531676871002682 to be Succeed [38;5;243m@ 03/03/25 21:36:09.544[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-4zxsw status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:36:19.563272    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-4zxsw status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-4zxsw status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-4zxsw status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-4zxsw status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-4zxsw status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-4zxsw status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-4zxsw status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-4zxsw status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-verticalscaling-4zxsw status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:37:49.851[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 21:37:49.867[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 3m10.668348943s
[1mSTEP:[0m [4/10] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 21:37:49.881[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 21:37:49.881[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:37:49.881[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 21:37:49.881[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432531845280696890 to be Succeed [38;5;243m@ 03/03/25 21:37:49.925[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-volumeexpansion-j6lq5 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-volumeexpansion-j6lq5 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-volumeexpansion-j6lq5 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-volumeexpansion-j6lq5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-volumeexpansion-j6lq5 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:38:30.039[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 40.187404724s
[1mSTEP:[0m [5/10] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 21:38:30.069[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 21:38:30.069[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:38:30.069[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-si2612a0 status: Running
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:38:30.09[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-s-7cc7586759-redis-1 with role secondary [38;5;243m@ 03/03/25 21:38:30.512[0m
[1mSTEP:[0m promoting instance e2e-s-7cc7586759-redis-1 of component redis from secondary to primary [38;5;243m@ 03/03/25 21:38:30.512[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432531913547188794 to be Succeed [38;5;243m@ 03/03/25 21:38:30.614[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:39:31.319892    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-7cc7586759-switchover-9nvx5 status: Failed, cluster status: Running
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
backup          | PASS    | 1        | 2m1s     | 2m1s     | 2m1s     | 2m1s
hscale          | PASS    | 1        | 1m50s    | 1m50s    | 1m50s    | 1m50s
vscale          | PASS    | 1        | 3m11s    | 3m11s    | 3m11s    | 3m11s
volume-expansion | PASS    | 1        | 40s      | 40s      | 40s      | 40s
stop-start      | SKIP    | 0        | -        | -        | -        | -
promote         | SKIP    | 0        | -        | -        | -        | -
upgrade         | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: sentinel | Version: 7.0.6 | Operations: 4/10 (40.0%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/ops_test.go:33 [38;5;243m@ 03/03/25 21:40:51.578[0m
=== Test Failed ===
Engine: redis
Mode: sentinel
Version: 7.0.6
Cluster: e2e-si2612a0
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [694.017 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/sentinel/7.0.6[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] task e2e-s-7cc7586759-switchover-9nvx5 failed, cluster status: Running[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/ops_test.go:33[0m [38;5;243m@ 03/03/25 21:40:51.578[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/sentinel/7.2.4[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 21:40:51.578[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 21:40:51.578[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 21:40:51.578[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 21:40:51.578[0m
[1mSTEP:[0m set mode sentinel [38;5;243m@ 03/03/25 21:40:51.578[0m
[1mSTEP:[0m set version 7.2.4 [38;5;243m@ 03/03/25 21:40:51.578[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 21:40:51.578[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 21:40:51.578[0m
[API] GET /api/v1/classes class.listClasses
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 21:40:51.61[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 21:40:51.61[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 21:40:51.61[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 21:40:51.613[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 21:40:51.613[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 21:40:51.613[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 21:40:51.801[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 21:40:51.801[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 21:40:51.801[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 21:40:51.801[0m
[1mSTEP:[0m verify component redis-sentinel [38;5;243m@ 03/03/25 21:40:51.801[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 21:40:51.801[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 21:40:51.801[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 21:40:51.801[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.sentinel.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]},{"classCode":"redis.sentinel.redis-sentinel-7.0.5c0.5g.general","classSeries":"general","codeShort":"0.5c0.5g","component":"redis-sentinel","cpu":0.5,"memory":0.5,"replicas":3,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T21:40:51.798Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-c-64b9658487","id":"432532150407924282","mode":"sentinel","name":"e2e-cnrqxhym","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T21:40:51.798Z","version":"7.2.4"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 21:40:51.801[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:40:51.801[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 21:42:32.036[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 21:42:32.052[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 21:42:32.052[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 21:42:32.052[0m
[1mSTEP:[0m verify component redis-sentinel [38;5;243m@ 03/03/25 21:42:32.052[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 21:42:32.052[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 21:42:32.052[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 21:42:32.052[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 21:42:32.052[0m
Engine: redis
Mode: sentinel
Version: 7.2.4
Components:
- redis:
Replicas: 1-10 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
- redis-sentinel:
Replicas: 1-3 (default: 3)
Storages:
- data: 20-20Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ“ hscale
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-cluster:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-sentinel:
âœ“ dashboard
âœ“ upgrade: confirm by upgradeable versions
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
Supported Components: [redis]
- vscale: Scale cluster components vertically
Supported Components: [redis]
- volume-expansion: Expand cluster volumes
Supported Components: [redis]
- promote: Promote cluster components
Supported Components: [redis]
- upgrade: Upgrade cluster
Supported Components: [redis redis-sentinel]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis]
- restart: Restart cluster components
Supported Components: [redis]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. hscale: Scale cluster components horizontally
Supported Components: [redis]
3. vscale: Scale cluster components vertically
Supported Components: [redis]
4. volume-expansion: Expand cluster volumes
Supported Components: [redis]
5. promote: Promote cluster components
Supported Components: [redis]
6. upgrade: Upgrade cluster
Supported Components: [redis-sentinel redis]
7. account: Account operations
8. stop-start: Stop and start cluster
Supported Components: [redis]
9. restart: Restart cluster components
Supported Components: [redis]
10. alert: Alert operations
[1mSTEP:[0m [1/10] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 21:42:32.052[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 21:42:32.052[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 21:42:32.059[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 21:42:32.059[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-c-64b9658487-datafile-20250303214223 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
failed to get backup e2e-c-64b9658487-datafile-20250303214223: failed to get backup, err: http: read on closed response body
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-c-64b9658487-datafile-20250303214223 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 21:42:52.076[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup 6f811885-e2e-c-64b9658487-redi-aof is running
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 21:42:52.078[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 21:42:52.078[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 21:42:52.143[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup971d4w7e in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup971d4w7e completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 21:43:02.158[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 21:43:02.162[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.sentinel.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]},{"classCode":"redis.sentinel.redis-sentinel-7.0.5c0.5g.general","classSeries":"general","codeShort":"0.5c0.5g","component":"redis-sentinel","cpu":0.5,"memory":0.5,"replicas":3,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-b89e4qcg","engine":"redis","environmentName":"cloud-dev","mode":"sentinel","name":"restore-e2e-b89e4qcg","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"7.2.4"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 21:43:02.361[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:43:02.361[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b89e4qcg status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b89e4qcg status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b89e4qcg status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b89e4qcg status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b89e4qcg status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b89e4qcg status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b89e4qcg status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b89e4qcg status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b89e4qcg status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b89e4qcg status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-b89e4qcg status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 21:44:42.601[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-b89e4qcg [38;5;243m@ 03/03/25 21:44:42.617[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 21:44:42.757[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 21:44:42.761[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 2m10.732665741s
[1mSTEP:[0m [2/10] Executing operation: hscale - Scale cluster components horizontally [38;5;243m@ 03/03/25 21:44:42.785[0m
[1mSTEP:[0m scale cluster horizontally [38;5;243m@ 03/03/25 21:44:42.785[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:44:42.785[0m
[1mSTEP:[0m current replicas: 2 [38;5;243m@ 03/03/25 21:44:42.785[0m
[1mSTEP:[0m scale redis from 2 to 3 [38;5;243m@ 03/03/25 21:44:42.785[0m
[1mSTEP:[0m changing component redis replicas to 3 [38;5;243m@ 03/03/25 21:44:42.785[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432532537995168314 to be Succeed [38;5;243m@ 03/03/25 21:44:42.815[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-horizontalscaling-zrwtq status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-horizontalscaling-zrwtq status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-horizontalscaling-zrwtq status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-horizontalscaling-zrwtq status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-horizontalscaling-zrwtq status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-horizontalscaling-zrwtq status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-horizontalscaling-zrwtq status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:45:52.989321    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-horizontalscaling-zrwtq status: Succeed, cluster status: Updating
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:46:03.083[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale down to original replicas [38;5;243m@ 03/03/25 21:46:13.132[0m
[1mSTEP:[0m changing component redis replicas to 2 [38;5;243m@ 03/03/25 21:46:13.132[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432532689560537658 to be Succeed [38;5;243m@ 03/03/25 21:46:13.158[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-horizontalscaling-z8ptt status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-horizontalscaling-z8ptt status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-horizontalscaling-z8ptt status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-horizontalscaling-z8ptt status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-horizontalscaling-z8ptt status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:46:53.266[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation hscale completed in 2m10.510810686s
[1mSTEP:[0m [3/10] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 21:46:53.296[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 21:46:53.296[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:46:53.296[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.sentinel.redis-7.2c1g.general [38;5;243m@ 03/03/25 21:46:53.312[0m
[1mSTEP:[0m choose larger class: redis.sentinel.redis-7.2c2g.general [38;5;243m@ 03/03/25 21:46:53.312[0m
[1mSTEP:[0m changing component redis class to redis.sentinel.redis-7.2c2g.general [38;5;243m@ 03/03/25 21:46:53.312[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432532756988168762 to be Succeed [38;5;243m@ 03/03/25 21:46:53.342[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-lccj4 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-lccj4 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-lccj4 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-lccj4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-lccj4 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-lccj4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-lccj4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-lccj4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-lccj4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-lccj4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-lccj4 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:48:33.605[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 21:48:33.621[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 21:48:33.635[0m
[1mSTEP:[0m changing component redis class to redis.sentinel.redis-7.2c1g.general [38;5;243m@ 03/03/25 21:48:33.635[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432532925297199674 to be Succeed [38;5;243m@ 03/03/25 21:48:33.666[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-ccmr9 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-ccmr9 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-ccmr9 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:49:03.734659    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-ccmr9 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-ccmr9 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-ccmr9 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-ccmr9 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-ccmr9 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-ccmr9 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-verticalscaling-ccmr9 status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:50:13.946[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 21:50:13.962[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 3m20.680110864s
[1mSTEP:[0m [4/10] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 21:50:13.976[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 21:50:13.976[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:50:13.976[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 21:50:13.976[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432533093656562234 to be Succeed [38;5;243m@ 03/03/25 21:50:14.017[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-volumeexpansion-wgjtc status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-volumeexpansion-wgjtc status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-volumeexpansion-wgjtc status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-volumeexpansion-wgjtc status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-volumeexpansion-wgjtc status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:50:54.139[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 40.192228715s
[1mSTEP:[0m [5/10] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 21:50:54.168[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 21:50:54.168[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:50:54.168[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-cnrqxhym status: Running
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:50:54.183[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-c-64b9658487-redis-1 with role secondary [38;5;243m@ 03/03/25 21:50:54.561[0m
[1mSTEP:[0m promoting instance e2e-c-64b9658487-redis-1 of component redis from secondary to primary [38;5;243m@ 03/03/25 21:50:54.561[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432533161855945274 to be Succeed [38;5;243m@ 03/03/25 21:50:54.663[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:52:14.861042    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-64b9658487-switchover-pf2lk status: Failed, cluster status: Running
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
backup          | PASS    | 1        | 2m11s    | 2m11s    | 2m11s    | 2m11s
hscale          | PASS    | 1        | 2m11s    | 2m11s    | 2m11s    | 2m11s
vscale          | PASS    | 1        | 3m21s    | 3m21s    | 3m21s    | 3m21s
volume-expansion | PASS    | 1        | 40s      | 40s      | 40s      | 40s
promote         | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
upgrade         | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: sentinel | Version: 7.2.4 | Operations: 4/10 (40.0%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/ops_test.go:33 [38;5;243m@ 03/03/25 21:53:15.006[0m
=== Test Failed ===
Engine: redis
Mode: sentinel
Version: 7.2.4
Cluster: e2e-cnrqxhym
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [743.428 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/sentinel/7.2.4[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] task e2e-c-64b9658487-switchover-pf2lk failed, cluster status: Running[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/ops_test.go:33[0m [38;5;243m@ 03/03/25 21:53:15.006[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/sentinel/7.2.7[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 21:53:15.006[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 21:53:15.006[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 21:53:15.006[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 21:53:15.006[0m
[1mSTEP:[0m set mode sentinel [38;5;243m@ 03/03/25 21:53:15.007[0m
[1mSTEP:[0m set version 7.2.7 [38;5;243m@ 03/03/25 21:53:15.007[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 21:53:15.007[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 21:53:15.007[0m
[API] GET /api/v1/classes class.listClasses
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 21:53:15.039[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 21:53:15.039[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 21:53:15.039[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m determine the availability zone of the environment [38;5;243m@ 03/03/25 21:53:15.042[0m
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 21:53:15.042[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 21:53:15.042[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 21:53:15.232[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 21:53:15.232[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 21:53:15.232[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 21:53:15.232[0m
[1mSTEP:[0m verify component redis-sentinel [38;5;243m@ 03/03/25 21:53:15.232[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 21:53:15.232[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 21:53:15.232[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 21:53:15.232[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.sentinel.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]},{"classCode":"redis.sentinel.redis-sentinel-7.0.5c0.5g.general","classSeries":"general","codeShort":"0.5c0.5g","component":"redis-sentinel","cpu":0.5,"memory":0.5,"replicas":3,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T21:53:15.229Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-s-75c987b4f4","id":"432533397676493370","mode":"sentinel","name":"e2e-slhhsfkx","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T21:53:15.229Z","version":"7.2.7"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 21:53:15.232[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:53:15.232[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 21:54:35.423[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 21:54:35.438[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 21:54:35.438[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 21:54:35.438[0m
[1mSTEP:[0m verify component redis-sentinel [38;5;243m@ 03/03/25 21:54:35.438[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 21:54:35.438[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 21:54:35.438[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 21:54:35.438[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 21:54:35.438[0m
Engine: redis
Mode: sentinel
Version: 7.2.7
Components:
- redis:
Replicas: 1-10 (default: 2)
Storages:
- data: 20-0Gi (default: 20Gi)
- redis-sentinel:
Replicas: 1-3 (default: 3)
Storages:
- data: 20-20Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ“ hscale
âœ“ log
âœ“ parameter
âœ“ promote
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-cluster:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-sentinel:
âœ“ dashboard
âœ“ upgrade: confirm by upgradeable versions
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
Supported Components: [redis]
- vscale: Scale cluster components vertically
Supported Components: [redis]
- volume-expansion: Expand cluster volumes
Supported Components: [redis]
- promote: Promote cluster components
Supported Components: [redis]
- upgrade: Upgrade cluster
Supported Components: [redis-sentinel redis]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis]
- restart: Restart cluster components
Supported Components: [redis]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. hscale: Scale cluster components horizontally
Supported Components: [redis]
3. vscale: Scale cluster components vertically
Supported Components: [redis]
4. volume-expansion: Expand cluster volumes
Supported Components: [redis]
5. promote: Promote cluster components
Supported Components: [redis]
6. upgrade: Upgrade cluster
Supported Components: [redis redis-sentinel]
7. account: Account operations
8. stop-start: Stop and start cluster
Supported Components: [redis]
9. restart: Restart cluster components
Supported Components: [redis]
10. alert: Alert operations
[1mSTEP:[0m [1/10] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 21:54:35.439[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 21:54:35.439[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 21:54:35.441[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 21:54:35.441[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-s-75c987b4f4-datafile-20250303215434 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-s-75c987b4f4-datafile-20250303215434 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-s-75c987b4f4-datafile-20250303215434 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 21:54:55.458[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup 5b9a8012-e2e-s-75c987b4f4-redi-aof is running
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 21:54:55.46[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 21:54:55.46[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 21:54:55.527[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup43tz5xij in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup43tz5xij in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backup43tz5xij completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 21:55:15.544[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 21:55:15.549[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.sentinel.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":2,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]},{"classCode":"redis.sentinel.redis-sentinel-7.0.5c0.5g.general","classSeries":"general","codeShort":"0.5c0.5g","component":"redis-sentinel","cpu":0.5,"memory":0.5,"replicas":3,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-ihheqcx7","engine":"redis","environmentName":"cloud-dev","mode":"sentinel","name":"restore-e2e-ihheqcx7","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"7.2.7"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 21:55:15.752[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:55:15.752[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ihheqcx7 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:55:25.778286    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ihheqcx7 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ihheqcx7 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ihheqcx7 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ihheqcx7 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ihheqcx7 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ihheqcx7 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ihheqcx7 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ihheqcx7 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ihheqcx7 status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ihheqcx7 status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 21:57:06.033[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-ihheqcx7 [38;5;243m@ 03/03/25 21:57:06.05[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 21:57:06.185[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 21:57:06.187[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 2m30.773581767s
[1mSTEP:[0m [2/10] Executing operation: hscale - Scale cluster components horizontally [38;5;243m@ 03/03/25 21:57:06.212[0m
[1mSTEP:[0m scale cluster horizontally [38;5;243m@ 03/03/25 21:57:06.212[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:57:06.212[0m
[1mSTEP:[0m current replicas: 2 [38;5;243m@ 03/03/25 21:57:06.212[0m
[1mSTEP:[0m scale redis from 2 to 3 [38;5;243m@ 03/03/25 21:57:06.212[0m
[1mSTEP:[0m changing component redis replicas to 3 [38;5;243m@ 03/03/25 21:57:06.212[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432533785246960186 to be Succeed [38;5;243m@ 03/03/25 21:57:06.241[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-horizontalscaling-nwgh4 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-horizontalscaling-nwgh4 status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-horizontalscaling-nwgh4 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-horizontalscaling-nwgh4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-horizontalscaling-nwgh4 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-horizontalscaling-nwgh4 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-horizontalscaling-nwgh4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-horizontalscaling-nwgh4 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-horizontalscaling-nwgh4 status: Succeed, cluster status: Updating
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:58:26.458[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 21:58:36.476033    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale down to original replicas [38;5;243m@ 03/03/25 21:58:46.539[0m
[1mSTEP:[0m changing component redis replicas to 2 [38;5;243m@ 03/03/25 21:58:46.539[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/hscale opsrequest.horizontalScaleCluster
[1mSTEP:[0m wait task 432533953572768314 to be Succeed [38;5;243m@ 03/03/25 21:58:46.566[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-horizontalscaling-88bvm status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-horizontalscaling-88bvm status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-horizontalscaling-88bvm status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-horizontalscaling-88bvm status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 21:59:16.667[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation hscale completed in 2m10.486314148s
[1mSTEP:[0m [3/10] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 21:59:16.699[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 21:59:16.699[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 21:59:16.699[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.sentinel.redis-7.2c1g.general [38;5;243m@ 03/03/25 21:59:16.716[0m
[1mSTEP:[0m choose larger class: redis.sentinel.redis-7.2c2g.general [38;5;243m@ 03/03/25 21:59:16.716[0m
[1mSTEP:[0m changing component redis class to redis.sentinel.redis-7.2c2g.general [38;5;243m@ 03/03/25 21:59:16.716[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432534004206406202 to be Succeed [38;5;243m@ 03/03/25 21:59:16.747[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-6fhtk status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-6fhtk status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-6fhtk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-6fhtk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-6fhtk status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-6fhtk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-6fhtk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-6fhtk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-6fhtk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-6fhtk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-6fhtk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-6fhtk status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-6fhtk status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 22:01:17.054[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 22:01:17.07[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m scale back to original class [38;5;243m@ 03/03/25 22:01:17.084[0m
[1mSTEP:[0m changing component redis class to redis.sentinel.redis-7.2c1g.general [38;5;243m@ 03/03/25 22:01:17.084[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432534206153755194 to be Succeed [38;5;243m@ 03/03/25 22:01:17.112[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-9272q status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-9272q status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-9272q status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:01:47.215187    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-9272q status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-9272q status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-9272q status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-9272q status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-9272q status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-9272q status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-verticalscaling-9272q status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 22:02:57.424[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Running
[1mSTEP:[0m verify the class is updated [38;5;243m@ 03/03/25 22:02:57.438[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation vscale completed in 3m40.755014808s
[1mSTEP:[0m [4/10] Executing operation: volume-expansion - Expand cluster volumes [38;5;243m@ 03/03/25 22:02:57.454[0m
[1mSTEP:[0m expand cluster volume [38;5;243m@ 03/03/25 22:02:57.454[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 22:02:57.454[0m
[1mSTEP:[0m choose volume: data [38;5;243m@ 03/03/25 22:02:57.454[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/volume-expand opsrequest.clusterVolumeExpand
[1mSTEP:[0m wait task 432534374597003834 to be Succeed [38;5;243m@ 03/03/25 22:02:57.512[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-volumeexpansion-xc2mz status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-volumeexpansion-xc2mz status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-volumeexpansion-xc2mz status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-volumeexpansion-xc2mz status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-volumeexpansion-xc2mz status: Succeed, cluster status: Running
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 22:03:37.618[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
Operation volume-expansion completed in 40.194415335s
[1mSTEP:[0m [5/10] Executing operation: promote - Promote cluster components [38;5;243m@ 03/03/25 22:03:37.648[0m
[1mSTEP:[0m promote cluster [38;5;243m@ 03/03/25 22:03:37.648[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 22:03:37.648[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-slhhsfkx status: Running
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 22:03:37.665[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/instances cluster.listInstance
[1mSTEP:[0m first promotion: promote instance e2e-s-75c987b4f4-redis-1 with role secondary [38;5;243m@ 03/03/25 22:03:37.971[0m
[1mSTEP:[0m promoting instance e2e-s-75c987b4f4-redis-1 of component redis from secondary to primary [38;5;243m@ 03/03/25 22:03:37.971[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/promote opsrequest.promoteCluster
[1mSTEP:[0m wait task 432534442645391930 to be Succeed [38;5;243m@ 03/03/25 22:03:38.072[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:04:58.258257    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-s-75c987b4f4-switchover-999fv status: Failed, cluster status: Running
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
backup          | PASS    | 1        | 2m31s    | 2m31s    | 2m31s    | 2m31s
hscale          | PASS    | 1        | 2m10s    | 2m10s    | 2m10s    | 2m10s
vscale          | PASS    | 1        | 3m41s    | 3m41s    | 3m41s    | 3m41s
volume-expansion | PASS    | 1        | 40s      | 40s      | 40s      | 40s
upgrade         | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
promote         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: sentinel | Version: 7.2.7 | Operations: 4/10 (40.0%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/ops_test.go:33 [38;5;243m@ 03/03/25 22:05:58.488[0m
=== Test Failed ===
Engine: redis
Mode: sentinel
Version: 7.2.7
Cluster: e2e-slhhsfkx
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [763.482 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/sentinel/7.2.7[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] task e2e-s-75c987b4f4-switchover-999fv failed, cluster status: Running[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/ops_test.go:33[0m [38;5;243m@ 03/03/25 22:05:58.488[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/standalone/6.2.17[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 22:05:58.489[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 22:05:58.489[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 22:05:58.489[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 22:05:58.489[0m
[1mSTEP:[0m set mode standalone [38;5;243m@ 03/03/25 22:05:58.489[0m
[1mSTEP:[0m set version 6.2.17 [38;5;243m@ 03/03/25 22:05:58.489[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 22:05:58.489[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 22:05:58.489[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 22:05:58.505[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 22:05:58.505[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 22:05:58.505[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 22:05:58.508[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 22:05:58.508[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 22:05:58.689[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 22:05:58.689[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 22:05:58.689[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 22:05:58.689[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 22:05:58.689[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 22:05:58.689[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 22:05:58.689[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.standalone.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T22:05:58.686Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-x-69b66b8d7c","id":"432534678549826106","mode":"standalone","name":"e2e-xt90sere","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T22:05:58.686Z","version":"6.2.17"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 22:05:58.689[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 22:05:58.689[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-xt90sere status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-xt90sere status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-xt90sere status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-xt90sere status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-xt90sere status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-xt90sere status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-xt90sere status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 22:06:58.838[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 22:06:58.852[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 22:06:58.852[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 22:06:58.852[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 22:06:58.852[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 22:06:58.852[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 22:06:58.852[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 22:06:58.852[0m
Engine: redis
Mode: standalone
Version: 6.2.17
Components:
- redis:
Replicas: 1-1 (default: 1)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ— hscale: replicas range is 1-1
âœ“ log
âœ“ parameter
âœ— promote: replicas range is 1-1
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-cluster:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-sentinel:
âœ“ dashboard
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
- vscale: Scale cluster components vertically
Supported Components: [redis]
- volume-expansion: Expand cluster volumes
Supported Components: [redis]
- promote: Promote cluster components
- upgrade: Upgrade cluster
Supported Components: [redis]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis]
- restart: Restart cluster components
Supported Components: [redis]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. vscale: Scale cluster components vertically
Supported Components: [redis]
3. volume-expansion: Expand cluster volumes
Supported Components: [redis]
4. upgrade: Upgrade cluster
Supported Components: [redis]
5. account: Account operations
6. stop-start: Stop and start cluster
Supported Components: [redis]
7. restart: Restart cluster components
Supported Components: [redis]
8. alert: Alert operations
[1mSTEP:[0m [1/8] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 22:06:58.852[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 22:06:58.852[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 22:06:58.857[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 22:06:58.857[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-x-69b66b8d7c-datafile-20250303220654 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-x-69b66b8d7c-datafile-20250303220654 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 22:07:08.864[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e6b80572-e2e-x-69b66b8d7c-redi-aof is running
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 22:07:08.866[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 22:07:08.866[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 22:07:08.932[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupudftidf0 in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupudftidf0 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupudftidf0 completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 22:07:28.95[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 22:07:28.954[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.standalone.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-1ooxt0av","engine":"redis","environmentName":"cloud-dev","mode":"standalone","name":"restore-e2e-1ooxt0av","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"6.2.17"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 22:07:29.146[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 22:07:29.146[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-1ooxt0av status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-1ooxt0av status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-1ooxt0av status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-1ooxt0av status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:08:09.238039    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-1ooxt0av status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-1ooxt0av status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-1ooxt0av status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-1ooxt0av status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 22:08:49.374[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-1ooxt0av [38;5;243m@ 03/03/25 22:08:49.39[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 22:08:49.528[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 22:08:49.531[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 1m50.707161882s
[1mSTEP:[0m [2/8] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 22:08:49.559[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 22:08:49.559[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 22:08:49.559[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.standalone.redis-7.2c1g.general [38;5;243m@ 03/03/25 22:08:49.575[0m
[1mSTEP:[0m choose larger class: redis.standalone.redis.167c255g.general [38;5;243m@ 03/03/25 22:08:49.575[0m
[1mSTEP:[0m changing component redis class to redis.standalone.redis.167c255g.general [38;5;243m@ 03/03/25 22:08:49.575[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432534965306001978 to be Succeed [38;5;243m@ 03/03/25 22:08:49.61[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:11:19.975976    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:14:30.510496    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:17:41.529305    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-x-69b66b8d7c-verticalscaling-jd82f status: Running, cluster status: Updating
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
backup          | PASS    | 1        | 1m51s    | 1m51s    | 1m51s    | 1m51s
stop-start      | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
vscale          | SKIP    | 0        | -        | -        | -        | -
volume-expansion | SKIP    | 0        | -        | -        | -        | -
upgrade         | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: standalone | Version: 6.2.17 | Operations: 1/8 (12.5%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/ops_test.go:36 [38;5;243m@ 03/03/25 22:18:49.617[0m
=== Test Failed ===
Engine: redis
Mode: standalone
Version: 6.2.17
Cluster: e2e-xt90sere
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [771.128 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/standalone/6.2.17[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] Timed out after 600.006s.
Expected
<constants.ClusterTaskStatus>: Running
to equal
<constants.ClusterTaskStatus>: Succeed[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/ops_test.go:36[0m [38;5;243m@ 03/03/25 22:18:49.617[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/standalone/7.0.6[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 22:18:49.617[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 22:18:49.617[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 22:18:49.617[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 22:18:49.617[0m
[1mSTEP:[0m set mode standalone [38;5;243m@ 03/03/25 22:18:49.617[0m
[1mSTEP:[0m set version 7.0.6 [38;5;243m@ 03/03/25 22:18:49.617[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 22:18:49.617[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 22:18:49.617[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 22:18:49.635[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 22:18:49.635[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 22:18:49.635[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 22:18:49.638[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 22:18:49.638[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 22:18:49.819[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 22:18:49.819[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 22:18:49.819[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 22:18:49.819[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 22:18:49.819[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 22:18:49.819[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 22:18:49.819[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.standalone.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T22:18:49.816Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-c-66d454955c","id":"432535972291283514","mode":"standalone","name":"e2e-ce14nz8w","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T22:18:49.816Z","version":"7.0.6"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 22:18:49.819[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 22:18:49.819[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-ce14nz8w status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-ce14nz8w status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-ce14nz8w status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-ce14nz8w status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-ce14nz8w status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-ce14nz8w status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-ce14nz8w status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 22:19:49.977[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 22:19:49.993[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 22:19:49.993[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 22:19:49.993[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 22:19:49.993[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 22:19:49.993[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 22:19:49.993[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 22:19:49.993[0m
Engine: redis
Mode: standalone
Version: 7.0.6
Components:
- redis:
Replicas: 1-1 (default: 1)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ— hscale: replicas range is 1-1
âœ“ log
âœ“ parameter
âœ— promote: replicas range is 1-1
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-cluster:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-sentinel:
âœ“ dashboard
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
- vscale: Scale cluster components vertically
Supported Components: [redis]
- volume-expansion: Expand cluster volumes
Supported Components: [redis]
- promote: Promote cluster components
- upgrade: Upgrade cluster
Supported Components: [redis]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis]
- restart: Restart cluster components
Supported Components: [redis]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. vscale: Scale cluster components vertically
Supported Components: [redis]
3. volume-expansion: Expand cluster volumes
Supported Components: [redis]
4. upgrade: Upgrade cluster
Supported Components: [redis]
5. account: Account operations
6. stop-start: Stop and start cluster
Supported Components: [redis]
7. restart: Restart cluster components
Supported Components: [redis]
8. alert: Alert operations
[1mSTEP:[0m [1/8] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 22:19:49.993[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 22:19:49.993[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 22:19:49.996[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 22:19:49.996[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-c-66d454955c-datafile-20250303221943 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-c-66d454955c-datafile-20250303221943 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 22:20:00.009[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup 34f1401b-e2e-c-66d454955c-redi-aof is running
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 22:20:00.011[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 22:20:00.011[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 22:20:00.077[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backuptuin5j5s in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backuptuin5j5s completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 22:20:10.089[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 22:20:10.094[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.standalone.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-krxrkq5n","engine":"redis","environmentName":"cloud-dev","mode":"standalone","name":"restore-e2e-krxrkq5n","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"7.0.6"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 22:20:10.281[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 22:20:10.281[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-krxrkq5n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-krxrkq5n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-krxrkq5n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-krxrkq5n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-krxrkq5n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:21:00.415524    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-krxrkq5n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-krxrkq5n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-krxrkq5n status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 22:21:30.504[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-krxrkq5n [38;5;243m@ 03/03/25 22:21:30.519[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 22:21:30.656[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 22:21:30.659[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 1m40.767548566s
[1mSTEP:[0m [2/8] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 22:21:30.761[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 22:21:30.761[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 22:21:30.761[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.standalone.redis-7.2c1g.general [38;5;243m@ 03/03/25 22:21:30.963[0m
[1mSTEP:[0m choose larger class: redis.standalone.redis.167c255g.general [38;5;243m@ 03/03/25 22:21:30.963[0m
[1mSTEP:[0m changing component redis class to redis.standalone.redis.167c255g.general [38;5;243m@ 03/03/25 22:21:30.963[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432536243176213050 to be Succeed [38;5;243m@ 03/03/25 22:21:31.279[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Creating, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:24:11.701576    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:27:22.207362    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:30:32.698237    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-c-66d454955c-verticalscaling-z72rr status: Running, cluster status: Updating
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
backup          | PASS    | 1        | 1m41s    | 1m41s    | 1m41s    | 1m41s
stop-start      | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
vscale          | SKIP    | 0        | -        | -        | -        | -
volume-expansion | SKIP    | 0        | -        | -        | -        | -
upgrade         | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: standalone | Version: 7.0.6 | Operations: 1/8 (12.5%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/ops_test.go:36 [38;5;243m@ 03/03/25 22:31:31.287[0m
=== Test Failed ===
Engine: redis
Mode: standalone
Version: 7.0.6
Cluster: e2e-ce14nz8w
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [761.670 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/standalone/7.0.6[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] Timed out after 600.007s.
Expected
<constants.ClusterTaskStatus>: Running
to equal
<constants.ClusterTaskStatus>: Succeed[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/ops_test.go:36[0m [38;5;243m@ 03/03/25 22:31:31.287[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/standalone/7.2.4[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 22:31:31.287[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 22:31:31.287[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 22:31:31.287[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 22:31:31.287[0m
[1mSTEP:[0m set mode standalone [38;5;243m@ 03/03/25 22:31:31.287[0m
[1mSTEP:[0m set version 7.2.4 [38;5;243m@ 03/03/25 22:31:31.287[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 22:31:31.287[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 22:31:31.287[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 22:31:31.305[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 22:31:31.305[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 22:31:31.305[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 22:31:31.307[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 22:31:31.307[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 22:31:31.493[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 22:31:31.493[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 22:31:31.493[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 22:31:31.493[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 22:31:31.493[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 22:31:31.493[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 22:31:31.493[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.standalone.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T22:31:31.490Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-q-dd74f9bb","id":"432537250178271802","mode":"standalone","name":"e2e-qskvyl8k","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T22:31:31.490Z","version":"7.2.4"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 22:31:31.493[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 22:31:31.493[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-qskvyl8k status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-qskvyl8k status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-qskvyl8k status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-qskvyl8k status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-qskvyl8k status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-qskvyl8k status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-qskvyl8k status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-qskvyl8k status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 22:32:41.668[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 22:32:41.683[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 22:32:41.683[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 22:32:41.683[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 22:32:41.683[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 22:32:41.683[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 22:32:41.683[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 22:32:41.683[0m
Engine: redis
Mode: standalone
Version: 7.2.4
Components:
- redis:
Replicas: 1-1 (default: 1)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ— hscale: replicas range is 1-1
âœ“ log
âœ“ parameter
âœ— promote: replicas range is 1-1
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-cluster:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-sentinel:
âœ“ dashboard
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
- vscale: Scale cluster components vertically
Supported Components: [redis]
- volume-expansion: Expand cluster volumes
Supported Components: [redis]
- promote: Promote cluster components
- upgrade: Upgrade cluster
Supported Components: [redis]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis]
- restart: Restart cluster components
Supported Components: [redis]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. vscale: Scale cluster components vertically
Supported Components: [redis]
3. volume-expansion: Expand cluster volumes
Supported Components: [redis]
4. upgrade: Upgrade cluster
Supported Components: [redis]
5. account: Account operations
6. stop-start: Stop and start cluster
Supported Components: [redis]
7. restart: Restart cluster components
Supported Components: [redis]
8. alert: Alert operations
[1mSTEP:[0m [1/8] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 22:32:41.684[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 22:32:41.684[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 22:32:41.686[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 22:32:41.686[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-q-dd74f9bb-datafile-20250303223231 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 22:32:41.688[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup a46dca06-e2e-q-dd74f9bb-redis-aof is running
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 22:32:41.69[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 22:32:41.69[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 22:32:41.753[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupk72dnk6c in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupk72dnk6c completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 22:32:51.767[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 22:32:51.771[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.standalone.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-ywzod33p","engine":"redis","environmentName":"cloud-dev","mode":"standalone","name":"restore-e2e-ywzod33p","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"7.2.4"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 22:32:51.957[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 22:32:51.957[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ywzod33p status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ywzod33p status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ywzod33p status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ywzod33p status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ywzod33p status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ywzod33p status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:33:52.091386    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ywzod33p status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-ywzod33p status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 22:34:12.161[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-ywzod33p [38;5;243m@ 03/03/25 22:34:12.176[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 22:34:12.306[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 22:34:12.309[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 1m30.647742385s
[1mSTEP:[0m [2/8] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 22:34:12.331[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 22:34:12.331[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 22:34:12.331[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.standalone.redis-7.2c1g.general [38;5;243m@ 03/03/25 22:34:12.347[0m
[1mSTEP:[0m choose larger class: redis.standalone.redis.167c255g.general [38;5;243m@ 03/03/25 22:34:12.347[0m
[1mSTEP:[0m changing component redis class to redis.standalone.redis.167c255g.general [38;5;243m@ 03/03/25 22:34:12.347[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432537520106900026 to be Succeed [38;5;243m@ 03/03/25 22:34:12.383[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Pending, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:37:02.817378    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:40:13.276245    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:43:23.850389    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-q-dd74f9bb-verticalscaling-2gtwm status: Running, cluster status: Updating
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
backup          | PASS    | 1        | 1m31s    | 1m31s    | 1m31s    | 1m31s
vscale          | SKIP    | 0        | -        | -        | -        | -
volume-expansion | SKIP    | 0        | -        | -        | -        | -
upgrade         | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
alert           | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: standalone | Version: 7.2.4 | Operations: 1/8 (12.5%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/ops_test.go:36 [38;5;243m@ 03/03/25 22:44:12.39[0m
=== Test Failed ===
Engine: redis
Mode: standalone
Version: 7.2.4
Cluster: e2e-qskvyl8k
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [761.103 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/standalone/7.2.4[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] Timed out after 600.006s.
Expected
<constants.ClusterTaskStatus>: Running
to equal
<constants.ClusterTaskStatus>: Succeed[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/ops_test.go:36[0m [38;5;243m@ 03/03/25 22:44:12.39[0m
[38;5;243m------------------------------[0m
[0mEngine Tests [38;5;243mwith different operations [0m[1mredis/standalone/7.2.7[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[1mSTEP:[0m build engine [38;5;243m@ 03/03/25 22:44:12.39[0m
[1mSTEP:[0m Setting up test environment [38;5;243m@ 03/03/25 22:44:12.39[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 22:44:12.39[0m
[1mSTEP:[0m build redis cluster [38;5;243m@ 03/03/25 22:44:12.39[0m
[1mSTEP:[0m set mode standalone [38;5;243m@ 03/03/25 22:44:12.39[0m
[1mSTEP:[0m set version 7.2.7 [38;5;243m@ 03/03/25 22:44:12.39[0m
[1mSTEP:[0m set extra according to env [38;5;243m@ 03/03/25 22:44:12.39[0m
[1mSTEP:[0m build components [38;5;243m@ 03/03/25 22:44:12.39[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m set cluster backup [38;5;243m@ 03/03/25 22:44:12.407[0m
[1mSTEP:[0m set cluster availability zone [38;5;243m@ 03/03/25 22:44:12.407[0m
[1mSTEP:[0m get test environment info [38;5;243m@ 03/03/25 22:44:12.407[0m
[API] GET /api/v1/organizations/{orgName}/environments/{environmentName} environment.getEnvironment
[1mSTEP:[0m set cluster termination policy to delete [38;5;243m@ 03/03/25 22:44:12.41[0m
[1mSTEP:[0m create cluster [38;5;243m@ 03/03/25 22:44:12.41[0m
[API] POST /api/v1/organizations/{orgName}/clusters cluster.createCluster
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 22:44:12.59[0m
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 22:44:12.59[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 22:44:12.59[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 22:44:12.59[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 22:44:12.59[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 22:44:12.59[0m
[1mSTEP:[0m print cluster [38;5;243m@ 03/03/25 22:44:12.59[0m
{"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"cloudProvider":"aliyun","cloudRegion":"cn-zhangjiakou","clusterType":"Normal","codeShort":"2c1g","components":[{"classCode":"redis.standalone.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"createdAt":"2025-03-03T22:44:12.587Z","engine":"redis","environmentId":"8c26c3c0-0f52-4127-8396-24a86ac4331f","environmentName":"cloud-dev","environmentType":"public","hash":"kubeblocks-cloud-ns/e2e-k-5cdcf4ff5b","id":"432538527075404346","mode":"standalone","name":"e2e-kob1djv4","orgName":"e2e-test","parentId":0,"podAntiAffinityEnabled":true,"project":"kubeblocks-cloud-ns","singleZone":true,"status":"Pending","terminationPolicy":"WipeOut","updatedAt":"2025-03-03T22:44:12.587Z","version":"7.2.7"}
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 22:44:12.59[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 22:44:12.59[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-kob1djv4 status: Pending
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-kob1djv4 status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-kob1djv4 status is nil, waiting for the status to be updated
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-kob1djv4 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-kob1djv4 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-kob1djv4 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-kob1djv4 status: Creating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster e2e-kob1djv4 status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 22:45:22.796[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m verify cluster mode and version [38;5;243m@ 03/03/25 22:45:22.812[0m
[1mSTEP:[0m verify cluster components [38;5;243m@ 03/03/25 22:45:22.812[0m
[1mSTEP:[0m verify component redis [38;5;243m@ 03/03/25 22:45:22.812[0m
[1mSTEP:[0m verify cluster backup [38;5;243m@ 03/03/25 22:45:22.812[0m
[1mSTEP:[0m verify termination policy [38;5;243m@ 03/03/25 22:45:22.812[0m
[1mSTEP:[0m verify cluster status [38;5;243m@ 03/03/25 22:45:22.812[0m
[1mSTEP:[0m TODO: verify cluster backup [38;5;243m@ 03/03/25 22:45:22.812[0m
Engine: redis
Mode: standalone
Version: 7.2.7
Components:
- redis:
Replicas: 1-1 (default: 1)
Storages:
- data: 20-0Gi (default: 20Gi)
Engine Features:
================
âœ“ account:
âœ— database:
âœ— dms:
âœ“ bench:
âœ“ backup:
âœ— metrics:
âœ— license:
âœ“ alert:
Component Features:
==================
redis:
âœ“ dashboard
âœ— hscale: replicas range is 1-1
âœ“ log
âœ“ parameter
âœ— promote: replicas range is 1-1
âœ“ rebuildInstance
âœ“ restart
âœ“ start
âœ“ stop
âœ“ upgrade: confirm by upgradeable versions
âœ“ volumeExpansion
âœ“ vscale
redis-cluster:
âœ“ dashboard
âœ“ log
âœ“ parameter
redis-sentinel:
âœ“ dashboard
Available Operations:
===================
- backup: Backup and restore
- hscale: Scale cluster components horizontally
- vscale: Scale cluster components vertically
Supported Components: [redis]
- volume-expansion: Expand cluster volumes
Supported Components: [redis]
- promote: Promote cluster components
- upgrade: Upgrade cluster
Supported Components: [redis]
- account: Account operations
- database: Database operations
- monitor: Monitor operations
- stop-start: Stop and start cluster
Supported Components: [redis]
- restart: Restart cluster components
Supported Components: [redis]
- dms: Data management operations
- alert: Alert operations
Selected Operations (all mode):
===================
1. backup: Backup and restore
2. vscale: Scale cluster components vertically
Supported Components: [redis]
3. volume-expansion: Expand cluster volumes
Supported Components: [redis]
4. upgrade: Upgrade cluster
Supported Components: [redis]
5. account: Account operations
6. stop-start: Stop and start cluster
Supported Components: [redis]
7. restart: Restart cluster components
Supported Components: [redis]
8. alert: Alert operations
[1mSTEP:[0m [1/8] Executing operation: backup - Backup and restore [38;5;243m@ 03/03/25 22:45:22.813[0m
[1mSTEP:[0m test cluster backup and restore [38;5;243m@ 03/03/25 22:45:22.813[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[1mSTEP:[0m wait for the initial backup to complete [38;5;243m@ 03/03/25 22:45:22.815[0m
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 22:45:22.815[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-k-5cdcf4ff5b-datafile-20250303224515 in progress, status: Running
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-k-5cdcf4ff5b-datafile-20250303224515 completed
[1mSTEP:[0m wait for continuous backup to running [38;5;243m@ 03/03/25 22:45:32.828[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup 4054239e-e2e-k-5cdcf4ff5b-redi-aof is running
[1mSTEP:[0m default backup method: datafile [38;5;243m@ 03/03/25 22:45:32.83[0m
[1mSTEP:[0m create backup [38;5;243m@ 03/03/25 22:45:32.83[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/backups backup.createClusterBackup
[1mSTEP:[0m wait for backup to complete [38;5;243m@ 03/03/25 22:45:32.927[0m
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupljlxlzin in progress, status:
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
backup e2e-backupljlxlzin completed
[1mSTEP:[0m list backups [38;5;243m@ 03/03/25 22:45:42.941[0m
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
[API] GET /api/v1/organizations/{orgName}/backups/{backupId} backup.getBackup
[1mSTEP:[0m verify backup [38;5;243m@ 03/03/25 22:45:42.946[0m
Restoring cluster: {"availabilityZones":["cn-zhangjiakou-a"],"backup":{"autoBackup":true,"autoBackupMethod":"datafile","cronExpression":"0 2 * * *","pitrEnabled":true,"retentionPeriod":"7d","snapshotVolumes":false},"components":[{"classCode":"redis.standalone.redis-7.2c1g.general","classSeries":"general","codeShort":"2c1g","component":"redis","cpu":2,"memory":1,"replicas":1,"storageClass":"ape-local-hostpath-sc","volumes":[{"name":"data","storage":20}]}],"displayName":"restore-e2e-7uublk7n","engine":"redis","environmentName":"cloud-dev","mode":"standalone","name":"restore-e2e-7uublk7n","orgName":"e2e-test","project":"kubeblocks-cloud-ns","singleZone":true,"terminationPolicy":"WipeOut","version":"7.2.7"}
[API] POST /api/v1/organizations/{orgName}/restore restore.restoreCluster
[1mSTEP:[0m wait cluster running [38;5;243m@ 03/03/25 22:45:43.152[0m
[1mSTEP:[0m waiting for cluster to reach status: Running [38;5;243m@ 03/03/25 22:45:43.152[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-7uublk7n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-7uublk7n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-7uublk7n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-7uublk7n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-7uublk7n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-7uublk7n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:46:43.268770    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-7uublk7n status: Restoring
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
cluster restore-e2e-7uublk7n status: Running
[1mSTEP:[0m verify cluster [38;5;243m@ 03/03/25 22:47:03.352[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete cluster restore-e2e-7uublk7n [38;5;243m@ 03/03/25 22:47:03.367[0m
[API] DELETE /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.deleteCluster
[1mSTEP:[0m verify cluster is deleted [38;5;243m@ 03/03/25 22:47:03.498[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[1mSTEP:[0m delete backup [38;5;243m@ 03/03/25 22:47:03.5[0m
[API] DELETE /api/v1/organizations/{orgName}/backups/{backupId} backup.deleteBackup
[API] GET /api/v1/organizations/{orgName}/backups backup.listBackups
Operation backup completed in 1m40.708947476s
[1mSTEP:[0m [2/8] Executing operation: vscale - Scale cluster components vertically [38;5;243m@ 03/03/25 22:47:03.522[0m
[1mSTEP:[0m scale cluster vertically [38;5;243m@ 03/03/25 22:47:03.522[0m
[1mSTEP:[0m choose component: redis [38;5;243m@ 03/03/25 22:47:03.522[0m
[API] GET /api/v1/classes class.listClasses
[1mSTEP:[0m current class: redis.standalone.redis-7.2c1g.general [38;5;243m@ 03/03/25 22:47:03.538[0m
[1mSTEP:[0m choose larger class: redis.standalone.redis.167c255g.general [38;5;243m@ 03/03/25 22:47:03.538[0m
[1mSTEP:[0m changing component redis class to redis.standalone.redis.167c255g.general [38;5;243m@ 03/03/25 22:47:03.538[0m
[API] POST /api/v1/organizations/{orgName}/clusters/{clusterName}/vscale opsrequest.verticalScaleCluster
[1mSTEP:[0m wait task 432538813949020730 to be Succeed [38;5;243m@ 03/03/25 22:47:03.577[0m
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: , cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Pending, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Running
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:49:54.007910    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:53:04.550143    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
E0303 22:56:15.008068    5066 utils.go:172] Failed to get cluster: http: read on closed response body, retrying...
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName} cluster.getCluster
[API] GET /api/v1/organizations/{orgName}/clusters/{clusterName}/clustertasks/{taskId} clusterTask.getClusterTask
task e2e-k-5cdcf4ff5b-verticalscaling-svz24 status: Running, cluster status: Updating
Operation Statistics:
======================
Operation       | Status  | Runs     | Min      | Max      | Avg      | Total
--------------------------------------------------------------------------------
backup          | PASS    | 1        | 1m41s    | 1m41s    | 1m41s    | 1m41s
alert           | SKIP    | 0        | -        | -        | -        | -
vscale          | SKIP    | 0        | -        | -        | -        | -
volume-expansion | SKIP    | 0        | -        | -        | -        | -
upgrade         | SKIP    | 0        | -        | -        | -        | -
account         | SKIP    | 0        | -        | -        | -        | -
stop-start      | SKIP    | 0        | -        | -        | -        | -
restart         | SKIP    | 0        | -        | -        | -        | -
--------------------------------------------------------------------------------
[Summary] Engine: redis | Mode: standalone | Version: 7.2.7 | Operations: 1/8 (12.5%)
[38;5;9m[FAILED][0m in [It] - /e2e/test/engine/ops_test.go:36 [38;5;243m@ 03/03/25 22:57:03.585[0m
=== Test Failed ===
Engine: redis
Mode: standalone
Version: 7.2.7
Cluster: e2e-kob1djv4
Keeping cluster for debugging
==================
[38;5;9mâ€¢ [FAILED] [771.195 seconds][0m
[0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/standalone/7.2.7[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/engine_test.go:584[0m
[38;5;9m[FAILED] Timed out after 600.007s.
Expected
<constants.ClusterTaskStatus>: Running
to equal
<constants.ClusterTaskStatus>: Succeed[0m
[38;5;9mIn [1m[It][0m[38;5;9m at: [1m/e2e/test/engine/ops_test.go:36[0m [38;5;243m@ 03/03/25 22:57:03.585[0m
[38;5;243m------------------------------[0m
[0m[1m[AfterSuite] [0m
[38;5;243m/e2e/test/engine/suite_test.go:43[0m
Suite End: 2025-03-03T22:57:03Z
[38;5;10m[AfterSuite] PASSED [0.000 seconds][0m
[38;5;243m------------------------------[0m
[38;5;9m[1mSummarizing 22 Failures:[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] mysql/replication/5.7.44[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/account_test.go:173[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] mysql/replication/8.0.30[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/cluster_test.go:78[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] mysql/replication/8.0.31[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/account_test.go:173[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] mysql/standalone/5.7.44[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/account_test.go:173[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] mysql/standalone/8.0.31[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/account_test.go:173[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] mysql/standalone/8.0.32[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/cluster_test.go:81[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/cluster/6.2.17[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/alert_test.go:45[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/cluster/7.0.6[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/alert_test.go:45[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/cluster/7.2.4[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/ops_test.go:33[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/cluster/7.2.7[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/ops_test.go:33[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/replication/6.2.17[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/ops_test.go:33[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/replication/7.0.6[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/ops_test.go:36[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/replication/7.2.4[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/ops_test.go:33[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/replication/7.2.7[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/ops_test.go:33[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/sentinel/6.2.17[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/alert_test.go:45[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/sentinel/7.0.6[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/ops_test.go:33[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/sentinel/7.2.4[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/ops_test.go:33[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/sentinel/7.2.7[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/ops_test.go:33[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/standalone/6.2.17[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/ops_test.go:36[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/standalone/7.0.6[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/ops_test.go:36[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/standalone/7.2.4[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/ops_test.go:36[0m
[38;5;9m[FAIL][0m [0mEngine Tests [38;5;243mwith different operations [38;5;9m[1m[It] redis/standalone/7.2.7[0m [38;5;204m[engine, operations][0m
[38;5;243m/e2e/test/engine/ops_test.go:36[0m
[38;5;9m[1mRan 22 of 22 Specs in 15375.836 seconds[0m
[38;5;9m[1mFAIL![0m -- [38;5;10m[1m0 Passed[0m | [38;5;9m[1m22 Failed[0m | [38;5;11m[1m0 Pending[0m | [38;5;14m[1m0 Skipped[0m
--- FAIL: TestEngineCapabilities (15376.18s)
FAIL
Ginkgo ran 1 suite in 4h16m50.730787676s
Test Suite Failed



